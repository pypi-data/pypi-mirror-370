import{d as k,c as v,e as c,f as s,a as P,v as Q,b as W,r as u,aH as X,h as r,w as o,n as Z,B as Y,j as n,H as $,a1 as D,a2 as F,x as V,Q as ee,t as q,a7 as te,Z as ae,p as ne,m as se,F as oe,aX as le,$ as re,aW as ie,E as ue}from"./index-DOdIYOkR.js";import{b as ce,d as pe,e as de,f as _e}from"./task-DMmcmbsE.js";import{_ as me}from"./DynamicForm.vue_vue_type_script_setup_true_lang-r8iZL3AR.js";import{u as fe}from"./exp-DwbafzoG.js";import{a as ve,b as ge}from"./Tabs-dCRhCvDT.js";const he={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},xe=k({name:"CloseCircleOutline",render:function(x,l){return c(),v("svg",he,l[0]||(l[0]=[s("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 320L192 192"},null,-1),s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M192 320l128-128"},null,-1)]))}}),we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ie=k({name:"Duplicate",render:function(x,l){return c(),v("svg",we,l[0]||(l[0]=[s("path",{d:"M408 112H184a72 72 0 0 0-72 72v224a72 72 0 0 0 72 72h224a72 72 0 0 0 72-72V184a72 72 0 0 0-72-72zm-32.45 200H312v63.55c0 8.61-6.62 16-15.23 16.43A16 16 0 0 1 280 376v-64h-63.55c-8.61 0-16-6.62-16.43-15.23A16 16 0 0 1 216 280h64v-63.55c0-8.61 6.62-16 15.23-16.43A16 16 0 0 1 312 216v64h64a16 16 0 0 1 16 16.77c-.42 8.61-7.84 15.23-16.45 15.23z",fill:"currentColor"},null,-1),s("path",{d:"M395.88 80A72.12 72.12 0 0 0 328 32H104a72 72 0 0 0-72 72v224a72.12 72.12 0 0 0 48 67.88V160a80 80 0 0 1 80-80z",fill:"currentColor"},null,-1)]))}}),be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Me=k({name:"RecordStop24Regular",render:function(x,l){return c(),v("svg",be,l[0]||(l[0]=[s("g",{fill:"none"},[s("path",{d:"M12 3.5a8.5 8.5 0 1 0 0 17a8.5 8.5 0 0 0 0-17zM2 12C2 6.477 6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12zm6-2.5A1.5 1.5 0 0 1 9.5 8h5A1.5 1.5 0 0 1 16 9.5v5a1.5 1.5 0 0 1-1.5 1.5h-5A1.5 1.5 0 0 1 8 14.5v-5z",fill:"currentColor"})],-1)]))}}),ye={class:"absolute top-1 right-1"},ke={class:"pl-5 h-full tpl-s-g"},Ce={class:"mb-5"},Te={class:"text-xl"},Se={class:"text-sm opacity-80"},Ee={class:"text-right mt-2 mr-[20px]"},Re=k({__name:"ExpsTpl",setup(C,{expose:x}){const{t:l}=P(),d=Q();W(),fe();const T=u(),w=u(!1),_=u(!1),m=u(!1),H=()=>{m.value=!0},S=()=>{m.value=!1},p=u(),I=u(),M=u(),L=async()=>{const[a,e]=await ce();!a&&(e==null?void 0:e.status)===0&&(M.value=e.data,p.value=Object.keys(e.data)[0],A(p.value))},f=u(),E=u(),A=async a=>{const[e,t]=await pe({template_group_name:a});!e&&(t==null?void 0:t.status)===0&&(I.value=t.data,f.value=Object.keys(t.data)[0],j(Object.keys(t.data)[0]))},j=async a=>{if(_.value)return;_.value=!0;const[e,t]=await de({template_group_name:p.value,template_name:a,group_name:d.query.device_group_name,space_id:d.query.space_id});_.value=!1,!e&&(t==null?void 0:t.status)===0&&(E.value=t.data)},N=a=>{A(a)},G=a=>{j(a)},J=async()=>{var y;if(w.value||!T.value)return;w.value=!0;const a=await((y=T.value[0])==null?void 0:y.submit()),e=le(a);if(re(e))return;const{device_group_name:t,space_id:R,task_id:z}=d.query,[b,i]=await _e({setting:e,task_id:z,group_name:t,space_id:R,template_group:p.value,template_name:f.value});w.value=!1,!b&&(i==null?void 0:i.status)===0&&(i.data.exp.template=i.data.exp.template||`${p.value}/${f.value}`,ie(()=>{setTimeout(()=>{localStorage.setItem("t",JSON.stringify(i));const B=new URLSearchParams({device_group_name:d.query.device_group_name,task_id:d.query.task_id,task_title:d.query.task_title,space_id:d.query.space_id,create:"1"});window.open(`/experiment/waveforms?${B.toString()}`,"_blank")},100),S()}))};return X(m,a=>{a&&L()},{immediate:!0}),x({open:H,close:S}),(a,e)=>{const t=Y,R=ae,z=te,b=ge,i=ve,y=ee,B=Z,K=oe;return c(),v("div",null,[r(K,{show:n(m),"onUpdate:show":e[2]||(e[2]=g=>$(m)?m.value=g:null),size:"huge"},{default:o(()=>[r(B,{style:{"min-height":"700px",height:"calc(100vh - 100px)","box-sizing":"border-box",overflow:"hidden",width:"80vw","min-width":"600px",padding:"12px",position:"relative"},"content-class":"!pb-0"},{default:o(()=>[s("div",ye,[r(t,{type:"primary",onClick:S,size:"small",circle:""},{icon:o(()=>[r(n(xe))]),_:1})]),r(i,{type:"card",placement:"left",animated:"",onUpdateValue:N,value:n(p),"onUpdate:value":e[1]||(e[1]=g=>$(p)?p.value=g:null),style:{height:"calc(100vh - 160px)"}},{default:o(()=>[(c(!0),v(D,null,F(n(M),(g,O)=>(c(),V(b,{key:O,name:O,tab:g.title,disabled:n(_)},{default:o(()=>[r(y,{style:{height:"100%","padding-top":"10px","box-sizing":"border-box"}},{default:o(()=>[r(i,{type:"line",placement:"left",value:n(f),"onUpdate:value":e[0]||(e[0]=h=>$(f)?f.value=h:null),onUpdateValue:G,style:{height:"100%"}},{default:o(()=>[(c(!0),v(D,null,F(n(I),(h,U)=>(c(),V(b,{key:U,name:U,tab:h.title,disabled:n(_)},{default:o(()=>[s("div",ke,[s("div",Ce,[s("div",Te,q(h.title),1),s("div",Se,q(h.desc),1)]),r(z,{show:n(_)},{default:o(()=>[r(R,{style:{"padding-right":"20px"}},{default:o(()=>[n(E)&&!n(_)?(c(),V(me,{key:0,cfgs:n(E),ref_for:!0,ref_key:"dynamicFormRef",ref:T},null,8,["cfgs"])):ne("",!0)]),_:1}),s("div",Ee,[r(t,{loading:n(w),type:"primary",onClick:J},{default:o(()=>[se(q(n(l)("groupDetail.exps.createExpBtn")),1)]),_:1},8,["loading"])])]),_:1},8,["show"])])]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"])]),_:1})]),_:2},1032,["name","tab","disabled"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["show"])])}}}),Ae=ue(Re,[["__scopeId","data-v-7bc3469e"]]);export{Ie as D,Ae as E,Me as R};
