# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
AUDITD:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: event_time
      base_time: true
      pattern: '(\s*?)(\d{10})(.\d+\s*)'
      dateformat: 'epoch'
      group: 2
    - name: syslog_timestamp
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2

AWS_CLOUDTRAIL:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: event_time
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%SZ"
      pattern: '(eventTime"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z)(\s*")'
      group: 2
    # PRESERVED: Different format
    - name: create_date
      dateformat: "%b %d, %Y %H:%M:%S %p"
      pattern: '(createDate"\s*:\s*"?)([a-zA-Z]{3}\s\d+,\s\d{4}\s+\d+:\d+:\d+\s[AP]M)(\s*")'
      group: 2
    # NEW: Consolidated generic pattern for ISO format
    - name: AWS_CLOUDTRAIL_generic_iso_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%SZ"
      pattern: '([^"]+"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z)'
      group: 2
      # Replaces: creation_date

AWS_WAF:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: timestamp
      base_time: true
      pattern: '("timestamp":\s*?)(\d{10})(.\d+\s*)'
      dateformat: 'epoch'
      group: 2

AZURE_AD:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: createdDateTime
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%SZ"
      pattern: '(createdDateTime"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z)(\s*")'
      group: 2

BRO_JSON:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/usr/local/zeek/logs/current/
  timestamps:
    - name: zeek_ts
      base_time: true
      pattern: '("ts":\s*?)(\d{10})(.\d+\s*)'
      dateformat: 'epoch'
      group: 2

CB_EDR:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/usr/local/bin/cbagentd/logs/
  timestamps:
    - name: cb_edr_timestamp
      base_time: true
      pattern: '("timestamp":\s*)(\d{10})'
      dateformat: 'epoch'
      group: 2

CHROME_MANAGEMENT:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/var/log/chrome/
  timestamps:
    - name: chrome_timestamp
      base_time: true
      pattern: '("time":\s*")(\d{10})(.\d+\s*")?'
      dateformat: 'epoch'
      group: 2

CORELIGHT:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/usr/local/corelight/logs/
  timestamps:
    - name: ts
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("ts":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d{6}Z)'
      group: 2
    - name: corelight_leading
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<134>)([a-zA-Z]{3}\s\d+\s\d{2}:\d{2}:\d{2})'
      group: 2
    - name: write_ts
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("_write_ts":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d{6}Z)'
      group: 2

CS_DETECTS:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/Library/CS/logs/
  timestamps:
    - name: all_timestamps
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 1

CS_EDR:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/Library/CS/logs/
  timestamps:
    - name: cs_edr_timestamp
      base_time: true
      pattern: '("timestamp":\s*"?)(\d{10})'
      dateformat: 'epoch'
      group: 2
    - name: ContextTimeStamp
      pattern: '("ContextTimeStamp":\s*"?)(\d{10})'
      dateformat: 'epoch'
      group: 2
    - name: OriginalEventTimeStamp
      pattern: '("OriginalEventTimeStamp":\s*"?)(\d{10})'
      dateformat: 'epoch'
      group: 2
    - name: ProcessStartTime
      pattern: '("ProcessStartTime":\s*"?)(\d{10})'
      dateformat: 'epoch'
      group: 2
    - name: AgentLocalTime
      pattern: '("AgentLocalTime":\s*"?)(\d{10})'
      dateformat: 'epoch'
      group: 2

DUO_ACTIVITY:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/
  timestamps:
    - name: base_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: ("ts":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
      group: 2
    - name: other_timestamps
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: (\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
      group: 1
    - name: timestamp
      dateformat: 'epoch'
      pattern: '("timestamp":)(\d{10})(,)'
      group: 2
    - name: timestamp
      dateformat: 'epoch'
      pattern: '("timestamp":)(\d{10})(,)'
      group: 2

DUO_ADMIN:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/
  timestamps:
    - name: base_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: ("isotimestamp":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
      group: 2
    - name: other_timestamps
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: (\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
      group: 1
    - name: timestamp
      dateformat: 'epoch'
      pattern: '("timestamp":)(\d{10})(,)'
      group: 2

DUO_AUTH:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/
  timestamps:
    - name: base_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: ("isotimestamp":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
      group: 2
    - name: other_timestamps
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: (\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
      group: 1
    - name: timestamp
      dateformat: 'epoch'
      pattern: '("timestamp":)(\d{10})(,)'
      group: 2

FIREEYE_HX:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/opt/fireeye/agent/log/
  timestamps:
    - name: base_fireeye_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: ("event_at"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")
      group: 2
    - name: fireeye_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: ("\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")
      group: 2

GCP_CLOUDAUDIT:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # NEW: Consolidated generic pattern
    - name: GCP_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '([^"]+"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: gcp_time, receiveTimestamp

GCP_CLOUD_NAT:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    - name: receiveTimestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(receiveTimestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2

GCP_DNS:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    - name: receiveTimestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(receiveTimestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2

GCP_FIREWALL:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*|Z")'
      group: 2
    - name: gcp_receiveTimestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(receiveTimestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*|Z")'
      group: 2

GCP_IDS:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(Z")'
      group: 2
    - name: receiveTimestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(receiveTimestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2

GCP_LOADBALANCING:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    - name: receiveTimestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(receiveTimestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2

GCP_SECURITYCENTER_THREAT:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: gcp_eventTime
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("eventTime"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # PRESERVED: Different format
    - name: timestamp
      pattern: '("seconds":\s*")(\d{10})'
      dateformat: 'epoch'
      group: 2
    # NEW: Consolidated generic pattern
    - name: GCP_SECURITYCENTER_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '([^"]+Time"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: gcp_createTime

GCP_SECURITYCENTER_MISCONFIGURATION:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: gcp_eventTime
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("eventTime"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # PRESERVED: Different format
    - name: timestamp
      pattern: '("seconds":\s*")(\d{10})'
      dateformat: 'epoch'
      group: 2
    # NEW: Consolidated generic pattern
    - name: GCP_SECURITYCENTER_MISC_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '([^"]+Time"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: gcp_createTime

GCP_VPC_FLOW:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: gcp_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # NEW: Consolidated generic pattern
    - name: GCP_VPC_FLOW_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '([^"]+_?[Tt]ime[^"]*"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: receiveTimestamp, gcp_end_time, gcp_start_time

GMAIL_LOGS:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: timestamp
      base_time: true
      pattern: '("timestamp_usec":\s+")(\d{10})(\d{6})'
      dateformat: 'epoch'
      group: 2

GUARDDUTY:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: updatedAt
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("updatedAt"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # NEW: Consolidated generic pattern
    - name: GUARDDUTY_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("[^"]+At"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: createdAt, eventFirstSeen, eventLastSeen

INFOBLOX_DHCP:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: syslog_timestamp
      base_time: true
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>.*)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2

EXTRAHOP_DNS:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: syslog_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(<\d+>.*)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z)'
      group: 2

LIMACHARLIE_EDR:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: TIMESTAMP
      base_time: true
      pattern: '("TIMESTAMP":)(\d{10})(\d{3})'
      dateformat: 'epoch'
      group: 2
    - name: event_time
      pattern: '("event_time":)(\d{10})(\d{3})'
      dateformat: 'epoch'
      group: 2

OKTA:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: published
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("published"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # NEW: Consolidated generic pattern
    - name: OKTA_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("[^"]+Time[^"]*"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: authMethodFirstVerificationTime, authMethodSecondVerificationTime, suspiciousActivityTimestamp

SURICATA_EVE:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("timestamp"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
    - name: start
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("start"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2

TANIUM_TH:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: eventTimestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("eventTimestamp":\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+)'
      group: 2

UDM:
  api: udmevents
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: udm_event_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("event_timestamp":|"eventTimestamp":\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2

WINDOWS_DHCP:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: dhcp_timestamp
      base_time: true
      dateformat: "%m/%d/%y,%H:%M:%S"
      pattern: '(,)(\d\d\/\d\d\/\d\d,\d\d:\d\d:\d\d)(,)'
      group: 2

WINDOWS_SYSMON:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: UtcTimeQuotes
      base_time: true
      dateformat: "%Y-%m-%d %H:%M:%S"
      pattern: '("UtcTime"\s*:\s*"?)(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})'
      group: 2
      examples:
        - '"UtcTime":"1970-01-01 00:00:00'
        - '"UtcTime" :"1970-01-01 00:00:00'
        - '"UtcTime": "1970-01-01 00:00:00'
        - '"UtcTime" : "1970-01-01 00:00:00'
        - '"UtcTime":1970-01-01 00:00:00'
        - '"UtcTime" :1970-01-01 00:00:00'
        - '"UtcTime": 1970-01-01 00:00:00'
        - '"UtcTime" : 1970-01-01 00:00:00'
    # PRESERVED: Different formats
    - name: syslog_timestamp
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2
    - name: EventTime
      pattern: ("EventTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
    - name: EventReceivedTime
      pattern: ("EventReceivedTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
    # NEW: Consolidated generic pattern
    - name: WINDOWS_SYSMON_generic_timestamp
      dateformat: "%Y-%m-%d %H:%M:%S"
      pattern: '([\w"]*Time[\w"]*\s*:\s*"?)(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: UtcTime, EventTimeUTC, EventReceivedTimeUTC, CreationUtcTime, CreationUtcTimeQuotes

POWERSHELL:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/Library/Logs/Microsoft/PowerShell/
  timestamps:
    - name: EventTime
      pattern: ("EventTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
      base_time: true
    - name: syslog_timestamp
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2
    - name: EventReceivedTime
      pattern: ("EventReceivedTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2

SENTINEL_EDR:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: timestamp
      base_time: true
      pattern: '("@timestamp":)(\d{10})'
      dateformat: 'epoch'
      group: 2
    - name: millisecondsSinceEpoch
      pattern: '("millisecondsSinceEpoch"\s*:\s*"?)(\d{10})'
      dateformat: 'epoch'
      group: 2

SEP:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: syslog_timestamp
      base_time: true
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2
    - name: time
      dateformat: "%Y-%m-%d %H:%M:%S"
      pattern: '(Event time: )(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})'
      group: 2

SQUID_WEBPROXY:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: syslog_timestamp
      base_time: true
      pattern: '(\d{10})(.\d{3})'
      dateformat: 'epoch'
      group: 1

WINEVTLOG:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time and different formats
    - name: EventTime
      base_time: true
      pattern: ("EventTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
    - name: syslog_timestamp
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2
    - name: EventReceivedTime
      pattern: ("EventReceivedTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
    # NEW: Consolidated generic pattern
    - name: WINEVTLOG_generic_timestamp
      dateformat: "%Y-%m-%d %H:%M:%S"
      pattern: '("Event(?:Time|ReceivedTime)"\s*:\s*"?)(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: EventTimeUTC, EventReceivedTimeUTC

WINDOWS_DEFENDER_ATP:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory/var/log/microsoft/mdatp/
  timestamps:
    # PRESERVED: base_time entry
    - name: time
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("time"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # NEW: Consolidated generic pattern
    - name: WINDOWS_DEFENDER_ATP_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '([^"]*(?:Time|Timestamp)[^"]*"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: Timestamp, ProcessParentCreationTime, ProcessCreationTime

WINDOWS_DEFENDER_AV:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time and different formats
    - name: EventTime
      base_time: true
      pattern: ("EventTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
    - name: syslog_timestamp
      dateformat: "%b %d %H:%M:%S"
      pattern: '(<\d+>)([a-zA-Z]{3}\s+\d+\s+\d\d:\d\d:\d\d)'
      group: 2
    - name: EventReceivedTime
      pattern: ("EventReceivedTime":)(\d+)(,)
      dateformat: 'epoch'
      group: 2
    # NEW: Consolidated generic pattern for US date format
    - name: WINDOWS_DEFENDER_AV_generic_timestamp
      dateformat: "%m/%d/%Y %I:%M:%S %p"
      pattern: '([^:]+(?:time|Timestamp)(?:[^:]*)?:\s*"?)(\d{1,2}/\d{1,2}/\d{4} \d{1,2}:\d{2}:\d{2} [AP]M)'
      group: 2
      # Replaces all 10 security intelligence and scan time entries:
      # DynamicSecurityIntelligenceCompilationTimestamp, DynamicSecurityIntelligenceCompilationTimestampQuotes,
      # LastQuickScanStartTime, LastQuickScanStartTimeQuotes, LastQuickScanEndTime, LastQuickScanEndTimeQuotes,
      # Antivirus_security_intelligence_creation_time, AV_security_intelligence_creation_time_quotes,
      # AS_security_intelligence_creation_time_quotes, Antispyware_security_intelligence_creation_time

MICROSOFT_DEFENDER_ENDPOINT:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: time
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("time"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2
    # NEW: Consolidated generic pattern
    - name: MICROSOFT_DEFENDER_ENDPOINT_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '([^"]*(?:Time|Timestamp)[^"]*"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: Timestamp, ProcessParentCreationTime, ProcessCreationTime

NIX_SYSTEM:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: syslog_timestamp
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 1

OFFICE_365:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    # PRESERVED: base_time entry
    - name: creation_time
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("CreationTime":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
    # NEW: Consolidated generic pattern
    - name: OFFICE_365_generic_timestamp
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("[^"]+(?:Time|DateTime|Sent)[^"]*":")(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 2
      # Replaces: label_applied, sent

WORKSPACE_ACTIVITY:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: time
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '("time"\s*:\s*"?)(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(.\d+Z\s*")'
      group: 2

WORKSPACE_ALERTS:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: time
      base_time: true
      dateformat: "%Y-%m-%dT%H:%M:%S"
      pattern: '(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})'
      group: 1

ZSCALER_WEBPROXY:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: zscaler_event_timestamp
      base_time: true
      dateformat: "%Y-%m-%d %H:%M:%S"
      pattern: '(\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2})'
      group: 1

GITHUB:
  api: unstructuredlogentries
  log_dir: /tmp/var/log/logstory
  timestamps:
    - name: created_at
      base_time: true
      pattern: '(\"created_at\":)(\d{10})(\d{3})'
      dateformat: 'epoch'
      group: 2
    - name: timestamp
      pattern: '("@timestamp":)(\d{10})'
      dateformat: 'epoch'
      group: 2
