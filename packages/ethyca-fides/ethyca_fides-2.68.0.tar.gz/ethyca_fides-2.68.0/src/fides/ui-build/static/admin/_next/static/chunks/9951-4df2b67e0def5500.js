"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9951],{95492:function(e,t,s){s.d(t,{l:function(){return n}});var i=s(24246);let n=(0,s(27824).IUT)({displayName:"TrashCanSolidIcon",viewBox:"0 0 12 15",path:(0,i.jsx)("path",{d:"M8.37857 1.18083C8.23393 0.892838 7.93661 0.710938 7.6125 0.710938H4.3875C4.06339 0.710938 3.76607 0.892838 3.62143 1.18083L3.42857 1.56094H0.857143C0.383036 1.56094 -1.19209e-07 1.94158 -1.19209e-07 2.41094C-1.19209e-07 2.8803 0.383036 3.26094 0.857143 3.26094H11.1429C11.6162 3.26094 12 2.8803 12 2.41094C12 1.94158 11.6162 1.56094 11.1429 1.56094H8.57143L8.37857 1.18083ZM11.167 4.11094H0.857143V12.6109C0.857143 13.5486 1.62589 14.3109 2.57143 14.3109H9.45268C10.3754 14.3109 11.167 13.5486 11.167 12.6109V4.11094ZM9.02411 6.23594V12.1859C9.02411 12.4197 8.80714 12.6109 8.59554 12.6109C8.33571 12.6109 8.16696 12.4197 8.16696 12.1859V6.23594C8.16696 6.00219 8.33571 5.81094 8.59554 5.81094C8.80714 5.81094 9.02411 6.00219 9.02411 6.23594ZM6.45268 6.23594V12.1859C6.45268 12.4197 6.23571 12.6109 6.02411 12.6109C5.76429 12.6109 5.57143 12.4197 5.57143 12.1859V6.23594C5.57143 6.00219 5.76429 5.81094 6.02411 5.81094C6.23571 5.81094 6.45268 6.00219 6.45268 6.23594ZM3.85714 6.23594V12.1859C3.85714 12.4197 3.66429 12.6109 3.42857 12.6109C3.19286 12.6109 3 12.4197 3 12.1859V6.23594C3 6.00219 3.19286 5.81094 3.42857 5.81094C3.66429 5.81094 3.85714 6.00219 3.85714 6.23594Z",fill:"currentColor"})})},94799:function(e,t,s){s.d(t,{k:function(){return l}});var i=s(76649);let n=e=>(0,i.Ln)({id:"string"},e),l=e=>(null!=e?e:[]).filter(n)},30320:function(e,t,s){s.d(t,{m:function(){return d}});var i=s(27378),n=s(25980),l=s(14047),a=s(32885),r=s(94799);let d=e=>{let{resourceFidesKey:t,resourceType:s}=e,{errorAlert:d}=(0,l.V)(),{plus:o}=(0,n.hz)(),c=(0,i.useMemo)(()=>null!=t?t:"",[]),u=(0,a.YU)(!0,{skip:!o}),m=(0,a.VN)(s,{skip:!o}),{data:x,isLoading:f,error:h,isError:p}=(0,a.PV)(null!=t?t:"",{skip:""!==c&&!(o&&c)}),[y]=(0,a._D)(),g=u.isLoading||m.isLoading||f,C=(0,i.useMemo)(()=>new Map((0,r.k)(u.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[u.data]),j=(0,i.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),v=(0,i.useMemo)(()=>new Map((0,r.k)(j).map(e=>[e.id,e])),[j]),_=(0,i.useMemo)(()=>p&&(null==h?void 0:h.status)===404?new Map:new Map((0,r.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,p,h]),k=(0,i.useMemo)(()=>{let e=[...v.keys()];return e.sort(),e},[v]),b=(0,i.useMemo)(()=>{let e={};return j&&_&&j.forEach(t=>{let s=_.get(t.id||"");s&&(t.allow_list_id&&"string[]"===t.field_type?e[s.custom_field_definition_id]=s.value:e[s.custom_field_definition_id]=s.value.toString())}),e},[j,_]),w=(0,i.useCallback)(async e=>{if(!o)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!i)return;let{customFieldValues:n}=e;if(!n||0===Object.keys(n).length)return;let l=[],a=[];k.forEach(e=>{let t=_.get(e),s=n[e];void 0===s||""===s||Array.isArray(s)&&0===s.length?(null==t?void 0:t.id)&&a.push(t.id):l.push({custom_field_definition_id:e,resource_id:i,id:null==t?void 0:t.id,value:s})});try{await y({resource_type:s,resource_id:i,upsert:l,delete:a})}catch(e){d("One or more custom fields have failed to save, please try again."),console.error(e)}},[o,_,d,t,k,y,s]);return{customFieldValues:b,definitionIdToCustomField:_,idToAllowListWithOptions:C,idToCustomFieldDefinition:v,isEnabled:o,isLoading:g,sortedCustomFieldDefinitionIds:k,upsertCustomFields:w}}},95346:function(e,t,s){s.d(t,{uc:function(){return y},Hn:function(){return d},Uv:function(){return a},C7:function(){return o},mZ:function(){return p.m}});var i,n,l,a,r=s(54682);(i=l||(l={}))[i.CREATE_CUSTOM_FIELDS=0]="CREATE_CUSTOM_FIELDS",i[i.CREATE_CUSTOM_LISTS=1]="CREATE_CUSTOM_LISTS",i[i.CHOOSE_FROM_LIBRARY=2]="CHOOSE_FROM_LIBRARY",r.AL.STRING,r.AL.STRING_,(n=a||(a={})).SINGLE_SELECT="singleSelect",n.MULTIPLE_SELECT="multipleSelect",n.OPEN_TEXT="openText";let d=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open Text",value:"openText"}],o=[{label:"taxonomy:".concat(r.P6.DATA_CATEGORY),value:r.P6.DATA_CATEGORY},{label:"taxonomy:".concat(r.P6.DATA_SUBJECT),value:r.P6.DATA_SUBJECT},{label:"taxonomy:".concat(r.P6.DATA_USE),value:r.P6.DATA_USE},{label:"".concat(r.P6.SYSTEM,":information"),value:r.P6.SYSTEM},{label:"system:data use",value:r.P6.PRIVACY_DECLARATION}];var c=s(24246),u=s(27824),m=s(34090),x=s(30234),f=s(97181),h=s(40324),p=s(30320);let y=e=>{let{resourceFidesKey:t,resourceType:s}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:n,isEnabled:l,isLoading:a,sortedCustomFieldDefinitionIds:d}=(0,p.m)({resourceFidesKey:t,resourceType:s});return l&&0!==d.length?(0,c.jsx)(x.Z,{heading:"Custom fields",children:(0,c.jsx)(u.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,c.jsx)(u.kCb,{flexDir:"column",gap:"24px",children:a?(0,c.jsx)(u.M5Y,{children:(0,c.jsx)(u.$jN,{})}):d.length>0&&(0,c.jsx)(u.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:d.map(e=>{let t=n.get(e);if(!t)return null;let s="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===r.AL.STRING)return(0,c.jsx)(m.gN,{name:s,children:e=>{let{field:s}=e;return(0,c.jsx)(h.j0,{...s,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let l=i.get(t.allow_list_id);if(!l)return null;let{options:a}=l;return(0,c.jsx)(f.d,{name:s,allowClear:!0,mode:t.field_type!==r.AL.STRING?"multiple":void 0,label:t.name,options:a,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};s(94799)},14047:function(e,t,s){s.d(t,{H:function(){return l},V:function(){return i.V}});var i=s(84306),n=s(812);let l=()=>{let{errorAlert:e}=(0,i.V)();return{handleError:t=>{let s="An unexpected error occurred. Please try again.";(0,n.Ot)(t)?s=t.data.detail:(0,n.tB)(t)&&(s=t.data.detail[0].msg),e(s)}}}},84306:function(e,t,s){s.d(t,{V:function(){return l}});var i=s(24246),n=s(27824);let l=()=>{let e=(0,n.pmc)();return{errorAlert:(t,s,l)=>{let a={...l,position:(null==l?void 0:l.position)||"top",render:e=>{let{onClose:l}=e;return(0,i.jsxs)(n.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,i.jsx)(n.zMQ,{}),(0,i.jsxs)(n.xuv,{children:[s&&(0,i.jsx)(n.CdC,{children:s}),(0,i.jsx)(n.XaZ,{children:t})]}),(0,i.jsx)(n.PZ7,{onClick:l,position:"relative",right:0,size:"sm",top:-1})]})}};(null==l?void 0:l.id)&&e.isActive(l.id)?e.update(l.id,a):e(a)},successAlert:(t,s,l)=>{let a={...l,position:(null==l?void 0:l.position)||"top",render:e=>{let{onClose:l}=e;return(0,i.jsxs)(n.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,i.jsx)(n.zMQ,{}),(0,i.jsxs)(n.xuv,{children:[s&&(0,i.jsx)(n.CdC,{children:s}),(0,i.jsx)(n.XaZ,{children:t})]}),(0,i.jsx)(n.PZ7,{onClick:l,position:"relative",right:0,size:"sm",top:-1})]})}};(null==l?void 0:l.id)&&e.isActive(l.id)?e.update(l.id,a):e(a)}}}},45938:function(e,t,s){s.d(t,{Gt:function(){return m},eB:function(){return x},oI:function(){return u}});var i=s(24246),n=s(34090),l=s(27378),a=s(16134),r=s(38602),d=s(58452);let o=(0,l.createRef)(),c=(0,l.createRef)(),u=()=>{let e=(0,a.T)(),t=(0,a.C)(r.DB),s=(0,l.useCallback)(()=>{c.current=void 0,o.current=void 0},[]),i=(0,l.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!0),s())},[e,s]),n=(0,l.useCallback)(()=>{e((0,r.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,l.useCallback)(()=>t?(e((0,r.h7)()),o.current||(o.current=new Promise(e=>{c.current=e})),o.current):Promise.resolve(!0),[t,e]),onConfirm:i,onClose:n}},m=e=>{let{id:t,name:s}=e,{dirty:i}=(0,n.u6)(),d=(0,a.T)();return(0,l.useEffect)(()=>(d((0,r.Zu)({id:t,name:s})),()=>{d((0,r.dz)({id:t}))}),[d,t,s]),(0,l.useEffect)(()=>{d((0,r.$p)({id:t,isDirty:i}))},[i,d,t]),null},x=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,a.C)(r.uv);return(0,i.jsx)(d.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},84720:function(e,t,s){s.d(t,{q:function(){return j}});var i=s(24246),n=s(27824),l=s(27378),a=s(34090),r=s(812),d=s(45938),o=s(14048),c=s(95492);let u=e=>{let{systems:t,dataFlows:s,onDataFlowSystemChange:l}=e,{setFieldValue:r}=(0,a.u6)(),d=s.map(e=>e.fides_key),o=e=>{let t=s.filter(t=>t.fides_key!==e.fides_key);r("dataFlowSystems",t),l(t)};return(0,i.jsxs)(n.iA_,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,i.jsx)(n.hrZ,{children:(0,i.jsxs)(n.Tr,{children:[(0,i.jsx)(n.Th,{children:"System"}),(0,i.jsx)(n.Th,{})]})}),(0,i.jsx)(n.p3B,{children:t.filter(e=>d.includes(e.fides_key)).map(e=>(0,i.jsxs)(n.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,i.jsx)(n.Td,{children:(0,i.jsx)(n.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,i.jsx)(n.Td,{textAlign:"end",children:(0,i.jsx)(n.wpx,{"aria-label":"Unassign data flow from system",icon:(0,i.jsx)(c.l,{}),onClick:()=>o(e),"data-testid":"unassign-btn"})})]},e.fides_key))})]})};var m=s(26917),x=e=>{let{allSystems:t,dataFlowSystems:s,onChange:l,flowType:r}=e,{setFieldValue:d}=(0,a.u6)(),o=e=>{if(s.find(t=>t.fides_key===e.fides_key)){let t=s.filter(t=>t.fides_key!==e.fides_key);d("dataFlowSystems",t),l(t)}else{let t=[...s,{fides_key:e.fides_key,type:"system"}];d("dataFlowSystems",t),l(t)}};return(0,i.jsx)(n.xuv,{overflowY:"auto",maxHeight:"300px",children:(0,i.jsxs)(n.iA_,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,i.jsx)(n.hrZ,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,i.jsxs)(n.Tr,{children:[(0,i.jsx)(n.Th,{children:"System"}),(0,i.jsxs)(n.Th,{textAlign:"right",children:["Set as ",r]})]})}),(0,i.jsx)(n.p3B,{children:t.map(e=>{let t=!!s.find(t=>t.fides_key===e.fides_key);return(0,i.jsxs)(n.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,i.jsx)(n.Td,{children:(0,i.jsx)(n.xvT,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,i.jsx)(n.Td,{textAlign:"right",children:(0,i.jsx)(n.rAg,{checked:t,onChange:()=>o(e),"data-testid":"assign-switch"})})]},e.fides_key)})})]})})};let f=(e,t)=>{var s,i;return(null===(s=e.name)||void 0===s?void 0:s.toLocaleLowerCase().includes(t.toLocaleLowerCase()))||(null===(i=e.description)||void 0===i?void 0:i.toLocaleLowerCase().includes(t.toLocaleLowerCase()))};var h=e=>{let{currentSystem:t,systems:s,isOpen:r,onClose:d,dataFlowSystems:o,onDataFlowSystemChange:c,flowType:u}=e,{setFieldValue:h}=(0,a.u6)(),[p,y]=(0,l.useState)(""),[g,C]=(0,l.useState)(o),j=async()=>{c(g),d()},v=0===s.length,_=(0,l.useMemo)(()=>s?s.filter(e=>e.fides_key!==t.fides_key).filter(e=>f(e,p)):[],[s,t.fides_key,p]),k=(0,l.useMemo)(()=>{let e=new Set(g.map(e=>e.fides_key));return _.every(t=>e.has(t.fides_key))},[_,g]);return(0,i.jsxs)(n.u_l,{isOpen:r,onClose:d,size:"2xl",isCentered:!0,children:[(0,i.jsx)(n.ZAr,{}),(0,i.jsxs)(n.hzk,{p:8,"data-testid":"confirmation-modal",children:[(0,i.jsxs)(n.xBx,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,i.jsxs)(n.xvT,{fontSize:"2xl",lineHeight:8,fontWeight:"semibold",children:["Configure ",u.toLocaleLowerCase()," systems"]}),(0,i.jsxs)(n.j8w,{color:"success",children:["Assigned to ",g.length," systems"]})]}),(0,i.jsx)(n.fef,{"data-testid":"assign-systems-modal-body",children:v?(0,i.jsx)(n.xvT,{children:"No systems found"}):(0,i.jsxs)(n.Kqy,{spacing:4,children:[(0,i.jsxs)(n.kCb,{justifyContent:"space-between",children:[(0,i.jsx)(n.xvT,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Add or remove destination systems from your data map"}),(0,i.jsx)(n.xuv,{children:(0,i.jsxs)(n.NIc,{display:"flex",alignItems:"center",children:[(0,i.jsx)(n.lXp,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,i.jsx)(n.rAg,{size:"small",id:"assign-all-systems",checked:k,onChange:e=>{if(e&&s){let e=_.map(e=>({fides_key:e.fides_key,type:"system"}));h("dataFlowSystems",e),C(e)}else C([])},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,i.jsx)(m.Z,{value:p,onChange:y,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,i.jsx)(x,{flowType:u,allSystems:_,dataFlowSystems:g,onChange:C})]})}),(0,i.jsxs)(n.mzw,{justifyContent:"flex-start",children:[(0,i.jsx)(n.wpx,{onClick:d,className:"mr-2","data-testid":"cancel-btn",children:"Cancel"}),!v&&(0,i.jsx)(n.wpx,{type:"primary",onClick:j,"data-testid":"confirm-btn",children:"Confirm"})]})]})]})},p=s(46628),y=s(1315);let g={dataFlowSystems:[]},C=e=>{let{system:t,isIngress:s,isSystemTab:c}=e,m=(0,n.pmc)(),x=s?"Source":"Destination",f="".concat(x,"s"),C=(0,n.qY0)(),[j]=(0,y.qQ)(),{data:v=[]}=(0,y.K3)(),_=(0,l.useMemo)(()=>{let e=s?t.ingress:t.egress;e||(e=[]);let i=v?v.map(e=>e.fides_key):[];return e.filter(e=>i.includes(e.fides_key))},[s,t,v]),[k,b]=(0,l.useState)(_);(0,l.useEffect)(()=>{b(_)},[_]);let w=async(e,i)=>{let{dataFlowSystems:n}=e,{resetForm:l}=i,a={...t,ingress:s?n:t.ingress,egress:s?t.egress:n},d=await j(a);(0,r.D4)(d)?m((0,p.Vo)("Failed to update data flows")):m((0,p.t5)("".concat(f," updated"))),l({values:{dataFlowSystems:n}})};return(0,i.jsxs)(n.Qdk,{children:[(0,i.jsx)(n.KFZ,{height:"68px",paddingLeft:c?6:2,"data-testid":"data-flow-button-".concat(x),children:(0,i.jsxs)(n.kCb,{alignItems:"center",justifyContent:"start",flex:1,textAlign:"left",children:[(0,i.jsx)(n.xvT,{fontSize:"sm",lineHeight:5,fontWeight:"semibold",mr:2,children:f}),(0,i.jsx)(n.Vp9,{ml:2,backgroundColor:"primary.400",borderRadius:"6px",color:"white",children:k.length}),(0,i.jsx)(n.LZC,{}),(0,i.jsx)(n.XEm,{})]})}),(0,i.jsx)(n.Hk3,{backgroundColor:"gray.50",padding:6,"data-testid":"data-flow-panel-".concat(x),children:(0,i.jsx)(n.Kqy,{borderRadius:"md",backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:(0,i.jsx)(a.J9,{initialValues:g,onSubmit:w,children:e=>{let{isSubmitting:s,dirty:l,resetForm:r}=e;return(0,i.jsxs)(a.l0,{children:[(0,i.jsx)(d.Gt,{id:"".concat(t.fides_key,":").concat(x),name:"".concat(x," Data Flow")}),(0,i.jsx)(n.wpx,{onClick:C.onOpen,type:"primary",size:"small",icon:(0,i.jsx)(o.A5,{}),iconPosition:"end",className:"mb-4","data-testid":"assign-systems-btn",children:"Configure ".concat(f.toLocaleLowerCase())}),(0,i.jsx)(u,{systems:v,dataFlows:k,onDataFlowSystemChange:b}),(0,i.jsxs)("div",{className:"mt-6 flex gap-2",children:[(0,i.jsx)(n.wpx,{disabled:!l&&k===_,onClick:()=>{b(_),r({values:{dataFlowSystems:_}})},"data-testid":"cancel-btn",children:"Cancel"}),(0,i.jsx)(n.wpx,{type:"primary",htmlType:"submit",loading:s,disabled:!l&&k===_,"data-testid":"save-btn",children:"Save"})]}),C.isOpen?(0,i.jsx)(h,{currentSystem:t,systems:v,isOpen:C.isOpen,onClose:C.onClose,dataFlowSystems:k,onDataFlowSystemChange:b,flowType:x}):null]})}})})})]})},j=e=>{let{system:t,isSystemTab:s}=e;return(0,i.jsxs)(n.UQy,{allowToggle:!0,"data-testid":"data-flow-accordion",children:[(0,i.jsx)(C,{system:t,isIngress:!0,isSystemTab:s}),(0,i.jsx)(C,{system:t,isSystemTab:s})]})}},30234:function(e,t,s){var i=s(24246),n=s(27824);t.Z=e=>{let{heading:t,HeadingButton:s,children:l}=e;return(0,i.jsx)(n.Kqy,{spacing:4,children:(0,i.jsxs)(n.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(n.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(n.X6q,{as:"h3",size:"xs",children:t}),s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.LZC,{}),(0,i.jsx)(s,{})]}):null]}),(0,i.jsx)(n.Kqy,{spacing:4,px:6,py:6,children:l})]})})}},52368:function(e,t,s){s.d(t,{f:function(){return d}});var i=s(16134),n=s(30002),l=s(28079),a=s(41966),r=s(57072);let d=e=>{let{includeDatasets:t,includeDisabled:s}=e,{isLoading:d}=(0,r.MO)(),{isLoading:o}=(0,n.te)(),{isLoading:c}=(0,l.fd)(),{isLoading:u}=(0,a.LH)({onlyUnlinkedDatasets:!1,minimal:!0},{skip:!t}),m=(0,i.C)(r.qb),x=(0,i.C)(r.Bd),f=(0,i.C)(n.ZL),h=(0,i.C)(n.H7),p=(0,i.C)(l.U3),y=(0,i.C)(l.jp),g=(0,i.C)(a.Q4);return{allDataCategories:s?m:x,allDataSubjects:s?f:h,allDataUses:s?p:y,allDatasets:t?g:void 0,isLoading:d||o||c||u}}},31883:function(e,t,s){s.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=s(19043)}}]);