<?xml version="1.0" encoding="utf-8" ?>
<!--
  Copyright 2025 Akretion France (https://www.akretion.com/)
  @author: Alexis de Lattre <alexis.delattre@akretion.com>
  License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
-->
<odoo noupdate="0">


<record id="stay_controller_notify" model="mail.template">
    <field name="name">Stay: Notify stay creation/update/cancel from web form</field>
    <field name="model_id" ref="stay.model_stay_stay" />
    <field name="email_from">${object.company_id.email}</field>
    <field
            name="partner_to"
        >${object.group_id and object.group_id.notify_user_ids and str(object.group_id.notify_user_ids.partner_id.ids)[1:-1] or (object.company_id.stay_notify_user_ids and str(object.company_id.stay_notify_user_ids.partner_id.ids)[1:-1])}</field>
    <field name="reply_to">${object.controller_email}</field>
    <field name="auto_delete" eval="False" />
    <field
            name="subject"
        >Stay ${ctx.get('action_description')}: ${object.partner_name} ${format_date(object.arrival_date)} â†’ ${format_date(object.departure_date)} x ${object.guest_qty}</field>
    <field name="lang">${object.company_id.partner_id.lang}</field>
    <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
        <p
                    style="margin: 0px; padding: 0px; font-size: 13px;"
                >Stay ${object.name} has been ${ctx.get('action_description')} via the web form:</p>
        <ul>
                <li>Guest: ${object.partner_name}</li>
                <li>Guest Qty: ${object.guest_qty}</li>
                <li
                    >Arrival: ${format_date(object.arrival_date)} ${dict(object.fields_get('arrival_time', 'selection')['arrival_time']['selection'])[object.arrival_time]}</li>
                % if object.arrival_note:
                <li>Arrival Note: ${object.arrival_note}</li>
                % endif
                <li
                    >Departure: ${format_date(object.departure_date)} ${dict(object.fields_get('departure_time', 'selection')['departure_time']['selection'])[object.departure_time]}</li>
                % if object.departure_note:
                <li>Departure Note: ${object.departure_note}</li>
                % endif
                % if object.group_id:
                <li>Group: ${object.group_id.display_name}</li>
                % endif
                % if object.controller_email:
                <li>E-mail: ${object.controller_email}</li>
                % endif
                % if object.controller_phone:
                <li>Phone: ${object.controller_phone}</li>
                % endif
                % if object.controller_mobile:
                <li>Mobile: ${object.controller_mobile}</li>
                % endif
                % if object.controller_message:
                <li>Guest message: ${object.controller_message}</li>
                % endif
                % if object.controller_notes:
                <li>Other information: ${object.controller_notes}</li>
                % endif
                % if object.controller_country_id:
                <li>Country: ${object.controller_country_id.name}</li>
                % endif
            </ul>
</div>
    </field>
</record>


</odoo>
