{
  "_template_info": {
    "name": "Homodyne Static Anisotropic Mode Configuration",
    "version": "2.1",
    "description": "Specialized configuration for static anisotropic scattering analysis",
    "based_on": "config_template.json - specialized for anisotropic static mode",
    "usage": "Copy this template for anisotropic static scattering experiments",
    "mode": "static_anisotropic",
    "package_version": "0.6.1",
    "template_updated": "2024-08-19",
    "key_features": [
      "Static mode with no flow effects",
      "Anisotropic scattering - uses angle selection",
      "phi_angles_file loaded for angle information",
      "Angle filtering enabled for optimization",
      "Only diffusion parameters (D0, alpha, D_offset) are relevant",
      "Per-angle scaling optimization for accurate anisotropic analysis"
    ],
    "_scaling_optimization_benefits_anisotropic": {
      "overview": "Per-angle scaling optimization (g₂ = offset + contrast × g₁) essential for anisotropic analysis",
      "per_angle_scaling": "Independent scaling for each scattering angle accounts for angular variations",
      "anisotropy_detection": "Variations in scaling parameters may reveal sample anisotropy",
      "robust_analysis": "Proper chi-squared calculation across all scattering angles"
    },
    "_when_to_use_this_template": [
      "Sample exhibits angular dependence in scattering",
      "No flow but orientation or structure anisotropy expected",
      "Need angle-resolved analysis with 3-parameter diffusion model",
      "Crystalline samples, oriented fibers, or structured materials",
      "Want to detect and quantify anisotropic effects"
    ]
  },
  "metadata": {
    "_comment": "Project metadata for static anisotropic analysis",
    "config_version": "6.1",
    "description": "Static Anisotropic Scattering Analysis - No flow, with angular dependence",
    "analysis_mode": "static_anisotropic",
    "created_date": "YYYY-MM-DD",
    "updated_date": "YYYY-MM-DD",
    "authors": [
      "Your Name"
    ],
    "institution": "Your Institution",
    "experiment_name": "Static Anisotropic Scattering Experiment",
    "sample_description": "Sample description for static measurement with angle selection",
    "script_compatibility": "homodyne v0.6.1",
    "_cli_usage": {
      "description": "CLI usage for static anisotropic analysis",
      "recommended_commands": [
        "homodyne-config --mode static_anisotropic --sample SAMPLE_NAME",
        "homodyne --config config.json --static-anisotropic --method classical",
        "homodyne --config config.json --static-anisotropic --method all"
      ]
    }
  },
  "experimental_data": {
    "_comment": "Data configuration for anisotropic static mode",
    "description": "Data source configuration - phi_angles_file loaded for angle selection",
    "data_folder_path": "./data/SAMPLE_NAME/",
    "data_file_name": "your_data_file.hdf",
    "phi_angles_path": "./data/phi_angles/",
    "_phi_angles_path_note": "Directory containing scattering angle information",
    "phi_angles_file": "phi_list.txt",
    "_phi_angles_file_note": "File with phi angles - loaded in anisotropic mode",
    "exchange_key": "exchange",
    "cache_file_path": "./data/SAMPLE_NAME/",
    "cache_filename_template": "cached_c2_anisotropic_frames_{start_frame}_{end_frame}.npz",
    "cache_compression": true,
    "data_type": "float64",
    "file_format": "NPZ",
    "preprocessing": {
      "_comment": "Standard preprocessing for anisotropic mode",
      "apply_diagonal_correction": true,
      "vectorized_correction": true,
      "cache_processed_data": true,
      "normalize_data": true,
      "normalization_method": "baseline"
    }
  },
  "analyzer_parameters": {
    "_comment": "Analysis parameters for static anisotropic mode",
    "temporal": {
      "dt": 0.1,
      "_dt_note": "Time step - important for diffusion analysis (typical: 0.01-1.0s)",
      "dt_unit": "seconds",
      "start_frame": 100,
      "_start_frame_note": "First frame to analyze (typical: 50-500)",
      "end_frame": 1000,
      "_end_frame_note": "Last frame to analyze (typical: 500-2000)"
    },
    "scattering": {
      "wavevector_q": 0.01,
      "_wavevector_q_note": "q-vector magnitude for angle-dependent analysis (typical: 0.001-0.1 Å⁻¹)",
      "q_unit": "Å⁻¹"
    },
    "geometry": {
      "_comment": "Geometry parameters - gap kept for consistency",
      "stator_rotor_gap": 1000000,
      "_stator_rotor_gap_note": "Gap between stator and rotor (100μm typical)",
      "gap_unit": "Å",
      "gap_in_microns": 100,
      "_gap_note": "Gap parameter kept for consistency but not used in static mode"
    },
    "computational": {
      "num_threads": "auto",
      "_num_threads_note": "Number of CPU threads ('auto' recommended)",
      "auto_detect_cores": true,
      "max_threads_limit": 12,
      "_max_threads_limit_note": "Maximum threads limit (balanced for typical systems)",
      "memory_limit_gb": 16,
      "_memory_limit_gb_note": "Memory limit (adjusted for modern systems)"
    }
  },
  "initial_parameters": {
    "_comment": "Initial parameters for static anisotropic mode - only diffusion parameters matter",
    "description": "Only D0, alpha, D_offset are physically meaningful in static anisotropic mode",
    "values": [
      100.0,
      0.0,
      10.0,
      0.0,
      0.0,
      0.0,
      0.0
    ],
    "_values_note": "Last 4 parameters (shear + phi0) automatically set to 0 in static mode",
    "parameter_names": [
      "D0",
      "alpha",
      "D_offset",
      "gamma_dot_t0",
      "beta",
      "gamma_dot_t_offset",
      "phi0"
    ],
    "units": [
      "Å²/s",
      "dimensionless",
      "Å²/s",
      "s⁻¹",
      "dimensionless",
      "s⁻¹",
      "degrees"
    ],
    "physical_meaning": {
      "D0": "Reference diffusion coefficient - PRIMARY PARAMETER",
      "alpha": "Power-law exponent for D(t) evolution - PRIMARY PARAMETER",
      "D_offset": "Baseline diffusion coefficient - PRIMARY PARAMETER",
      "gamma_dot_t0": "Ignored in static mode (automatically set to 0)",
      "beta": "Ignored in static mode (automatically set to 0)",
      "gamma_dot_t_offset": "Ignored in static mode (automatically set to 0)",
      "phi0": "Ignored in static mode (automatically set to 0)"
    },
    "active_parameters": [
      "D0",
      "alpha",
      "D_offset"
    ],
    "_active_parameters_note": "Only these 3 parameters are optimized in static anisotropic mode"
  },
  "optimization_config": {
    "_comment": "Optimization for static anisotropic mode with angle filtering",
    "angle_filtering": {
      "_comment": "Angle filtering enabled in anisotropic mode for optimization efficiency",
      "enabled": true,
      "_enabled_note": "Enabled to focus optimization on specific angular ranges",
      "target_ranges": [
        {
          "min_angle": -10.0,
          "max_angle": 10.0,
          "_note": "Primary angular range around 0 degrees"
        },
        {
          "min_angle": 170.0,
          "max_angle": 190.0,
          "_note": "Secondary angular range around 180 degrees"
        }
      ],
      "fallback_to_all_angles": true,
      "_fallback_note": "Use all angles if no angles found in target ranges"
    },
    "classical_optimization": {
      "methods": [
        "Nelder-Mead"
      ],
      "method_options": {
        "Nelder-Mead": {
          "maxiter": 3000,
          "_maxiter_note": "Reduced iterations since only 3 parameters to optimize",
          "xatol": 1e-08,
          "fatol": 1e-08,
          "adaptive": true
        }
      }
    },
    "mcmc_sampling": {
      "enabled": true,
      "sampler": "NUTS",
      "draws": 8000,
      "_draws_note": "Fewer draws needed with only 3 parameters",
      "tune": 1000,
      "thin": 2,
      "_thin_note": "Moderate thinning for static mode (good convergence expected)",
      "chains": 4,
      "cores": 4,
      "target_accept": 0.95,
      "max_treedepth": 10,
      "return_inferencedata": true
    },
    "scaling_parameters": {
      "_comment": "Physical scaling constraints for c2 fitting",
      "fitted_range": {
        "min": 1.0,
        "max": 2.0,
        "_description": "c2_fitted = c2_theory * contrast + offset, must be in [1,2]"
      },
      "theory_range": {
        "min": 0.0,
        "max": 1.0,
        "_description": "c2_theory normalized correlation function, must be in [0,1]"
      },
      "contrast": {
        "min": 0.05,
        "max": 0.5,
        "prior_mu": 0.3,
        "prior_sigma": 0.1,
        "type": "TruncatedNormal",
        "_description": "Scaling factor for correlation strength, typically ∈ (0, 0.5]"
      },
      "offset": {
        "min": 0.05,
        "max": 1.95,
        "prior_mu": 1.0,
        "prior_sigma": 0.2,
        "type": "TruncatedNormal",
        "_description": "Baseline correlation level, typically ∈ (0, 2.0), μ ≈ 1.0"
      }
    }
  },
  "parameter_space": {
    "_comment": "Parameter bounds - only first 3 are used in static anisotropic mode",
    "bounds": [
      {
        "name": "D0",
        "min": 1.0,
        "max": 1000000.0,
        "type": "TruncatedNormal",
        "prior_mu": 10000.0,
        "prior_sigma": 1000.0,
        "unit": "Å²/s",
        "physical_constraint": "positive",
        "_note": "PRIMARY PARAMETER - reference diffusion coefficient (typical colloidal systems)"
      },
      {
        "name": "alpha",
        "min": -2.0,
        "max": 2.0,
        "type": "Normal",
        "prior_mu": -1.5,
        "prior_sigma": 0.1,
        "unit": "dimensionless",
        "physical_constraint": "none",
        "_note": "PRIMARY PARAMETER - diffusion time dependence (sub-/superdiffusion range)"
      },
      {
        "name": "D_offset",
        "min": -100,
        "max": 100,
        "type": "Normal",
        "prior_mu": 0.0,
        "prior_sigma": 10.0,
        "unit": "Å²/s",
        "physical_constraint": "none",
        "_note": "PRIMARY PARAMETER - baseline diffusion coefficient (typically small vs D0)"
      },
      {
        "name": "gamma_dot_t0",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "s⁻¹",
        "physical_constraint": "fixed_zero",
        "_reference_min": 1e-06,
        "_reference_max": 1.0,
        "_reference_type": "TruncatedNormal",
        "_reference_prior_mu": 0.001,
        "_reference_prior_sigma": 0.01
      },
      {
        "name": "beta",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "dimensionless",
        "physical_constraint": "fixed_zero",
        "_reference_min": -2.0,
        "_reference_max": 2.0,
        "_reference_type": "Normal",
        "_reference_prior_mu": 0.0,
        "_reference_prior_sigma": 0.1
      },
      {
        "name": "gamma_dot_t_offset",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "s⁻¹",
        "physical_constraint": "fixed_zero",
        "_reference_min": -0.01,
        "_reference_max": 0.01,
        "_reference_type": "Normal",
        "_reference_prior_mu": 0.0,
        "_reference_prior_sigma": 0.001
      },
      {
        "name": "phi0",
        "min": 0.0,
        "max": 0.0,
        "_bounds_note": "Fixed at 0 in static mode",
        "type": "fixed",
        "unit": "degrees",
        "physical_constraint": "fixed_zero",
        "_reference_min": -10,
        "_reference_max": 10,
        "_reference_type": "Normal",
        "_reference_prior_mu": 0.0,
        "_reference_prior_sigma": 5.0
      }
    ]
  },
  "analysis_settings": {
    "_comment": "Static anisotropic mode configuration",
    "static_mode": true,
    "_static_mode_note": "REQUIRED: Must be true for static analysis",
    "static_submode": "anisotropic",
    "_static_submode_note": "REQUIRED: Must be 'anisotropic' for this template",
    "model_description": {
      "current_mode": "static_anisotropic_case",
      "equation": "g₁(t₁,t₂) = exp(-q² ∫ᵗ²ᵗ¹ D(t)dt), g₂(t₁,t₂) ~ [g₁(t₁,t₂)]²",
      "description": "Pure diffusion with angle filtering for optimization efficiency",
      "key_features": [
        "No flow effects (γ̇ = 0)",
        "Uses angle selection for optimization efficiency",
        "Only diffusion dynamics D(t) = D₀(t/t₀)^α + D_offset",
        "3 active parameters: D0, alpha, D_offset",
        "Angle filtering reduces computational cost"
      ]
    }
  },
  "advanced_settings": {
    "data_loading": {
      "use_diagonal_correction": true,
      "vectorized_diagonal_fix": true
    },
    "chi_squared_calculation": {
      "method": "standard",
      "_scaling_optimization_note": "Scaling optimization is always enabled: g₂ = offset + contrast × g₁. This is essential for proper chi-squared calculation regardless of mode or number of angles.",
      "_scaling_details": {
        "_purpose": "Performs least squares fitting to determine contrast and offset parameters",
        "_accounts_for": [
          "instrumental response",
          "background signals",
          "detector variations",
          "normalization differences"
        ],
        "_chi_squared_formula": "χ² = Σ(experimental - fitted)²/σ² where fitted = theory × contrast + offset",
        "_implementation": "Uses numpy.linalg.lstsq to solve A·x = b where A = [theory, ones], x = [contrast, offset]",
        "_anisotropic_mode_considerations": [
          "Per-angle scaling optimization accounts for angular variations",
          "Different contrast/offset values expected for different scattering angles",
          "Angular dependence in scaling factors may reveal sample anisotropy",
          "More robust fitting quality assessment across angular range"
        ],
        "_typical_values_anisotropic": {
          "contrast": "0.2-5.0 (wider range due to angular variations)",
          "offset": "0.0-0.1 (may vary significantly with angle)",
          "angular_variation": "contrast and offset values may show systematic angular dependence"
        },
        "_interpretation_guidelines": [
          "Systematic angular variation in contrast may indicate sample anisotropy",
          "Large offset variations suggest angle-dependent background signals",
          "Check for correlation between contrast values and scattering angle"
        ]
      },
      "uncertainty_estimation_factor": 0.1,
      "minimum_sigma": 1e-10,
      "fast_computation": true,
      "validity_check": {
        "check_positive_D0": true,
        "check_positive_gamma_dot_t0": false,
        "_check_positive_gamma_dot_t0_note": "Disabled - parameter fixed at 0",
        "check_positive_time_dependent": true,
        "check_parameter_bounds": true
      }
    }
  },
  "performance_settings": {
    "caching": {
      "enable_memory_cache": true,
      "enable_disk_cache": true,
      "cache_size_limit_mb": 1000,
      "auto_cleanup": true
    },
    "parallel_processing": {
      "enable_multiprocessing": true,
      "chunk_size": "auto",
      "backend": "threading"
    },
    "noise_model": {
      "use_simple_forward_model": false,
      "sigma_prior": 0.1,
      "_anisotropic_note": "Simple forward model with per-angle considerations"
    }
  },
  "output_settings": {
    "reporting": {
      "generate_plots": true,
      "plot_formats": [
        "png",
        "pdf"
      ],
      "detailed_summary": true
    },
    "plotting": {
      "general": {
        "create_plots": true,
        "plot_format": "png",
        "dpi": 300,
        "figure_size": [
          10,
          8
        ],
        "style": "publication"
      },
      "c2_heatmaps": {
        "enabled": true,
        "_enabled_note": "Multi-angle heatmaps for anisotropic mode",
        "layout": "single_row",
        "include_experimental": true,
        "include_theoretical": true,
        "include_residuals": true,
        "title_prefix": "C2 Anisotropic Static Mode"
      },
      "mcmc_plots": {
        "enabled": true,
        "corner_plots": {
          "enabled": true,
          "figsize": [
            8,
            8
          ],
          "_figsize_note": "Compact size for 3x3 parameter space"
        },
        "trace_plots": {
          "enabled": true,
          "figsize": [
            10,
            6
          ],
          "_figsize_note": "Compact layout for 3 parameters"
        }
      }
    }
  },
  "_usage_notes": {
    "description": "Specific usage notes for static anisotropic mode",
    "key_differences": [
      "phi_angles_file is loaded and used for angle selection",
      "Angle filtering is enabled for optimization efficiency",
      "Only 3 parameters (D0, alpha, D_offset) are optimized",
      "Shear and phi0 parameters are automatically set to 0",
      "Uses per-angle scaling optimization",
      "Computational cost reduced via angle filtering"
    ],
    "when_to_use": [
      "Static samples with no applied flow or rotation",
      "When angle-dependent optimization efficiency is desired",
      "Systems where angle filtering can reduce computational cost",
      "Cases where you want to focus on specific scattering angles"
    ],
    "performance_benefits": [
      "Faster optimization (3 vs 7 parameters)",
      "Angle filtering reduces data points processed",
      "Per-angle scaling for better fit quality",
      "Maintains full angle information while optimizing efficiency"
    ],
    "angle_filtering_notes": [
      "Target angles around 0° and 180° are typical for scattering",
      "Fallback to all angles if no targets found prevents failures",
      "Can be adjusted based on your specific angular requirements",
      "Reduces computational cost while maintaining accuracy"
    ]
  },
  "validation_rules": {
    "_comment": "Validation rules for static anisotropic mode",
    "fit_quality": {
      "_comment": "Classical optimization fit quality for 3-parameter anisotropic analysis",
      "_applies_to": "Classical optimization using Nelder-Mead method",
      "overall_chi_squared": {
        "excellent_threshold": 2.0,
        "acceptable_threshold": 5.0,
        "warning_threshold": 10.0,
        "critical_threshold": 20.0,
        "_anisotropic_note": "Anisotropic analysis may show higher chi-squared due to angle selection"
      },
      "per_angle_chi_squared": {
        "excellent_threshold": 2.0,
        "acceptable_threshold": 5.0,
        "warning_threshold": 10.0,
        "outlier_threshold_multiplier": 2.5,
        "max_outlier_fraction": 0.25,
        "min_good_angles": 3,
        "_min_good_angles_note": "Minimum 3 angles needed for reliable anisotropic analysis"
      }
    },
    "mcmc_convergence": {
      "_comment": "MCMC convergence validation for 3-parameter static anisotropic analysis",
      "_applies_to": "MCMC/NUTS sampling methods only",
      "_note": "Anisotropic mode uses MCMC convergence diagnostics instead of chi-squared",
      "rhat_thresholds": {
        "_comment": "R-hat thresholds for 3-parameter anisotropic model with angle filtering",
        "excellent_threshold": 1.01,
        "_excellent_threshold_note": "R̂ ≤ 1.01 indicates excellent convergence",
        "good_threshold": 1.05,
        "_good_threshold_note": "R̂ ≤ 1.05 indicates good convergence for anisotropic model",
        "acceptable_threshold": 1.1,
        "_acceptable_threshold_note": "R̂ ≤ 1.1 indicates acceptable convergence",
        "critical_threshold": 1.15,
        "_critical_threshold_note": "R̂ > 1.15 indicates poor convergence"
      },
      "ess_thresholds": {
        "_comment": "ESS thresholds for 3-parameter anisotropic space with angle filtering",
        "excellent_threshold": 400,
        "_excellent_threshold_note": "ESS ≥ 400 excellent for 3-parameter space",
        "good_threshold": 200,
        "_good_threshold_note": "ESS ≥ 200 good for anisotropic analysis",
        "acceptable_threshold": 100,
        "_acceptable_threshold_note": "ESS ≥ 100 acceptable for static anisotropic",
        "minimum_threshold": 50,
        "_minimum_threshold_note": "ESS < 50 inadequate for parameter estimates"
      },
      "divergence_thresholds": {
        "_comment": "Divergence criteria for anisotropic geometry with angle filtering",
        "max_divergences_fraction": 0.01,
        "_max_divergences_fraction_note": "1% max divergences for 3-parameter anisotropic model",
        "warning_divergences_fraction": 0.005,
        "_warning_divergences_fraction_note": "0.5% divergences warrants investigation"
      },
      "quality_assessment": {
        "_comment": "Anisotropic-specific MCMC quality criteria",
        "excellent_criteria": "R̂ < 1.01 AND ESS > 400 AND divergences < 0.5%",
        "good_criteria": "R̂ < 1.05 AND ESS > 200 AND divergences < 1%",
        "acceptable_criteria": "R̂ < 1.1 AND ESS > 100 AND divergences < 1%",
        "poor_criteria": "Any criterion fails to meet acceptable threshold",
        "_anisotropic_note": "3-parameter anisotropic model with angle filtering should converge efficiently"
      }
    },
    "parameter_validation": {
      "_comment": "Parameter validation for static anisotropic mode",
      "check_bounds": true,
      "physics_constraints": true,
      "correlation_checks": true,
      "_anisotropic_constraints": [
        "D0 must be positive (physical diffusion)",
        "Only D0, alpha, D_offset are optimized",
        "Flow parameters automatically set to 0",
        "phi0 automatically set to 0 (irrelevant in static mode)",
        "Angle filtering applied during optimization"
      ]
    }
  }
}