[project]
name = "sciop-cli"
dynamic = []
description = "A CLI for sciop"
authors = [
    { name = "cosmicexplorer", email = "dmcC2@hypnicjerk.ai" },
    { name = "sneakers-the-rat", email = "sneakers-the-rat@protonmail.com" },
]
dependencies = [
    "libtorrent>=2.0.11",
    "click>=8.1.8",
    "click-option-group>=0.5.6",
    "pydantic>=2.10.6",
    "bencode-rs>=0.0.7",
    "platformdirs>=4.3.8",
    "requests>=2.32.3",
    "tqdm>=4.67.1",
    "rich>=14.0.0",
    "humanize>=4.12.2",
    "pydantic-settings>=2.9.1",
    "keyring>=25.6.0",
    "pyyaml>=6.0.2",
    "zstandard>=0.22",
    "qbittorrent-api>=2025.5.0",
    "typing-extensions>=4.10.0;python_version<\"3.12\"",
]
requires-python = ">=3.11"
readme = "README.md"
version = "0.3.0"

[project.license]
text = "EUPL-1.2"

[project.urls]
repository = "https://codeberg.org/safeguarding/sciop-cli"
homepage = "https://sciop.net"

[project.optional-dependencies]
mypy = [
    "mypy>=1.15",
    "types-tqdm>=4.67.0.20250401",
    "types-requests>=2.32.0.20250328",
    "types-PyYAML>=6.0.12.20250516",
]
dev = [
    "sciop-cli[mypy]",
    "ruff>=0.9.7",
    "black>=25.1.0",
]

[project.scripts]
sciop-cli = "sciop_cli.cli.main:cli"

[dependency-groups]
test = [
    "pytest>=8.3.4",
    "sciop[test] @ git+https://codeberg.org/Safeguarding/sciop.git@main",
    "pytest-asyncio>=1.0.0",
    "httpx>=0.28.1",
    "keyrings-alt>=5.0.2",
]

[build-system]
requires = [
    "pdm-backend",
]
build-backend = "pdm.backend"

[tool.pdm]
distribution = true

[tool.pdm.scripts]
test = "pytest"
mypy = "mypy"

[tool.pdm.scripts.lint]
composite = [
    "ruff check",
    "black . --diff",
    "mypy",
]

[tool.pdm.scripts.format]
composite = [
    "black .",
    "ruff check --fix",
]

[tool.pdm.version]
source = "scm"
tag_filter = "v*"
tag_regex = "v(?P<version>([1-9][0-9]*!)?(0|[1-9][0-9]*)(\\.(0|[1-9][0-9]*))*((a|b|c|rc)(0|[1-9][0-9]*))?(\\.post(0|[1-9][0-9]*))?(\\.dev(0|[1-9][0-9]*))?$)$"

[tool.ruff]
target-version = "py311"
include = [
    "src/sciop_cli/**/*.py",
    "tests/**/*.py",
    "pyproject.toml",
]
exclude = []
line-length = 100

[tool.ruff.lint]
select = [
    "E",
    "F",
    "UP",
    "B",
    "SIM",
    "I",
    "ANN",
    "T10",
    "D207",
    "D208",
    "D210",
    "D211",
    "D419",
    "N802",
    "FAST",
    "S608",
    "S701",
]
ignore = [
    "ANN401",
    "ANN204",
    "B905",
    "D107",
    "UP007",
    "UP038",
]
fixable = [
    "ALL",
]

[tool.ruff.lint.per-file-ignores]
"tests/**/test_*" = [
    "ANN001",
    "ANN201",
    "F841",
]
"tests/conftest.py" = [
    "F403",
    "E402",
]
"tests/fixtures/**/*" = [
    "F403",
]

[tool.black]
target-version = [
    "py311",
    "py312",
    "py313",
]
include = "(?:tests|sciop_cli)/.*\\.py$"
line-length = 100

[tool.mypy]
mypy_path = "$MYPY_CONFIG_FILE_DIR/src,$MYPY_CONFIG_FILE_DIR/stubs"
packages = [
    "sciop_cli",
]
warn_redundant_casts = true
warn_unused_ignores = true
show_error_context = true
show_column_numbers = true
show_error_code_links = true
pretty = true
color_output = true

[tool.pytest.ini_options]
asyncio_mode = "auto"
markers = "  v1: tests for v1 torrents\n  v2: tests for v2 torrents\n  hybrid: tests for hybrid torrents\n"
asyncio_default_fixture_loop_scope = "session"
