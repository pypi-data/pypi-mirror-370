# 2D ResNet Training Configuration
seed: 42

task_dim: 2d
# Model configuration
model:
  type: "classification"
  network:
    name: "mobilenet_v3_large"
    pretrained: true
  num_classes: 2

  # Metrics to compute
  metrics:
    accuracy:
      type: "accuracy"
    f1:
      type: "f1"
    precision:
      type: "precision"
    recall:
      type: "recall"
    auc:
      type: "auroc"
    specificity:
      type: "specificity"
    sensitivity:
      type: "sensitivity"
    npv:
      type: "npv"
    ppv:
      type: "ppv"
        
  # Loss configuration
  loss:
    type: "cross_entropy"
    weight: null
    label_smoothing: 0.0
  
  # Optimizer configuration
  optimizer:
    type: "adam"
    lr: 0.001
    weight_decay: 0.0001
  
  # Scheduler configuration
  scheduler:
    type: "cosine"
    T_max: 100
    eta_min: 0.00001

# Data configuration
data:
  type: "medical"
  batch_size: 4  # 增加batch_size以减少总批次数
  num_workers: 4
  data_dir: "data/classification"
  
  # Medical image format configuration
  image_format: "*.png"
  
  # Transform configuration for 2D data
  transforms:
    image_size: [224, 224]
    normalize: true
    augment: true
    
  # Data split configuration
  train_val_split: [0.8, 0.2]       # 当只有train文件夹的时候，自动进行划分
  seed: 42

# Training configuration
training:
  max_epochs: 10
  accelerator: "gpu"
  devices: [0,1,2,3]  # 修复devices格式
  precision: 16
  save_metrics: true
  export_onnx: true  # 训练完成后导出ONNX模型
  
  # Callbacks
  # early_stopping:
  #   monitor: "val/loss"
  #   patience: 10
  #   mode: "min"
  
  model_checkpoint:
    monitor: "val/accuracy"
    mode: "max"
    save_top_k: 1

# Validation configuration
validation:
  check_val_every_n_epoch: 1  # 改为每个epoch验证一次

# # Class names
# class_names:
#   - "Class_0"
#   - "Class_1"

# Output paths
outputs:
  output_dir: "outputs"

# ONNX Export configuration
onnx_export:
  opset_version: 11
onnx_opset_version: 11  # 兼容性配置

# Logging
logging:
  log_every_n_steps: 10
  wandb:
    enabled: false
    project: "medvision-2d-classification"
    entity: null
