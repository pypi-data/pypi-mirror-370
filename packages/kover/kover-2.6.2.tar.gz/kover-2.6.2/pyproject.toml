[project]
name = "kover"
version = "2.6.2"
description = "Fully async mongodb driver for mongod and replica sets."
readme = "README.md"
authors = [{ name = "megawattka", email = "gunter56741@gmail.com" }]
license = "MIT"
requires-python = ">=3.10"
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3 :: Only",
    "Topic :: Software Development :: Quality Assurance",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Topic :: Database",
    "Typing :: Typed",
]
keywords = [
    "kover",
    "mongodb",
    "mongo kover",
    "Mongo Kover",
    "Kover API mongo",
    "mongod driver",
    "async driver",
    "mongo async",
    "kover mongodb",
]
dependencies = [
    "dnspython >= 2.7.0",
    "pydantic >= 2.10.6",
    "typing-extensions >= 4.12.2",
]

[project.urls]
Repository = "https://github.com/megawattka/kover"
Documentation = "https://github.com/megawattka/kover"

[project.optional-dependencies]
snappy = ["python-snappy"]
zstd = ["zstd"]

[tool.ruff]
line-length = 79
indent-width = 4
target-version = "py310"

[tool.ruff.format]
quote-style = "double"
indent-style = "space"
docstring-code-line-length = "dynamic"

[tool.ruff.lint]
exclude = ["kover/bson"]
ignore = [
    "G004",  # f-string in logging statement
    "PGH003",  # type: ignore warnings
    "INP001",  # __init__.py in public namespaces
    "TD003",  # issue links for todos
    "D100",  # undocumented-public-module
    "FIX002",  # TODOs
    "TID252",  # fvck absolute imports
    "N818",  # "Error" suffix in exception class
    "S101",  # assertions
    "S324",  # I want to use sha1 please
    "D105",  # undocumented-magic-method
    "D107",  # undocumented-public-init
    "CPY001",  # Copyright notice at the top
    "DOC202", "DOC501",  # docs issues
    "PLR0913",  # too many arguments in function def
    "PLR0917",  # too many positional arguments in function def
    "PLR0904",  # too many public methods
    "PLR2004",  # int comparisons
    "EM101", "EM102", "TRY003",  # string literal in exception
    "D104",  # undocumented public package
    "DOC201",  # return not documented
    "DOC502",  # explicitly raised exceptions in docstrings
    # "TC001", "TC002", "TC003"  # move in if_type_checking block
]
select = ["ALL"]
unfixable = [
    "RUF100", # unused noqa
    "T20",  # removes print statements
    "F841", # removes unused variables
]
preview = true

[tool.ruff.lint.flake8-builtins]
strict-checking = true

[tool.ruff.lint.per-file-ignores]
"kover/__init__.py" = ["E501"]
"kover/metadata/definitions.py" = ["DOC402"]  # undocumented yield
"tests/*" = ["D101", "D102", "S106", "TC003", "TC002", "N802", "PT027"]  # undocumented public class/method, hardcoded password, type checking blocks uninitialized vars, lowercase names, unittest style
"main.py" = ["ERA001", "S106", "T201"]
"kover/network/compressors.py" = ["PLR6301"]  # Could be staticmethod no self
"kover/typings.py" = ["D102"]

[tool.ruff.lint.flake8-type-checking]
exempt-modules = ["typing", "typing_extensions"]
quote-annotations = true
strict = true

[tool.ruff.lint.isort]
force-sort-within-sections = true

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.uv]
link-mode="copy"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[dependency-groups]
dev = [
    "flake8 >= 7.3.0",
    "pymongo >= 4.14.0",
    "pyright >= 1.1.403",
    "ruff >= 0.12.3",
    "setuptools >= 80.9.0",
]

[tool.hatch.build]
include = [
    "/README.md",
    "/requirements.txt",
    "/CODE_OF_CONDUCT.md",
    "/kover"
]
exclude = [
    "/benchmarks",
    "/examples",
    "/tests",
    "/setup.py"
]

[tool.pyright]
exclude = ["kover/bson"]
typeCheckingMode = "strict"
