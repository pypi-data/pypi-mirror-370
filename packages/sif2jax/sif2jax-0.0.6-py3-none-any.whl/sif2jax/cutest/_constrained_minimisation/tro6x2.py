import jax.numpy as jnp

from .tro_base import TROBase


class TRO6X2(TROBase):
    """A minimum-compliance formulation of the truss topology problem.

    This problem minimizes c^T u subject to:
    - (sum_i=1:m x_i A_i) u = c
    - sum_i=1:m x_i <= 1
    - x >= 0

    Source: translation from the AMPL model tro_nlp.mod/tro_6x2.dat
    by Michal Kocvara (U. Birmingham)

    SIF input: Nick Gould, Nov 2009.

    classification LOR2-RN-45-21
    """

    y0_iD: int = 0
    provided_y0s: frozenset = frozenset({0})
    m_bars: int = 25  # number of bars
    n_dof: int = 20  # number of structure degrees of freedom
    n: int = 45  # total variables (m_bars + n_dof)
    m: int = 21  # total constraints (n_dof + 1)
    obj_idx: int = 17  # U18 is minimized (index 17 in U array)
    rhs_idx: int = 17  # C18 = 1.0 (index 17 in constraints)

    @property
    def args(self):
        # Store element data: (x_idx, u_idx, p_value) for each element
        elements = jnp.array(
            [
                (0, 0, 1.0),  # E1
                (1, 2, 0.25),  # E2
                (1, 2, 0.25),  # E3
                (1, 3, 0.25),  # E4
                (1, 3, 0.25),  # E5
                (2, 1, 1.0),  # E6
                (2, 1, -1.0),  # E7
                (2, 3, -1.0),  # E8
                (2, 3, 1.0),  # E9
                (3, 0, 0.25),  # E10
                (3, 0, -0.25),  # E11
                (3, 1, -0.25),  # E12
                (3, 1, 0.25),  # E13
                (4, 0, 1.0),  # E14
                (4, 0, -1.0),  # E15
                (4, 4, -1.0),  # E16
                (4, 4, 1.0),  # E17
                (5, 0, 0.25),  # E18
                (5, 0, 0.25),  # E19
                (5, 0, -0.25),  # E20
                (5, 0, -0.25),  # E21
                (5, 1, 0.25),  # E22
                (5, 1, 0.25),  # E23
                (5, 1, -0.25),  # E24
                (5, 1, -0.25),  # E25
                (5, 6, -0.25),  # E26
                (5, 6, -0.25),  # E27
                (5, 6, 0.25),  # E28
                (5, 6, 0.25),  # E29
                (5, 7, -0.25),  # E30
                (5, 7, -0.25),  # E31
                (5, 7, 0.25),  # E32
                (5, 7, 0.25),  # E33
                (6, 5, 1.0),  # E34
                (6, 5, -1.0),  # E35
                (6, 7, -1.0),  # E36
                (6, 7, 1.0),  # E37
                (7, 2, 0.25),  # E38
                (7, 2, -0.25),  # E39
                (7, 2, -0.25),  # E40
                (7, 2, 0.25),  # E41
                (7, 3, -0.25),  # E42
                (7, 3, 0.25),  # E43
                (7, 3, 0.25),  # E44
                (7, 3, -0.25),  # E45
                (7, 4, -0.25),  # E46
                (7, 4, 0.25),  # E47
                (7, 4, 0.25),  # E48
                (7, 4, -0.25),  # E49
                (7, 5, 0.25),  # E50
                (7, 5, -0.25),  # E51
                (7, 5, -0.25),  # E52
                (7, 5, 0.25),  # E53
                (8, 4, 1.0),  # E54
                (8, 4, -1.0),  # E55
                (8, 8, -1.0),  # E56
                (8, 8, 1.0),  # E57
                (9, 4, 0.25),  # E58
                (9, 4, 0.25),  # E59
                (9, 4, -0.25),  # E60
                (9, 4, -0.25),  # E61
                (9, 5, 0.25),  # E62
                (9, 5, 0.25),  # E63
                (9, 5, -0.25),  # E64
                (9, 5, -0.25),  # E65
                (9, 10, -0.25),  # E66
                (9, 10, -0.25),  # E67
                (9, 10, 0.25),  # E68
                (9, 10, 0.25),  # E69
                (9, 11, -0.25),  # E70
                (9, 11, -0.25),  # E71
                (9, 11, 0.25),  # E72
                (9, 11, 0.25),  # E73
                (10, 9, 1.0),  # E74
                (10, 9, -1.0),  # E75
                (10, 11, -1.0),  # E76
                (10, 11, 1.0),  # E77
                (11, 6, 0.25),  # E78
                (11, 6, -0.25),  # E79
                (11, 6, -0.25),  # E80
                (11, 6, 0.25),  # E81
                (11, 7, -0.25),  # E82
                (11, 7, 0.25),  # E83
                (11, 7, 0.25),  # E84
                (11, 7, -0.25),  # E85
                (11, 8, -0.25),  # E86
                (11, 8, 0.25),  # E87
                (11, 8, 0.25),  # E88
                (11, 8, -0.25),  # E89
                (11, 9, 0.25),  # E90
                (11, 9, -0.25),  # E91
                (11, 9, -0.25),  # E92
                (11, 9, 0.25),  # E93
                (12, 8, 1.0),  # E94
                (12, 8, -1.0),  # E95
                (12, 12, -1.0),  # E96
                (12, 12, 1.0),  # E97
                (13, 8, 0.25),  # E98
                (13, 8, 0.25),  # E99
                (13, 8, -0.25),  # E100
                (13, 8, -0.25),  # E101
                (13, 9, 0.25),  # E102
                (13, 9, 0.25),  # E103
                (13, 9, -0.25),  # E104
                (13, 9, -0.25),  # E105
                (13, 14, -0.25),  # E106
                (13, 14, -0.25),  # E107
                (13, 14, 0.25),  # E108
                (13, 14, 0.25),  # E109
                (13, 15, -0.25),  # E110
                (13, 15, -0.25),  # E111
                (13, 15, 0.25),  # E112
                (13, 15, 0.25),  # E113
                (14, 13, 1.0),  # E114
                (14, 13, -1.0),  # E115
                (14, 15, -1.0),  # E116
                (14, 15, 1.0),  # E117
                (15, 10, 0.25),  # E118
                (15, 10, -0.25),  # E119
                (15, 10, -0.25),  # E120
                (15, 10, 0.25),  # E121
                (15, 11, -0.25),  # E122
                (15, 11, 0.25),  # E123
                (15, 11, 0.25),  # E124
                (15, 11, -0.25),  # E125
                (15, 12, -0.25),  # E126
                (15, 12, 0.25),  # E127
                (15, 12, 0.25),  # E128
                (15, 12, -0.25),  # E129
                (15, 13, 0.25),  # E130
                (15, 13, -0.25),  # E131
                (15, 13, -0.25),  # E132
                (15, 13, 0.25),  # E133
                (16, 12, 1.0),  # E134
                (16, 12, -1.0),  # E135
                (16, 16, -1.0),  # E136
                (16, 16, 1.0),  # E137
                (17, 12, 0.25),  # E138
                (17, 12, 0.25),  # E139
                (17, 12, -0.25),  # E140
                (17, 12, -0.25),  # E141
                (17, 13, 0.25),  # E142
                (17, 13, 0.25),  # E143
                (17, 13, -0.25),  # E144
                (17, 13, -0.25),  # E145
                (17, 18, -0.25),  # E146
                (17, 18, -0.25),  # E147
                (17, 18, 0.25),  # E148
                (17, 18, 0.25),  # E149
                (17, 19, -0.25),  # E150
                (17, 19, -0.25),  # E151
                (17, 19, 0.25),  # E152
                (17, 19, 0.25),  # E153
                (18, 17, 1.0),  # E154
                (18, 17, -1.0),  # E155
                (18, 19, -1.0),  # E156
                (18, 19, 1.0),  # E157
                (19, 14, 0.25),  # E158
                (19, 14, -0.25),  # E159
                (19, 14, -0.25),  # E160
                (19, 14, 0.25),  # E161
                (19, 15, -0.25),  # E162
                (19, 15, 0.25),  # E163
                (19, 15, 0.25),  # E164
                (19, 15, -0.25),  # E165
                (19, 16, -0.25),  # E166
                (19, 16, 0.25),  # E167
                (19, 16, 0.25),  # E168
                (19, 16, -0.25),  # E169
                (19, 17, 0.25),  # E170
                (19, 17, -0.25),  # E171
                (19, 17, -0.25),  # E172
                (19, 17, 0.25),  # E173
                (20, 2, 1.0),  # E174
                (21, 2, 1.0),  # E175
                (21, 2, -1.0),  # E176
                (21, 6, -1.0),  # E177
                (21, 6, 1.0),  # E178
                (22, 6, 1.0),  # E179
                (22, 6, -1.0),  # E180
                (22, 10, -1.0),  # E181
                (22, 10, 1.0),  # E182
                (23, 10, 1.0),  # E183
                (23, 10, -1.0),  # E184
                (23, 14, -1.0),  # E185
                (23, 14, 1.0),  # E186
                (24, 14, 1.0),  # E187
                (24, 14, -1.0),  # E188
                (24, 18, -1.0),  # E189
                (24, 18, 1.0),  # E190
            ]
        )

        # GROUP USES mapping elements to constraints
        group_uses = jnp.array(
            [
                (0, 0),  # E1 -> C1
                (2, 1),  # E2 -> C3
                (3, 2),  # E3 -> C4
                (2, 3),  # E4 -> C3
                (3, 4),  # E5 -> C4
                (1, 5),  # E6 -> C2
                (3, 6),  # E7 -> C4
                (1, 7),  # E8 -> C2
                (3, 8),  # E9 -> C4
                (0, 9),  # E10 -> C1
                (1, 10),  # E11 -> C2
                (0, 11),  # E12 -> C1
                (1, 12),  # E13 -> C2
                (0, 13),  # E14 -> C1
                (4, 14),  # E15 -> C5
                (0, 15),  # E16 -> C1
                (4, 16),  # E17 -> C5
                (0, 17),  # E18 -> C1
                (1, 18),  # E19 -> C2
                (6, 19),  # E20 -> C7
                (7, 20),  # E21 -> C8
                (0, 21),  # E22 -> C1
                (1, 22),  # E23 -> C2
                (6, 23),  # E24 -> C7
                (7, 24),  # E25 -> C8
                (0, 25),  # E26 -> C1
                (1, 26),  # E27 -> C2
                (6, 27),  # E28 -> C7
                (7, 28),  # E29 -> C8
                (0, 29),  # E30 -> C1
                (1, 30),  # E31 -> C2
                (6, 31),  # E32 -> C7
                (7, 32),  # E33 -> C8
                (5, 33),  # E34 -> C6
                (7, 34),  # E35 -> C8
                (5, 35),  # E36 -> C6
                (7, 36),  # E37 -> C8
                (2, 37),  # E38 -> C3
                (3, 38),  # E39 -> C4
                (4, 39),  # E40 -> C5
                (5, 40),  # E41 -> C6
                (2, 41),  # E42 -> C3
                (3, 42),  # E43 -> C4
                (4, 43),  # E44 -> C5
                (5, 44),  # E45 -> C6
                (2, 45),  # E46 -> C3
                (3, 46),  # E47 -> C4
                (4, 47),  # E48 -> C5
                (5, 48),  # E49 -> C6
                (2, 49),  # E50 -> C3
                (3, 50),  # E51 -> C4
                (4, 51),  # E52 -> C5
                (5, 52),  # E53 -> C6
                (4, 53),  # E54 -> C5
                (8, 54),  # E55 -> C9
                (4, 55),  # E56 -> C5
                (8, 56),  # E57 -> C9
                (4, 57),  # E58 -> C5
                (5, 58),  # E59 -> C6
                (10, 59),  # E60 -> C11
                (11, 60),  # E61 -> C12
                (4, 61),  # E62 -> C5
                (5, 62),  # E63 -> C6
                (10, 63),  # E64 -> C11
                (11, 64),  # E65 -> C12
                (4, 65),  # E66 -> C5
                (5, 66),  # E67 -> C6
                (10, 67),  # E68 -> C11
                (11, 68),  # E69 -> C12
                (4, 69),  # E70 -> C5
                (5, 70),  # E71 -> C6
                (10, 71),  # E72 -> C11
                (11, 72),  # E73 -> C12
                (9, 73),  # E74 -> C10
                (11, 74),  # E75 -> C12
                (9, 75),  # E76 -> C10
                (11, 76),  # E77 -> C12
                (6, 77),  # E78 -> C7
                (7, 78),  # E79 -> C8
                (8, 79),  # E80 -> C9
                (9, 80),  # E81 -> C10
                (6, 81),  # E82 -> C7
                (7, 82),  # E83 -> C8
                (8, 83),  # E84 -> C9
                (9, 84),  # E85 -> C10
                (6, 85),  # E86 -> C7
                (7, 86),  # E87 -> C8
                (8, 87),  # E88 -> C9
                (9, 88),  # E89 -> C10
                (6, 89),  # E90 -> C7
                (7, 90),  # E91 -> C8
                (8, 91),  # E92 -> C9
                (9, 92),  # E93 -> C10
                (8, 93),  # E94 -> C9
                (12, 94),  # E95 -> C13
                (8, 95),  # E96 -> C9
                (12, 96),  # E97 -> C13
                (8, 97),  # E98 -> C9
                (9, 98),  # E99 -> C10
                (14, 99),  # E100 -> C15
                (15, 100),  # E101 -> C16
                (8, 101),  # E102 -> C9
                (9, 102),  # E103 -> C10
                (14, 103),  # E104 -> C15
                (15, 104),  # E105 -> C16
                (8, 105),  # E106 -> C9
                (9, 106),  # E107 -> C10
                (14, 107),  # E108 -> C15
                (15, 108),  # E109 -> C16
                (8, 109),  # E110 -> C9
                (9, 110),  # E111 -> C10
                (14, 111),  # E112 -> C15
                (15, 112),  # E113 -> C16
                (13, 113),  # E114 -> C14
                (15, 114),  # E115 -> C16
                (13, 115),  # E116 -> C14
                (15, 116),  # E117 -> C16
                (10, 117),  # E118 -> C11
                (11, 118),  # E119 -> C12
                (12, 119),  # E120 -> C13
                (13, 120),  # E121 -> C14
                (10, 121),  # E122 -> C11
                (11, 122),  # E123 -> C12
                (12, 123),  # E124 -> C13
                (13, 124),  # E125 -> C14
                (10, 125),  # E126 -> C11
                (11, 126),  # E127 -> C12
                (12, 127),  # E128 -> C13
                (13, 128),  # E129 -> C14
                (10, 129),  # E130 -> C11
                (11, 130),  # E131 -> C12
                (12, 131),  # E132 -> C13
                (13, 132),  # E133 -> C14
                (12, 133),  # E134 -> C13
                (16, 134),  # E135 -> C17
                (12, 135),  # E136 -> C13
                (16, 136),  # E137 -> C17
                (12, 137),  # E138 -> C13
                (13, 138),  # E139 -> C14
                (18, 139),  # E140 -> C19
                (19, 140),  # E141 -> C20
                (12, 141),  # E142 -> C13
                (13, 142),  # E143 -> C14
                (18, 143),  # E144 -> C19
                (19, 144),  # E145 -> C20
                (12, 145),  # E146 -> C13
                (13, 146),  # E147 -> C14
                (18, 147),  # E148 -> C19
                (19, 148),  # E149 -> C20
                (12, 149),  # E150 -> C13
                (13, 150),  # E151 -> C14
                (18, 151),  # E152 -> C19
                (19, 152),  # E153 -> C20
                (17, 153),  # E154 -> C18
                (19, 154),  # E155 -> C20
                (17, 155),  # E156 -> C18
                (19, 156),  # E157 -> C20
                (14, 157),  # E158 -> C15
                (15, 158),  # E159 -> C16
                (16, 159),  # E160 -> C17
                (17, 160),  # E161 -> C18
                (14, 161),  # E162 -> C15
                (15, 162),  # E163 -> C16
                (16, 163),  # E164 -> C17
                (17, 164),  # E165 -> C18
                (14, 165),  # E166 -> C15
                (15, 166),  # E167 -> C16
                (16, 167),  # E168 -> C17
                (17, 168),  # E169 -> C18
                (14, 169),  # E170 -> C15
                (15, 170),  # E171 -> C16
                (16, 171),  # E172 -> C17
                (17, 172),  # E173 -> C18
                (2, 173),  # E174 -> C3
                (2, 174),  # E175 -> C3
                (6, 175),  # E176 -> C7
                (2, 176),  # E177 -> C3
                (6, 177),  # E178 -> C7
                (6, 178),  # E179 -> C7
                (10, 179),  # E180 -> C11
                (6, 180),  # E181 -> C7
                (10, 181),  # E182 -> C11
                (10, 182),  # E183 -> C11
                (14, 183),  # E184 -> C15
                (10, 184),  # E185 -> C11
                (14, 185),  # E186 -> C15
                (14, 186),  # E187 -> C15
                (18, 187),  # E188 -> C19
                (14, 188),  # E189 -> C15
                (18, 189),  # E190 -> C19
            ]
        )

        return elements, group_uses
