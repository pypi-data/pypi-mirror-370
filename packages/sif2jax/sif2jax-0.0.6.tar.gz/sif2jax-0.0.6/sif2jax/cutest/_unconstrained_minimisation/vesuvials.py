import jax.numpy as jnp

from ..._problem import AbstractUnconstrainedMinimisation


class VESUVIALS(AbstractUnconstrainedMinimisation):
    """ISIS Data fitting problem VESUVIO, with transformed Gaussian.

    Fit: y = b1 + b2 * x + b3 * exp[ -0.5*( ( b4 - x ) * b5 )**2 ]
                         + b6 * exp[ -0.5*( ( b7 - x ) * b8 )**2 ] + e

    Source: fit to a sum of a linear background and two Gaussians using data
    EVS14188-90 from Mantid (http://www.mantidproject.org)

    SIF input: Nick Gould and Tyrone Rees, Oct 2015

    classification SUR2-MN-8-0
    """

    y0_iD: int = 0
    provided_y0s: frozenset = frozenset({0})

    n: int = 8  # Number of variables
    m: int = 1025  # Number of data points

    def objective(self, y, args=None):
        """Compute the least squares objective function."""
        b1, b2, b3, b4, b5, b6, b7, b8 = y

        # X data points (1025 values from 5e-05 to 0.000562)
        x_data = jnp.linspace(5e-05, 0.000562, 1025)

        # E values (standard deviations) for scaling the residuals
        e_data = jnp.array(
            [
                0.0303863,
                0.0310173,
                0.0312503,
                0.0298607,
                0.0294918,
                0.0290474,
                0.0288393,
                0.028682,
                0.0289894,
                0.0286401,
                0.0282799,
                0.0279912,
                0.0276467,
                0.0275126,
                0.027512,
                0.0273454,
                0.0287512,
                0.0353003,
                0.029876,
                0.0278731,
                0.0271813,
                0.0270541,
                0.0269372,
                0.0269063,
                0.0265916,
                0.0267313,
                0.027029,
                0.0269977,
                0.027104,
                0.0273649,
                0.0265579,
                0.026739,
                0.0263734,
                0.0262929,
                0.0262327,
                0.0261264,
                0.0260242,
                0.0260753,
                0.0262287,
                0.0261244,
                0.0259952,
                0.025799,
                0.0256358,
                0.0254271,
                0.0254153,
                0.0253214,
                0.02523,
                0.0250936,
                0.0252778,
                0.0253697,
                0.025391,
                0.0255053,
                0.0246517,
                0.0245816,
                0.0244456,
                0.0244431,
                0.0244664,
                0.0244203,
                0.0245218,
                0.0242384,
                0.0242677,
                0.0238524,
                0.0240281,
                0.0239043,
                0.0238331,
                0.02389,
                0.0240785,
                0.0235999,
                0.0232825,
                0.0231743,
                0.0232343,
                0.023685,
                0.0240754,
                0.0236267,
                0.0240051,
                0.0241237,
                0.0237333,
                0.0235248,
                0.0232958,
                0.0234157,
                0.023614,
                0.0225999,
                0.0225325,
                0.0223651,
                0.0224334,
                0.0225764,
                0.0229444,
                0.0225619,
                0.0223367,
                0.0219986,
                0.0221627,
                0.0220487,
                0.0219399,
                0.0221334,
                0.0222253,
                0.0221159,
                0.0218683,
                0.0220132,
                0.0223844,
                0.0228211,
                0.0224549,
                0.0224042,
                0.0230552,
                0.022661,
                0.0222781,
                0.0219592,
                0.0220139,
                0.0222849,
                0.0223376,
                0.0221955,
                0.0221885,
                0.0222883,
                0.0220605,
                0.0222848,
                0.0220391,
                0.0217931,
                0.0216811,
                0.0219951,
                0.0216927,
                0.02164,
                0.0216873,
                0.0217354,
                0.0217533,
                0.0216653,
                0.0217771,
                0.0217556,
                0.0218971,
                0.0220516,
                0.0221151,
                0.0219298,
                0.0216515,
                0.0216938,
                0.0218521,
                0.0219291,
                0.0219071,
                0.0218794,
                0.0219159,
                0.0218404,
                0.0220426,
                0.0220797,
                0.0221262,
                0.0220828,
                0.0220859,
                0.0220513,
                0.0222773,
                0.0220437,
                0.0218921,
                0.0219589,
                0.0218986,
                0.0220172,
                0.0223627,
                0.0220521,
                0.0219879,
                0.0219801,
                0.0219392,
                0.0220339,
                0.0220891,
                0.0220812,
                0.0222481,
                0.022288,
                0.0223236,
                0.0229006,
                0.0226812,
                0.0228139,
                0.0228398,
                0.0225395,
                0.022602,
                0.0227078,
                0.0227334,
                0.0227149,
                0.0227442,
                0.0226041,
                0.0229047,
                0.022653,
                0.0227517,
                0.0226858,
                0.0227516,
                0.0229561,
                0.022666,
                0.0228435,
                0.0226336,
                0.0225699,
                0.0223146,
                0.0226629,
                0.02272,
                0.0226738,
                0.0227211,
                0.0226848,
                0.0226722,
                0.0226259,
                0.0225356,
                0.0224534,
                0.0223231,
                0.0223624,
                0.0227025,
                0.0225579,
                0.0226466,
                0.0223448,
                0.0224167,
                0.0226286,
                0.0225081,
                0.0224729,
                0.0226981,
                0.0226149,
                0.0226197,
                0.0227154,
                0.0228889,
                0.0228061,
                0.0228028,
                0.022942,
                0.0231988,
                0.0234071,
                0.0233274,
                0.0231488,
                0.0233289,
                0.0235542,
                0.0235587,
                0.0232722,
                0.0229292,
                0.022869,
                0.0226786,
                0.0227817,
                0.0227863,
                0.0226417,
                0.0226769,
                0.0227635,
                0.0229105,
                0.0228949,
                0.0227636,
                0.0229036,
                0.0226106,
                0.022529,
                0.0224815,
                0.0226997,
                0.0225268,
                0.0228739,
                0.0226674,
                0.0226078,
                0.0227839,
                0.0228501,
                0.0226804,
                0.0227426,
                0.0226242,
                0.0225592,
                0.0224852,
                0.0225667,
                0.0224658,
                0.0226108,
                0.0225491,
                0.0224435,
                0.0223893,
                0.0223335,
                0.0226691,
                0.0226118,
                0.0223586,
                0.0226007,
                0.022505,
                0.022353,
                0.0225471,
                0.0224152,
                0.02241,
                0.0226703,
                0.0226062,
                0.0226332,
                0.0223997,
                0.0223607,
                0.0225317,
                0.0222499,
                0.0227951,
                0.0224601,
                0.022252,
                0.0224112,
                0.0223462,
                0.0224366,
                0.0223177,
                0.0223271,
                0.0221006,
                0.0223434,
                0.0223186,
                0.0223184,
                0.0223034,
                0.0222328,
                0.0222431,
                0.0221708,
                0.021902,
                0.022268,
                0.0221923,
                0.022179,
                0.0221502,
                0.0220072,
                0.0223254,
                0.0217562,
                0.0217663,
                0.0219028,
                0.0219816,
                0.0219796,
                0.0220708,
                0.0220652,
                0.0220405,
                0.0216072,
                0.0218739,
                0.0220181,
                0.0218783,
                0.0220251,
                0.0215433,
                0.0218473,
                0.0220273,
                0.0216442,
                0.0217995,
                0.0217411,
                0.0216588,
                0.0216187,
                0.0218532,
                0.0217112,
                0.0216586,
                0.0214616,
                0.0215932,
                0.0216968,
                0.0215273,
                0.0215085,
                0.0216621,
                0.0216786,
                0.0213897,
                0.021849,
                0.0219674,
                0.0217146,
                0.0216747,
                0.0215591,
                0.0214944,
                0.0215961,
                0.0214783,
                0.0215369,
                0.0213008,
                0.0213431,
                0.0214437,
                0.0213432,
                0.0215212,
                0.021498,
                0.0214255,
                0.0213535,
                0.0214165,
                0.0211938,
                0.0213378,
                0.0213217,
                0.0213086,
                0.0214944,
                0.0214181,
                0.0212323,
                0.0213615,
                0.0210046,
                0.0214149,
                0.0211172,
                0.0214058,
                0.0210791,
                0.0211763,
                0.0212223,
                0.0211401,
                0.0212292,
                0.021179,
                0.0213636,
                0.021237,
                0.0210363,
                0.0211477,
                0.0213157,
                0.021113,
                0.021229,
                0.0211629,
                0.0212631,
                0.0213003,
                0.0210129,
                0.0213328,
                0.0212344,
                0.021327,
                0.021193,
                0.0211973,
                0.021149,
                0.0211451,
                0.0212886,
                0.0211868,
                0.0211305,
                0.0213446,
                0.021141,
                0.0210851,
                0.020976,
                0.0212139,
                0.0213498,
                0.0211855,
                0.0212335,
                0.0211152,
                0.0213534,
                0.0210766,
                0.0211484,
                0.0211813,
                0.0211634,
                0.0211805,
                0.0210859,
                0.0211438,
                0.0210356,
                0.0211095,
                0.0211358,
                0.0213169,
                0.0214637,
                0.0210764,
                0.0212388,
                0.0211657,
                0.0212966,
                0.0210071,
                0.0210056,
                0.0210315,
                0.0211877,
                0.0212215,
                0.021289,
                0.0211048,
                0.0210632,
                0.0210081,
                0.0211044,
                0.0212401,
                0.0213122,
                0.0211057,
                0.0210821,
                0.0213233,
                0.0212137,
                0.0211275,
                0.0209282,
                0.0211741,
                0.0211838,
                0.021165,
                0.0214279,
                0.0214591,
                0.0211882,
                0.021487,
                0.0218396,
                0.0218586,
                0.0220089,
                0.0217116,
                0.0217691,
                0.0214077,
                0.0214644,
                0.0211121,
                0.0212324,
                0.0212791,
                0.0211956,
                0.0212089,
                0.0211983,
                0.021385,
                0.0211943,
                0.0212774,
                0.0211226,
                0.0211858,
                0.0212222,
                0.0215697,
                0.0212543,
                0.0210973,
                0.0213546,
                0.0213044,
                0.021301,
                0.021615,
                0.0214847,
                0.0213423,
                0.0214682,
                0.0216402,
                0.022095,
                0.0221607,
                0.0227644,
                0.0233404,
                0.0241217,
                0.025169,
                0.0262444,
                0.0270961,
                0.0273923,
                0.0272695,
                0.0267136,
                0.0257066,
                0.0245744,
                0.0236961,
                0.0228346,
                0.0225269,
                0.0220647,
                0.022038,
                0.0213974,
                0.0214524,
                0.0215359,
                0.0214084,
                0.0214522,
                0.0211135,
                0.0215047,
                0.0211227,
                0.0212465,
                0.0210207,
                0.0210476,
                0.020998,
                0.0212308,
                0.0212757,
                0.0209498,
                0.021222,
                0.0210311,
                0.020943,
                0.0212433,
                0.0211383,
                0.0209559,
                0.0210807,
                0.0209347,
                0.0208439,
                0.021029,
                0.0212731,
                0.020956,
                0.0211771,
                0.0210321,
                0.020834,
                0.0211801,
                0.0212231,
                0.0209525,
                0.0211204,
                0.0211655,
                0.0212686,
                0.0212606,
                0.0216722,
                0.0220592,
                0.0221628,
                0.0222223,
                0.022363,
                0.0223139,
                0.0220128,
                0.021807,
                0.0217169,
                0.0215071,
                0.0214514,
                0.0209814,
                0.0209489,
                0.0210912,
                0.0211934,
                0.0210476,
                0.0209957,
                0.0208684,
                0.0208422,
                0.0209768,
                0.0210485,
                0.0208604,
                0.0209867,
                0.02098,
                0.0208099,
                0.0210233,
                0.0210312,
                0.0211919,
                0.0209782,
                0.0210408,
                0.0210413,
                0.0210565,
                0.0209036,
                0.0211311,
                0.0213413,
                0.0213932,
                0.0214721,
                0.0219276,
                0.0217896,
                0.0216696,
                0.0218711,
                0.0214771,
                0.0216075,
                0.0212785,
                0.0214205,
                0.0214002,
                0.0213842,
                0.0214108,
                0.0215843,
                0.0215299,
                0.0216584,
                0.0218573,
                0.0215279,
                0.0215714,
                0.0213996,
                0.0212198,
                0.0211686,
                0.020955,
                0.0213081,
                0.0210041,
                0.0211216,
                0.021042,
                0.0209126,
                0.0209068,
                0.0210703,
                0.0209729,
                0.0210381,
                0.0209981,
                0.0211991,
                0.0208593,
                0.0209862,
                0.0209814,
                0.0211268,
                0.0209554,
                0.0210241,
                0.021004,
                0.0211055,
                0.0209628,
                0.0210525,
                0.0211523,
                0.0210994,
                0.0212094,
                0.0212252,
                0.020982,
                0.0210274,
                0.0209664,
                0.0210446,
                0.0211214,
                0.0212344,
                0.0211146,
                0.0210967,
                0.0211869,
                0.0213472,
                0.0213009,
                0.0211634,
                0.0213341,
                0.0211736,
                0.0214362,
                0.0212534,
                0.0212631,
                0.0212325,
                0.0215288,
                0.0215169,
                0.0214865,
                0.0214465,
                0.021534,
                0.0216133,
                0.0216841,
                0.0218225,
                0.0216998,
                0.0217147,
                0.021654,
                0.0217053,
                0.0216925,
                0.0219249,
                0.0218479,
                0.0218273,
                0.0220774,
                0.0219215,
                0.0218858,
                0.0217497,
                0.022037,
                0.0219202,
                0.0219893,
                0.0221223,
                0.0219283,
                0.0219396,
                0.0219358,
                0.0218527,
                0.021873,
                0.0218838,
                0.0220156,
                0.0217095,
                0.0219863,
                0.0218774,
                0.0218714,
                0.0216054,
                0.0217294,
                0.0218303,
                0.0217458,
                0.0217488,
                0.0216873,
                0.0213845,
                0.0215511,
                0.021484,
                0.0213567,
                0.0214179,
                0.0212396,
                0.0213837,
                0.021056,
                0.0214076,
                0.0211789,
                0.0211828,
                0.0210065,
                0.0209891,
                0.020957,
                0.0209679,
                0.021198,
                0.0207295,
                0.0209628,
                0.0212266,
                0.0209239,
                0.0205883,
                0.0209524,
                0.0209163,
                0.0210208,
                0.0207073,
                0.020857,
                0.020748,
                0.0208003,
                0.0208527,
                0.0211215,
                0.0209957,
                0.0207219,
                0.0206173,
                0.0208913,
                0.0208563,
                0.0205543,
                0.0209109,
                0.0207418,
                0.0206116,
                0.0207711,
                0.0206968,
                0.0206287,
                0.0206195,
                0.0206594,
                0.0207429,
                0.0207369,
                0.0205162,
                0.0206509,
                0.0206985,
                0.020725,
                0.0206187,
                0.0206585,
                0.0205814,
                0.0207503,
                0.0207309,
                0.0204422,
                0.0206707,
                0.0207187,
                0.020539,
                0.0207107,
                0.0205421,
                0.0206204,
                0.0205832,
                0.0206777,
                0.0205216,
                0.0205685,
                0.0209049,
                0.0206475,
                0.0205515,
                0.0205106,
                0.0205532,
                0.0207279,
                0.0203941,
                0.0206868,
                0.0205155,
                0.0206046,
                0.0204954,
                0.0204535,
                0.0206039,
                0.0206106,
                0.0205949,
                0.0207722,
                0.0205163,
                0.0205381,
                0.0204813,
                0.0205989,
                0.0205588,
                0.0203587,
                0.0207597,
                0.0205099,
                0.0205309,
                0.0206603,
                0.0206317,
                0.020661,
                0.0204623,
                0.0205178,
                0.0205742,
                0.0206665,
                0.0205687,
                0.0207994,
                0.0206789,
                0.0206238,
                0.0206342,
                0.0206731,
                0.0208162,
                0.0204129,
                0.0205717,
                0.0207482,
                0.0208113,
                0.020437,
                0.0205712,
                0.0207071,
                0.0206036,
                0.0209313,
                0.0207464,
                0.0205022,
                0.0205631,
                0.0207559,
                0.02066,
                0.0205503,
                0.0206399,
                0.0206111,
                0.0204793,
                0.0203593,
                0.0206078,
                0.0208315,
                0.0208479,
                0.0204857,
                0.0205573,
                0.0206929,
                0.0204852,
                0.0208184,
                0.0206909,
                0.0205616,
                0.0207227,
                0.0204535,
                0.0206556,
                0.0206486,
                0.0205525,
                0.0208253,
                0.0206128,
                0.0207669,
                0.0207091,
                0.0205905,
                0.0204235,
                0.02067,
                0.0204991,
                0.0205143,
                0.020716,
                0.0206399,
                0.0208374,
                0.0205899,
                0.0207109,
                0.0207245,
                0.0206685,
                0.0202766,
                0.020668,
                0.0206862,
                0.0204278,
                0.0206722,
                0.0206248,
                0.0206103,
                0.0205501,
                0.0207201,
                0.0204629,
                0.0208499,
                0.0206389,
                0.0207892,
                0.0208855,
                0.0206,
                0.0207763,
                0.0208862,
                0.0208067,
                0.0206208,
                0.020809,
                0.0205835,
                0.0206604,
                0.0206754,
                0.0209632,
                0.0207383,
                0.0204799,
                0.0208068,
                0.0208348,
                0.0205876,
                0.020677,
                0.0205851,
                0.0206458,
                0.0206494,
                0.0208135,
                0.0207143,
                0.0206582,
                0.0206987,
                0.0207025,
                0.0207855,
                0.0206611,
                0.0207374,
                0.0204598,
                0.020644,
                0.0207589,
                0.0209362,
                0.0209235,
                0.0207275,
                0.0205479,
                0.020625,
                0.0206792,
                0.0207889,
                0.0208377,
                0.0206483,
                0.0207555,
                0.0207046,
                0.0205351,
                0.0207751,
                0.0209721,
                0.0209302,
                0.0208686,
                0.020744,
                0.0206337,
                0.0207625,
                0.0206571,
                0.0206982,
                0.020635,
                0.0208164,
                0.0205807,
                0.0207417,
                0.0209521,
                0.020892,
                0.020784,
                0.0206369,
                0.0207142,
                0.0205603,
                0.0206102,
                0.0207106,
                0.0207332,
                0.0206387,
                0.020635,
                0.0209507,
                0.0206959,
                0.0209062,
                0.020704,
                0.0208418,
                0.0209621,
                0.0210325,
                0.0210919,
                0.0209215,
                0.0207707,
                0.020846,
                0.0210156,
                0.0209165,
                0.021171,
                0.021219,
                0.0213119,
                0.0211305,
                0.0213313,
                0.0213589,
                0.0216083,
                0.021474,
                0.0215713,
                0.0216227,
                0.0218586,
                0.022044,
                0.0222194,
                0.0222798,
                0.0222418,
                0.0224813,
                0.0226609,
                0.02268,
                0.0227838,
                0.0231154,
                0.023285,
                0.0232686,
                0.0232394,
                0.0233826,
                0.0233708,
                0.0231859,
                0.0233292,
                0.0231839,
                0.0230971,
                0.0229035,
                0.0226791,
                0.0226032,
                0.022451,
                0.0226678,
                0.0222245,
                0.0221008,
                0.0221597,
                0.0217302,
                0.0215593,
                0.021541,
                0.0215133,
                0.0213654,
                0.0214786,
                0.021293,
                0.0212155,
                0.0211373,
                0.021261,
                0.0211863,
                0.0211028,
                0.0209647,
                0.0210452,
                0.0209352,
                0.0208541,
                0.0207654,
                0.0209138,
                0.0206638,
                0.0206425,
                0.0206891,
                0.0205532,
                0.0208529,
                0.020892,
                0.0208303,
                0.0208046,
                0.020648,
                0.0205467,
                0.0205544,
                0.0208423,
                0.0206684,
                0.0206425,
                0.0207099,
                0.0205558,
                0.0206002,
                0.0206686,
                0.0206287,
                0.0208365,
                0.0204599,
                0.0205956,
                0.0204728,
                0.0204565,
                0.0205903,
                0.0207296,
                0.0204186,
                0.0206038,
                0.020226,
                0.0205416,
                0.0205745,
                0.0204792,
                0.0203151,
                0.0207688,
                0.0205341,
                0.0203993,
                0.0205619,
                0.0203738,
                0.0205307,
                0.0204406,
                0.0207971,
                0.0205546,
                0.0206311,
                0.0203205,
                0.0202611,
                0.0205269,
                0.0205284,
                0.0205824,
                0.0204419,
                0.0205802,
                0.0203601,
                0.0203543,
                0.0203678,
                0.0206436,
                0.0202336,
                0.0204539,
                0.0204855,
                0.0204277,
                0.0204079,
                0.0204641,
                0.0202388,
                0.0203934,
                0.0203959,
                0.0204863,
            ]
        )

        # Y data points (1025 observed values - same as VESUVIA)
        y_data = jnp.array(
            [
                -0.043818,
                -0.0374639,
                0.000431594,
                -0.0104384,
                -0.0181576,
                -0.0108962,
                0.0491521,
                -0.00611904,
                0.0364192,
                -0.0244793,
                0.0268059,
                -0.0285219,
                -0.016472,
                -0.042737,
                0.00969073,
                0.00661254,
                -0.0326679,
                -0.0277833,
                0.0230731,
                -0.0021438,
                0.0335214,
                -0.0111762,
                -0.00842102,
                -0.0131027,
                0.0045568,
                0.0133449,
                -0.045149,
                0.0408543,
                0.0185121,
                0.0441349,
                0.00696307,
                -0.0742796,
                -0.0504155,
                0.00943794,
                -0.0164604,
                -0.00097137,
                0.0308067,
                0.0158623,
                -0.00204966,
                -0.00333032,
                -0.0291396,
                -0.0260522,
                0.00509382,
                -0.0144775,
                0.0202525,
                0.00950817,
                0.0261544,
                -0.0131126,
                0.0407359,
                -0.00826466,
                0.0240619,
                -0.00182438,
                0.00987082,
                -0.0330236,
                0.0384621,
                0.0226427,
                -0.00596073,
                -0.0590399,
                0.0204211,
                -0.0451219,
                0.00585252,
                0.0120189,
                -0.0448687,
                0.00345542,
                0.0210157,
                0.00819559,
                -0.0345383,
                -0.0122425,
                0.00324275,
                -0.0339446,
                0.0481686,
                -0.0147045,
                0.0193092,
                -0.0264435,
                0.0120728,
                0.00437327,
                0.0046033,
                0.0372026,
                0.0216476,
                0.0536252,
                0.0699235,
                -0.00494973,
                0.00551705,
                0.0208186,
                0.0223953,
                -0.0056318,
                0.00788353,
                0.0298081,
                0.015891,
                0.00988867,
                -0.0290219,
                0.0197523,
                0.0151485,
                0.0180058,
                0.0157787,
                -0.00535445,
                0.0204222,
                -0.0208278,
                0.0302433,
                0.0311677,
                -0.00266134,
                0.0321104,
                0.0415269,
                0.0226116,
                0.0128861,
                0.0120574,
                0.00939962,
                -0.0154602,
                -0.0192974,
                -0.0300028,
                -0.017951,
                0.00956859,
                0.0525651,
                0.00508547,
                0.0112612,
                0.0379798,
                0.0425881,
                0.00635024,
                0.0232108,
                0.0211423,
                0.0465961,
                -0.00186809,
                -0.00141523,
                -0.01053,
                0.0670444,
                0.00236076,
                0.028184,
                0.0327376,
                0.0475456,
                0.0538893,
                0.0232553,
                0.00526164,
                0.0532656,
                -0.0145954,
                0.0510802,
                0.026314,
                0.0331227,
                0.0166741,
                0.0152719,
                0.0284559,
                0.0916947,
                0.0194785,
                0.0497031,
                0.0785525,
                0.0457128,
                0.0580151,
                0.0463735,
                0.0354371,
                0.044241,
                0.0162445,
                0.0586063,
                0.0251801,
                0.0790944,
                0.0618635,
                0.0671038,
                0.0327571,
                0.0794554,
                0.0856043,
                0.0525939,
                0.0544387,
                0.0650262,
                0.068626,
                0.0738347,
                0.0895067,
                0.0658615,
                0.0914702,
                0.0609357,
                0.081834,
                0.063857,
                0.125279,
                0.0683318,
                0.0857297,
                0.0804291,
                0.0731582,
                0.045416,
                0.039823,
                0.127126,
                0.0751748,
                0.061808,
                0.0842774,
                0.0885304,
                0.100646,
                0.0900689,
                0.112349,
                0.0626914,
                0.115407,
                0.0844166,
                0.0960295,
                0.0802212,
                0.0731888,
                0.116035,
                0.0807037,
                0.092657,
                0.143151,
                0.0674344,
                0.114121,
                0.136928,
                0.105858,
                0.151119,
                0.109554,
                0.139918,
                0.126496,
                0.119158,
                0.131296,
                0.134124,
                0.0971755,
                0.161449,
                0.138164,
                0.131791,
                0.127854,
                0.098511,
                0.138888,
                0.113476,
                0.110613,
                0.0879691,
                0.140605,
                0.104704,
                0.0958282,
                0.118659,
                0.106919,
                0.117291,
                0.136775,
                0.14102,
                0.156534,
                0.145159,
                0.133253,
                0.125528,
                0.162623,
                0.151437,
                0.160015,
                0.12091,
                0.101873,
                0.149158,
                0.133798,
                0.176973,
                0.126043,
                0.138557,
                0.1672,
                0.0994593,
                0.116623,
                0.167826,
                0.114384,
                0.120186,
                0.154502,
                0.128844,
                0.0919119,
                0.1624,
                0.138149,
                0.136329,
                0.100788,
                0.132021,
                0.146725,
                0.110689,
                0.142163,
                0.124735,
                0.101792,
                0.0886751,
                0.114114,
                0.110118,
                0.136007,
                0.0795715,
                0.112341,
                0.111941,
                0.114744,
                0.104852,
                0.0907259,
                0.118165,
                0.104074,
                0.0977936,
                0.072903,
                0.109739,
                0.120898,
                0.102786,
                0.0922942,
                0.140367,
                0.090055,
                0.0973907,
                0.107985,
                0.0851051,
                0.0884115,
                0.108974,
                0.096536,
                0.0913291,
                0.0824352,
                0.111778,
                0.0745343,
                0.121377,
                0.0921086,
                0.0713587,
                0.0946596,
                0.116034,
                0.0736795,
                0.0760301,
                0.0584058,
                0.0578472,
                0.0507647,
                0.0898665,
                0.117975,
                0.0492809,
                0.0910802,
                0.0721345,
                0.0833121,
                0.0633919,
                0.0726774,
                0.0793411,
                0.0298914,
                0.0181227,
                0.0563252,
                0.0573376,
                0.0488994,
                0.0494608,
                0.0717029,
                0.0773525,
                0.0744368,
                0.0522949,
                0.0385736,
                0.0880253,
                0.0387927,
                0.0266954,
                0.0767808,
                0.0189931,
                0.0617196,
                0.0230641,
                0.0225687,
                0.0824231,
                0.062153,
                0.0834503,
                0.055,
                0.0135058,
                0.0627533,
                0.0411534,
                0.0184196,
                0.0451215,
                0.0384641,
                0.053943,
                0.0165014,
                0.0408713,
                0.058608,
                0.0544348,
                0.018852,
                0.0117,
                0.0157153,
                0.019341,
                0.0250259,
                0.00591113,
                -0.00609515,
                0.00815597,
                0.029844,
                0.0164819,
                0.0385856,
                -0.00246766,
                0.0372864,
                -0.00269409,
                -0.00636251,
                0.020693,
                0.0222975,
                0.00986804,
                0.0364596,
                0.0393466,
                0.0436376,
                0.0173226,
                -0.0202508,
                0.0743308,
                0.0172391,
                0.0207598,
                -0.020454,
                0.00488474,
                0.0406745,
                0.0321333,
                0.0123634,
                0.0552421,
                0.016853,
                -0.0160711,
                0.00650595,
                -0.0175865,
                0.0549646,
                0.0341869,
                0.0108916,
                0.00202561,
                -0.0449102,
                0.0349201,
                0.0167157,
                0.00236894,
                0.0291692,
                0.00979011,
                0.0349145,
                0.0405205,
                0.0109501,
                0.00682423,
                0.000195658,
                -0.00872146,
                0.0242649,
                0.0249386,
                -0.0036175,
                -0.00245472,
                0.0101613,
                -0.0262679,
                0.0106865,
                0.0143873,
                -0.00429679,
                -0.00165476,
                0.0269997,
                0.0146583,
                0.0296008,
                -0.0180255,
                -0.0115518,
                0.000797839,
                0.0234705,
                0.0128162,
                -0.0121448,
                -0.00698516,
                0.00475114,
                0.00541832,
                0.0132552,
                0.0258294,
                -0.0496059,
                0.010707,
                -0.0302248,
                -0.00922442,
                0.0281132,
                -8.5067e-06,
                0.0121518,
                0.00137972,
                0.00678428,
                -0.00504567,
                0.00627951,
                -0.00716149,
                -0.0234996,
                -0.00298732,
                0.000371008,
                0.027447,
                0.00935411,
                0.0315321,
                -0.0120852,
                0.00807623,
                0.0526476,
                0.0081671,
                -0.0445566,
                -0.0252898,
                0.00835358,
                -0.00373996,
                -0.0116808,
                0.0060169,
                0.0270461,
                0.0155121,
                0.00721307,
                -0.0183799,
                -0.0453742,
                -0.00293263,
                0.0232422,
                -0.00948229,
                -0.00631143,
                0.0179425,
                0.0209761,
                -0.0713078,
                0.00166836,
                -0.0107119,
                0.0427997,
                -0.030493,
                0.0173125,
                -0.0213661,
                0.00553178,
                -0.016031,
                0.0191882,
                -0.00343691,
                0.0192536,
                0.00781084,
                -0.0167119,
                0.0334007,
                0.0457505,
                -0.00721731,
                0.0336781,
                0.0220064,
                -0.00538441,
                -0.00290971,
                -0.0293038,
                0.0149695,
                0.00650988,
                0.00819231,
                -0.0147292,
                0.0201632,
                -0.00661203,
                0.0360328,
                0.023942,
                -0.00687104,
                0.0153841,
                -0.00617226,
                -0.00677542,
                0.0147168,
                0.00996546,
                -0.00320737,
                0.0118976,
                0.0276725,
                -0.0175624,
                -0.0145427,
                -0.0011166,
                -0.0159023,
                0.0222753,
                -0.00288254,
                -0.00883099,
                -0.0108512,
                0.0294486,
                -0.0106035,
                0.0496593,
                0.00712957,
                -0.0111927,
                -0.011189,
                -0.0162317,
                0.0373467,
                0.00274109,
                0.0286728,
                0.0216368,
                -0.0113653,
                0.0053543,
                -0.00467352,
                0.0378432,
                -0.018803,
                0.0136006,
                0.0297811,
                0.0228667,
                0.0142086,
                0.00103852,
                0.00585841,
                0.000415705,
                -0.0138921,
                0.017743,
                -0.00486836,
                0.0272743,
                -0.0244101,
                0.0111004,
                0.0209111,
                0.00949311,
                -0.0074557,
                0.0233776,
                0.0149032,
                -0.00412979,
                -0.0037326,
                0.00236796,
                0.00814009,
                0.0279842,
                -0.00277497,
                -0.0235433,
                -0.022607,
                0.0244551,
                -0.00531205,
                -0.00750302,
                0.00406808,
                0.01586,
                -0.00428942,
                -0.0127935,
                -0.0149055,
                -0.0293664,
                0.0180168,
                0.00807722,
                0.0316073,
                -0.0178555,
                -0.00437734,
                -0.0193014,
                0.0462101,
                -0.0143664,
                -0.0487604,
                0.042654,
                0.0483388,
                0.0197354,
                0.00514375,
                0.0658946,
                0.0163994,
                -0.00790463,
                -0.0233706,
                0.0247587,
                0.0320276,
                -0.000607085,
                -0.0222794,
                0.0244681,
                0.012524,
                0.0260698,
                0.0108322,
                -0.00632354,
                -0.0189405,
                -0.0118498,
                0.00687154,
                -0.0249075,
                0.0135178,
                0.0163936,
                -0.00530828,
                -0.0207742,
                -0.0053204,
                0.00720096,
                0.0117713,
                0.0178552,
                -0.036769,
                -0.0126599,
                -0.005918,
                0.0263491,
                0.0151557,
                0.00584057,
                0.0264419,
                0.0180603,
                0.0175713,
                0.0187721,
                -0.00559971,
                -0.0270261,
                -0.0259273,
                -0.00640704,
                0.0373987,
                -0.0238755,
                0.00731606,
                -0.000808467,
                -0.00475702,
                0.00261306,
                0.0164558,
                -0.0243441,
                0.0221129,
                0.0300992,
                -0.0122144,
                -0.0204902,
                0.0055195,
                0.00355038,
                0.0472522,
                0.0154036,
                0.0319775,
                0.0427468,
                0.0157395,
                -0.00322947,
                -0.00243507,
                0.0331217,
                0.0201169,
                0.0251419,
                0.00642998,
                0.0456459,
                0.0706617,
                0.0601188,
                0.0419572,
                0.0648266,
                0.0652339,
                0.0456719,
                0.0753397,
                0.0835274,
                0.105146,
                0.0372931,
                0.0942968,
                0.0975799,
                0.080092,
                0.0793876,
                0.104039,
                0.106851,
                0.137539,
                0.141646,
                0.101833,
                0.125147,
                0.137782,
                0.111339,
                0.0979306,
                0.111258,
                0.115163,
                0.07558,
                0.0684921,
                0.106816,
                0.0440877,
                0.0181681,
                0.0742093,
                0.0500213,
                0.0310634,
                0.0182645,
                0.0362954,
                0.0224729,
                0.0487861,
                0.0412359,
                0.0424126,
                0.00882773,
                -0.00910196,
                0.0133665,
                0.0296499,
                -0.0289228,
                -0.00599789,
                0.00722044,
                -0.0036843,
                -0.00879759,
                -0.0136455,
                -0.0166205,
                -0.0144574,
                -0.00582893,
                -0.0352583,
                0.0132347,
                -0.0409682,
                0.0203784,
                -0.0028195,
                -0.00735174,
                -0.00887274,
                0.00794329,
                -0.00233979,
                0.00068274,
                0.0044977,
                -0.0325032,
                -0.0139795,
                0.011465,
                -0.0578308,
                -0.0445345,
                -0.0189526,
                -0.0309265,
                0.00615967,
                0.0146202,
                0.0150062,
                0.00533007,
                -0.0109738,
                -0.0193777,
                0.0152883,
                0.0223457,
                0.017496,
                -0.0118285,
                0.0491794,
                -0.0152295,
                0.0133655,
                -0.00428582,
                0.0275972,
                0.0155036,
                -0.00698254,
                0.0136226,
                -0.0322545,
                -0.0271394,
                0.0213109,
                0.00397427,
                0.010511,
                -0.020946,
                -0.00452699,
                -0.0281119,
                -0.01101,
                0.0315402,
                -0.015971,
                -0.00198156,
                0.000250178,
                -0.0307502,
                0.0204358,
                0.0255398,
                -0.0241773,
                -0.00949277,
                0.0158581,
                -0.00209666,
                -0.0115269,
                -0.00131896,
                -0.0123909,
                -0.0124131,
                0.0230685,
                0.0106678,
                0.001735,
                0.0380713,
                -0.0140584,
                0.0017851,
                -0.00650184,
                0.00233915,
                -0.0351804,
                -0.00805248,
                -0.0180034,
                0.00602787,
                -0.0252027,
                0.00918121,
                -0.00465142,
                -0.00559791,
                0.0261718,
                0.00214055,
                0.00826992,
                0.0323178,
                0.0236681,
                0.0254998,
                -0.0289787,
                -0.00365564,
                -0.00348488,
                -0.00805903,
                -0.0209488,
                0.0282681,
                3.58623e-05,
                -0.0199047,
                -0.0369519,
                0.0152539,
                0.0192063,
                -0.0175968,
                -0.0340288,
                -0.0121895,
                0.0240866,
                0.00947444,
                -0.0284117,
                -0.0115223,
                -0.0212225,
                0.0153867,
                0.00922951,
                -0.00196862,
                0.00386195,
                0.0190727,
                -0.0154291,
                0.0498791,
                0.00821147,
                -0.0197582,
                0.0157356,
                -0.00949277,
                -0.00804691,
                -0.0245707,
                -0.0247081,
                -0.0129457,
                0.00451341,
                0.0178152,
                -0.00243442,
                -0.00514603,
                -0.0099345,
                -0.00168554,
                0.00085154,
                -0.0232521,
                -0.00409459,
                0.0432152,
                -0.0136668,
                0.00241151,
                -0.00881249,
                -0.0312615,
                -0.0196319,
                -0.00577064,
                -0.0321477,
                0.0384444,
                -0.0321376,
                -0.0142041,
                -0.0134469,
                0.00168212,
                0.0102456,
                -0.00575198,
                -0.00737695,
                -0.020056,
                0.0392017,
                -0.03369,
                0.00635647,
                -0.00633664,
                0.0180417,
                -0.00403516,
                -0.0358337,
                0.0269401,
                -0.0096226,
                -0.00206882,
                -2.25875e-05,
                -0.0217644,
                0.00155228,
                -0.0154532,
                0.0233061,
                -0.0162327,
                0.00546466,
                -0.0228549,
                -0.00570745,
                -0.0266308,
                -0.00402223,
                -0.016306,
                -0.0169481,
                -0.0201516,
                0.0129683,
                0.0124542,
                -0.024154,
                0.00102885,
                -0.0304875,
                -0.0223008,
                0.0183673,
                -0.0172451,
                -0.00224974,
                -0.0142421,
                0.0379619,
                0.025177,
                -0.0178549,
                -0.0158086,
                -0.0177537,
                0.0107078,
                0.0222288,
                -0.0604662,
                -0.012401,
                0.0254368,
                0.0119141,
                -0.0438302,
                -0.0326998,
                -0.00384491,
                0.000470225,
                0.0185474,
                0.0162998,
                -0.0159506,
                0.0295005,
                -6.1554e-05,
                0.0160622,
                0.000288326,
                -0.000648999,
                -0.0267923,
                0.00723158,
                0.00941976,
                -0.0164452,
                -0.0122785,
                -0.0182622,
                0.000552742,
                0.0437182,
                -0.00503372,
                0.0190309,
                -0.0181843,
                -0.0240844,
                0.0490329,
                0.0138741,
                -0.00334751,
                0.0138657,
                0.0210437,
                0.0176121,
                0.0373755,
                0.0207821,
                -0.0321746,
                -0.0183207,
                0.0184417,
                -0.0277861,
                -0.0172915,
                0.0221156,
                -0.0284727,
                -0.00542797,
                0.0153098,
                -0.0210349,
                -0.00358868,
                -0.00621761,
                -0.0318144,
                0.00610236,
                0.0303712,
                -0.0081422,
                0.0332183,
                -0.0111367,
                0.0256367,
                0.0327637,
                0.0114784,
                -0.0151734,
                0.0339256,
                -0.03822,
                0.0237457,
                0.0214239,
                0.0167199,
                -0.0569272,
                -0.030408,
                0.0260472,
                0.014218,
                0.0636447,
                -0.0124654,
                -0.0128375,
                0.000845648,
                -0.0111793,
                -0.0391962,
                0.0190694,
                -0.00809652,
                0.00798635,
                0.0137909,
                0.0201022,
                -0.0214635,
                -0.00852646,
                0.0153451,
                0.0016777,
                -0.00383181,
                -0.0228454,
                0.00309375,
                0.0253748,
                -0.00784078,
                -0.00844395,
                0.00863846,
                0.0347038,
                -0.00104701,
                0.00571712,
                0.0209463,
                -0.00305707,
                0.0012859,
                0.022858,
                0.009184,
                -0.0141735,
                -0.0054838,
                -0.035572,
                -0.0252546,
                -0.0101812,
                0.0132625,
                0.0158869,
                -0.0165408,
                -0.000378034,
                0.00669881,
                -0.00658714,
                0.00185845,
                0.0255008,
                0.0254312,
                -0.0136121,
                -0.0297164,
                -0.021049,
                0.0101649,
                3.12782e-05,
                0.0160056,
                -0.000428134,
                0.00772701,
                -0.014219,
                0.0168167,
                0.0126584,
                -0.0184312,
                -0.00279822,
                0.00939455,
                -0.0246969,
                -0.0098528,
                -0.0269946,
                -0.0459563,
                -0.0105255,
                -0.0145345,
                -0.01605,
                0.0366831,
                -0.0228725,
                0.0159332,
                -0.0208152,
                0.00881005,
                0.0234657,
                0.0139409,
                -0.00487048,
                0.01975,
                0.0114501,
                0.00979551,
                -0.0261557,
                -0.0387643,
                0.0064362,
                0.0168157,
                0.0626361,
                0.00476391,
                0.0285697,
                -0.0208412,
                0.0245134,
                0.000865457,
                -0.0316652,
                0.0184202,
                0.0152929,
                -0.017068,
                -0.00895919,
                0.0344911,
                0.0292035,
            ]
        )

        # Model: y = b1 + b2*x + b3*exp[-0.5*((b4-x)*b5)^2] + b6*exp[-0.5*((b7-x)*b8)^2]
        model = (
            b1
            + b2 * x_data
            + b3 * jnp.exp(-0.5 * ((b4 - x_data) * b5) ** 2)
            + b6 * jnp.exp(-0.5 * ((b7 - x_data) * b8) ** 2)
        )

        # Residuals: (model - observed) / e_data
        residuals = (model - y_data) / e_data

        # Sum of squared residuals
        return jnp.sum(residuals**2)

    @property
    def y0(self):
        """Starting point."""
        return jnp.array([0.0, 0.0, 0.01, 0.00037, 1.0e5, 0.0979798, 0.000167, 1.0e5])

    @property
    def args(self):
        """Additional arguments (none for this problem)."""
        return None

    @property
    def bounds(self):
        """No bounds for this problem."""
        return None

    @property
    def expected_result(self):
        """Expected solution (not available for this problem)."""
        return None

    @property
    def expected_objective_value(self):
        """Expected objective value (not available for this problem)."""
        return None
