import{r as u,v as P,_ as S,d as _,F as f,j as e,M as A,g as C,I as H,B as p,P as N,a as g,f as F,p as M,b as V,C as E,o as z,E as I}from"./index-k5nYwGaK.js";import{C as O,M as $}from"./index-uY4zMwKa.js";import{c as R}from"./utils-D2B0dIuM.js";import{u as T,b as L,p as D}from"./index-3Bvi5uKw.js";import{D as G}from"./index-ZNw6Pa6Z.js";import{S as U,P as W}from"./index-7-CCDVgE.js";import{T as q}from"./index-BR1XWe93.js";import"./index-ZTsZCk9V.js";import"./index-B1DUqJmL.js";import"./Table-B22HuOla.js";import"./addEventListener-Z2JU81NB.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"},K=function(c,h){return u.createElement(P,S({},c,{ref:h,icon:J}))},Q=u.forwardRef(K);const X=({visible:o,onClose:c,params:h})=>{if(!o)return null;const[m,i]=u.useState([]),d=async()=>{const s=(await g.get("/list-namespace")).data;i(s)},{messageApi:t}=_(),[x,n]=u.useState(),[l]=f.useForm(),b=async()=>{const r=await l.validateFields();x?await g.post("/save-or-update-namespace",{...r,namespace_id:x.namespace_id}):await g.post("/save-or-update-namespace",{...r}),d()},w=async r=>{try{await g.delete(`/delete-namespace-by-id/${r}`),d(),t.success("删除成功")}catch(s){t.error(s.response.data.message)}};return u.useEffect(()=>{d()},[]),e.jsxs(A,{title:"安装namespace",open:o,onCancel:c,children:[e.jsx(C,{children:e.jsxs(f,{form:l,onFinish:b,children:[e.jsx(f.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(H,{})}),e.jsx(f.Item,{children:e.jsx(p,{type:"primary",htmlType:"submit",children:"Submit"})})]})}),m&&m.map(r=>e.jsxs("div",{style:{display:"flex",marginBottom:"0.5rem",justifyContent:"space-between"},children:[e.jsxs("div",{children:[r.name,"(",r.namespace_id,")"]}),e.jsx(p,{type:"primary",size:"small",onClick:()=>{n(r),l.setFieldsValue({name:r.name})},children:"更新"}),e.jsx(N,{title:"确定删除吗？",onConfirm:()=>{w(r.namespace_id)},children:e.jsx(p,{danger:!0,size:"small",children:"删除"})})]},r.namespace_id))]})},Y=({visible:o,onClose:c,params:h})=>{if(!o)return null;const{messageApi:m}=_(),[i,d]=u.useState([]),t=async()=>{const l=(await g.get("/list-namespace-file")).data;d(l)};u.useEffect(()=>{t()},[]);const x=async n=>{try{await g.post(`/import-namespace-component?namespace=${n}`),t(),m.success("安装成功")}catch(l){m.error(l.response.data.message)}};return e.jsx(A,{footer:null,title:"安装namespace",open:o,onCancel:c,children:i&&i.map(n=>e.jsxs(C,{style:{display:"flex",marginBottom:"0.5rem",justifyContent:"space-between"},children:[e.jsxs("div",{children:[n.name,"(",n.namespace_id,")"]}),e.jsx(N,{title:"确定安装吗？",onConfirm:()=>{x(n.namespace_id)},children:e.jsx(p,{size:"small",children:"安装"})})]},n.namespace_id))})},pe=({params:o,map:c})=>{const{component_type:h}=o,m=a=>(c&&(a=c(a)),{id:a.id,component_id:a.component_id,name:a.name,category:a.category,img:a.img,tags:a.tags,order:a.order_index,path:`/component/${h}/${a.component_id}`,namespace:a.namespace,namespace_name:a.namespace_name}),{data:i,pageNumber:d,totalPage:t,loading:x,reload:n,pageSize:l,setPageNumber:b}=T({pageApi:D,params:o||{},map:m}),w=F(),{messageApi:r}=_(),{modal:s,openModal:j,closeModal:y}=M();return e.jsxs("div",{style:{maxWidth:"1500px",margin:"1rem auto"},children:[e.jsxs(C,{justify:"flex-end",gap:"small",children:[e.jsx(p,{size:"small",color:"cyan",variant:"solid",onClick:()=>{j("modalA",{data:void 0,structure:{component_type:h}})},children:"创建组件"}),e.jsx(p,{size:"small",color:"cyan",variant:"solid",onClick:()=>{j("modalB")},children:"创建/更新namespace"}),e.jsx(p,{size:"small",color:"cyan",variant:"solid",onClick:()=>{j("modalC")},children:"安装namespace"}),e.jsx(p,{size:"small",color:"primary",variant:"solid",onClick:n,children:"刷新"})]}),e.jsx("div",{style:{marginBottom:"2rem"}}),e.jsx(U,{spinning:x,children:Array.isArray(i)&&i.length!=0?e.jsx(V,{gutter:16,style:{position:"relative"},children:i.map((a,B)=>e.jsx(E,{lg:4,sm:6,xs:24,style:{marginBottom:"1rem",cursor:"pointer"},children:e.jsxs(O,{hoverable:!0,style:{height:"100%"},cover:e.jsx("img",{alt:a.label,src:a.img}),onClick:()=>w(`${a.path}`),children:[e.jsx($,{title:e.jsxs(e.Fragment,{children:[a.name,e.jsx(z,{title:a==null?void 0:a.namespace,children:e.jsxs("span",{style:{margin:"0",color:"rgba(0, 0, 0, 0.45)",fontSize:"0.5rem"},children:[" ",a==null?void 0:a.namespace_name]})})]}),description:a==null?void 0:a.description,style:{marginBottom:"1rem"}}),a.tags&&Array.isArray(a.tags)&&a.tags.map((v,k)=>e.jsx(z,{title:v,children:e.jsx(q,{style:{wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:100,display:"inline-block",cursor:"default"},color:R[k],children:v})},k)),e.jsx("div",{onClick:v=>{v.stopPropagation(),j("modalG",a)},style:{position:"absolute",right:10,bottom:10,fontSize:15,color:"rgba(0,0,0,0.45)",cursor:"pointer"},children:e.jsx(Q,{})})]})},B))}):e.jsx(I,{})}),t!=0&&e.jsxs(C,{style:{marginTop:"1rem"},align:"center",children:["一共",t,"条数据  ",e.jsx(W,{current:d,pageSize:l,total:t,onChange:a=>b(a),showSizeChanger:!1})]}),e.jsx(L,{callback:n,visible:s.key=="modalA"&&s.visible,onClose:y,params:s.params}),e.jsx(X,{visible:s.key=="modalB"&&s.visible,onClose:y,params:s.params}),e.jsx(Y,{visible:s.key=="modalC"&&s.visible,onClose:y,params:s.params}),e.jsx(G,{visible:s.key=="modalG"&&s.visible,onClose:y,callback:n,params:s.params})]})};export{pe as default};
