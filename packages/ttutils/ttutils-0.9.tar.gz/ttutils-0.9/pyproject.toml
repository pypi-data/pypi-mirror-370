[build-system]
requires = ['setuptools', 'setuptools-scm']
build-backend = 'setuptools.build_meta'

[project]
name = 'ttutils'
authors = [
    {name = 'Dmitriy Vlasov', email = 'support@tamtamteam.com'},
]
description = 'Tools for routine tasks'
readme = 'README.rst'
requires-python = '>=3.10'
classifiers = [
    'Development Status :: 5 - Production/Stable',
    'Environment :: Plugins',
    'Intended Audience :: Developers',
    'License :: OSI Approved :: Apache Software License',
    'Programming Language :: Python',
    'Programming Language :: Python :: 3',
    'Programming Language :: Python :: 3.10',
    'Programming Language :: Python :: 3.11',
    'Programming Language :: Python :: 3.12',
    'Programming Language :: Python :: 3.13',
    'Topic :: Software Development :: Libraries :: Python Modules',
]
dependencies = [
    'PyYaml',
    'toml',
    'python-dateutil',
]
keywords = [
    'configuration',
    'utils'
]
license = {text = 'Apache-2.0'}
dynamic = ['version']

[project.optional-dependencies]
dev = [
    'pytest-runner',
    'pytest',
    'pytest-cov',
    'pytest-asyncio',
    'ruff',
    'mypy',
]

[tool.setuptools.dynamic]
version = {attr = 'ttutils.__version__'}

[tool.setuptools.packages.find]
exclude=['tests.*', 'tests']

[tool.setuptools.package-data]
'ttutils' = ['py.typed']

[tool.pytest.ini_options]
addopts = '--verbose --cov=ttutils --cov-report=html --asyncio-mode=auto'
testpaths = [
    'tests',
]

[tool.coverage.run]
branch = true
omit = ['tests/*']

[tool.ruff]
line-length = 100
target-version = 'py310'
preview = true

[tool.ruff.lint]
preview = true
select = [
    'E', 'W', 'PL', 'C90', 'N', 'UP',
    # pep8-errors, pep8-warn, pylint, mccabe, pep8-naming, pyupgrade, isort
    'F', 'B', 'A', 'T20', 'BLE', 'RET',
    # flake8, flake8-bugbear, flake8-builtins, flake8-print, flake8-blind-except, flake8-return
    'ANN', 'ASYNC', 'DTZ', 'ISC', 'Q',
    # flake8-annotations, flake8-async, flake8-datetimez, flake8-implicit-str-concat, flake8-quotes
]
ignore = [
    'PLR6301',  # no-self-use
    'ANN401',  # Dynamically typed expressions (typing.Any) are disallowed
]

[tool.ruff.lint.per-file-ignores]
'tests/test_config.py' = ['B018', 'N806']
'tests/*' = [
    'PLR2004',  # Checks for the use of unnamed numerical constants ('magic') values in comparisons
    'PLC1901',  # Checks for comparisons to empty strings
    'ANN',  # flake8-annotations
]

[tool.ruff.lint.mccabe]
max-complexity = 10

[tool.ruff.lint.pep8-naming]
extend-ignore-names = ['test_*']

[tool.ruff.lint.flake8-annotations]
allow-star-arg-any = true

[tool.ruff.lint.flake8-quotes]
inline-quotes = 'single'
docstring-quotes = 'single'
multiline-quotes = 'single'
avoid-escape = false

[tool.ruff.lint.isort]
case-sensitive = true
combine-as-imports = true
lines-after-imports = 2
lines-between-types = 1
split-on-trailing-comma = false

[tool.mypy]
show_error_codes = true
warn_redundant_casts = true
follow_imports = 'normal'
strict_optional = true
warn_unused_ignores = true
warn_unreachable = true
warn_no_return = true
disallow_untyped_defs = true
disallow_incomplete_defs = true
ignore_missing_imports = true
