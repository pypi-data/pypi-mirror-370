Metadata-Version: 2.4
Name: pywhatsweb
Version: 0.4.1
Summary: Biblioteca Python para WhatsApp Web corporativo baseada em sidecar Node.js com whatsapp-web.js
Author-email: TI LÃ©o Team <ti.leo@example.com>
License-Expression: MIT
Project-URL: Homepage, https://github.com/llongaray/pywhatsweb
Project-URL: Documentation, https://github.com/llongaray/pywhatsweb#readme
Project-URL: Repository, https://github.com/llongaray/pywhatsweb.git
Project-URL: Bug Tracker, https://github.com/llongaray/pywhatsweb/issues
Project-URL: Changelog, https://github.com/llongaray/pywhatsweb/blob/main/CHANGELOG.md
Project-URL: Funding, https://github.com/sponsors/llongaray
Keywords: whatsapp,whatsapp-web.js,sidecar,corporate,multi-user,kanban,messaging
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3 :: Only
Classifier: Operating System :: OS Independent
Classifier: Topic :: Communications :: Chat
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Framework :: Django
Classifier: Framework :: FastAPI
Classifier: Framework :: Flask
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: requests>=2.25.0
Requires-Dist: websockets>=10.0
Requires-Dist: python-dotenv>=0.19.0
Requires-Dist: typing-extensions>=3.10.0; python_version < "3.8"
Requires-Dist: packaging>=21.0
Provides-Extra: django
Requires-Dist: django>=3.2.0; extra == "django"
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: pytest-mock>=3.10.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: build>=0.10.0; extra == "dev"
Requires-Dist: twine>=4.0.0; extra == "dev"
Requires-Dist: sphinx>=6.0.0; extra == "dev"
Requires-Dist: pre-commit>=3.0.0; extra == "dev"
Dynamic: license-file

# PyWhatsWeb ğŸš€ v0.2.1

**Biblioteca Python pura** para WhatsApp Web corporativo, baseada em sidecar Node.js com `whatsapp-web.js`.

## ğŸ¯ **O QUE Ã‰**

PyWhatsWeb Ã© uma **biblioteca Python** que pode ser usada em **qualquer projeto Python**:
- âœ… **Scripts Python simples**
- âœ… **FastAPI**
- âœ… **Flask** 
- âœ… **Django** (opcional)
- âœ… **Qualquer outro framework Python**

**NÃƒO Ã© um projeto Django** - Ã© uma biblioteca Python que pode ser integrada em projetos Django se vocÃª quiser.

## âœ¨ **CARACTERÃSTICAS**

- ğŸ” **AutenticaÃ§Ã£o QR Code** via sidecar Node.js
- ğŸ“¡ **Eventos WebSocket** em tempo real
- ğŸ¯ **Multi-sessÃ£o** com isolamento por sessionId
- ğŸ“Š **Sistema Kanban** (NEW/ACTIVE/DONE) para roteamento
- ğŸ’¾ **Storage pluggable** (FileSystem + Django opcional)
- ğŸŒ **API HTTP** para controle de sessÃµes
- ğŸ”’ **AutenticaÃ§Ã£o por API Key**
- ğŸ“± **Suporte completo** ao whatsapp-web.js

## ğŸš€ **INSTALAÃ‡ÃƒO**

### PyPI Oficial
```bash
pip install pywhatsweb
```

### Com suporte Django (opcional)
```bash
pip install pywhatsweb[django]
```

### Desenvolvimento
```bash
git clone https://github.com/llongaray/pywhatsweb.git
cd pywhatsweb
pip install -e .
```

## ğŸ“– **USO BÃSICO (SEM Django)**

### 1. Script Python Simples
```python
from pywhatsweb import WhatsWebManager, FileSystemStore

# Criar manager com storage de filesystem
manager = WhatsWebManager(
    sidecar_host="localhost",
    sidecar_port=3000,
    api_key="sua-api-key",
    storage=FileSystemStore("./whatsapp_data")  # Storage local
)

# Criar sessÃ£o
session = manager.create_session("sessao_123")

# Configurar eventos
@session.on("qr")
def on_qr(data):
    print(f"ğŸ” QR Code: {data['qr'][:50]}...")

@session.on("message")
def on_message(data):
    print(f"ğŸ“¨ Nova mensagem: {data['body']}")

# Iniciar sessÃ£o
session.start()
```

### 2. FastAPI
```python
from fastapi import FastAPI
from pywhatsweb import WhatsWebManager, FileSystemStore

app = FastAPI()

# Criar manager global
manager = WhatsWebManager(
    sidecar_host="localhost",
    sidecar_port=3000,
    api_key="sua-api-key",
    storage=FileSystemStore("./whatsapp_data")
)

@app.post("/whatsapp/session/{session_id}/start")
async def start_session(session_id: str):
    session = manager.create_session(session_id)
    session.start()
    return {"message": "SessÃ£o iniciada"}

@app.post("/whatsapp/session/{session_id}/send")
async def send_message(session_id: str, to: str, message: str):
    session = manager.get_session(session_id)
    session.send_text(to, message)
    return {"message": "Mensagem enviada"}
```

### 3. Flask
```python
from flask import Flask, request, jsonify
from pywhatsweb import WhatsWebManager, FileSystemStore

app = Flask(__name__)

# Criar manager global
manager = WhatsWebManager(
    sidecar_host="localhost",
    sidecar_port=3000,
    api_key="sua-api-key",
    storage=FileSystemStore("./whatsapp_data")
)

@app.route('/whatsapp/session/<session_id>/start', methods=['POST'])
def start_session(session_id):
    session = manager.create_session(session_id)
    session.start()
    return jsonify({"message": "SessÃ£o iniciada"})

@app.route('/whatsapp/session/<session_id>/send', methods=['POST'])
def send_message(session_id):
    data = request.get_json()
    session = manager.get_session(session_id)
    session.send_text(data['to'], data['message'])
    return jsonify({"message": "Mensagem enviada"})
```

## ğŸ”§ **INTEGRAÃ‡ÃƒO COM DJANGO (OPCIONAL)**

Se vocÃª **quiser** usar em um projeto Django, pode usar o `DjangoORMStore`:

```python
from pywhatsweb import WhatsWebManager, DjangoORMStore
from .models import (WhatsAppSession, WhatsAppMessage, WhatsAppContact,
                     WhatsAppGroup, WhatsAppChat, WhatsAppSessionEvent)

# Criar manager com storage Django
manager = WhatsWebManager(
    sidecar_host="localhost",
    sidecar_port=3000,
    api_key="sua-api-key",
    storage=DjangoORMStore()
)

# Configurar models Django (vocÃª deve implementar)
manager.storage.set_models(
    session_model=WhatsAppSession,
    message_model=WhatsAppMessage,
    contact_model=WhatsAppContact,
    group_model=WhatsAppGroup,
    chat_model=WhatsAppChat,
    event_model=WhatsAppSessionEvent
)

# Usar normalmente
session = manager.create_session("sessao_123")
session.start()
```

**NOTA:** Django NÃƒO Ã© obrigatÃ³rio! A biblioteca funciona perfeitamente sem Django usando `FileSystemStore`.

## ğŸ—ï¸ **ARQUITETURA**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP + WebSocket    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Seu App       â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   Sidecar       â”‚
â”‚   Python        â”‚                        â”‚   Node.js       â”‚
â”‚                 â”‚                        â”‚                 â”‚
â”‚  PyWhatsWeb    â”‚                        â”‚ whatsapp-web.js â”‚
â”‚  (SDK)         â”‚                        â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Seu App Python**: Usa a biblioteca PyWhatsWeb
- **Sidecar Node.js**: Gerencia conexÃµes WhatsApp via whatsapp-web.js
- **ComunicaÃ§Ã£o**: HTTP (aÃ§Ãµes) + WebSocket (eventos)

## ğŸ“± **SIDECAR NODE.JS**

A biblioteca precisa do sidecar Node.js rodando. Veja a pasta `sidecar/` para instalaÃ§Ã£o:

```bash
cd sidecar
npm install
npm start
```

## ğŸ¯ **SISTEMA KANBAN**

A biblioteca fornece enums para roteamento de conversas:

```python
from pywhatsweb.enums import KanbanStatus

# Status disponÃ­veis
KanbanStatus.NEW      # Aguardando
KanbanStatus.ACTIVE   # Em atendimento  
KanbanStatus.DONE     # ConcluÃ­do

# Nomes de exibiÃ§Ã£o
KanbanStatus.get_display_name(KanbanStatus.NEW)  # "Aguardando"
```

## ğŸ’¾ **STORAGE PLUGGABLE**

### FileSystemStore (padrÃ£o)
```python
from pywhatsweb import FileSystemStore

storage = FileSystemStore("./whatsapp_data")
# Salva tudo em arquivos JSON
```

### DjangoORMStore (opcional)
```python
from pywhatsweb import DjangoORMStore

storage = DjangoORMStore()
# Salva no banco Django (se disponÃ­vel)
```

## ğŸ”Œ **EVENTOS WEBSOCKET**

```python
@session.on("qr")
def on_qr(data):
    # QR Code gerado
    qr_data_url = data['qr']  # data:image/png;base64,...

@session.on("authenticated")
def on_authenticated(data):
    # AutenticaÃ§Ã£o bem-sucedida

@session.on("ready")
def on_ready(data):
    # Cliente WhatsApp pronto

@session.on("message")
def on_message(data):
    # Nova mensagem recebida
    chat_id = data['chatId']
    message_body = data['body']
    sender = data['from']

@session.on("disconnected")
def on_disconnected(data):
    # Cliente desconectado
```

## ğŸ“¡ **API HTTP**

### SessÃµes
- `POST /session/:id/start` - Iniciar sessÃ£o
- `POST /session/:id/stop` - Parar sessÃ£o
- `GET /session/:id/status` - Status da sessÃ£o

### Mensagens
- `POST /session/:id/send-message` - Enviar mensagem

### Health Check
- `GET /health` - Status do sidecar

## ğŸš¨ **IMPORTANTE**

- **PyWhatsWeb Ã© uma BIBLIOTECA Python**, nÃ£o um projeto Django
- **Funciona em qualquer projeto Python** usando FileSystemStore
- **Django Ã© opcional** - use DjangoORMStore se quiser
- **Sidecar Node.js Ã© obrigatÃ³rio** para funcionar
- **NÃ£o abre navegador** - tudo via whatsapp-web.js headless

## ğŸ§ª **EXEMPLOS**

Veja a pasta `examples/` para exemplos completos:
- `basic_usage.py` - Uso bÃ¡sico
- `django_integration.py` - IntegraÃ§Ã£o com Django (opcional)
- `django_models_example.py` - Models Django de exemplo

## ğŸ“š **DOCUMENTAÃ‡ÃƒO**

- [Sidecar Node.js](sidecar/README.md)
- [Exemplos](examples/)
- [Changelog](CHANGELOG.md)

## ğŸ¤ **CONTRIBUIÃ‡ÃƒO**

ContribuiÃ§Ãµes sÃ£o bem-vindas! Veja [CONTRIBUTING.md](CONTRIBUTING.md).

## ğŸ“„ **LICENÃ‡A**

MIT License - veja [LICENSE](LICENSE).

---

**PyWhatsWeb** - Biblioteca Python para WhatsApp Web corporativo ğŸš€
