(this.webpackJsonpui_v2=this.webpackJsonpui_v2||[]).push([[21,22],{1037:function(e,t,n){"use strict";n.r(t),n.d(t,"LogsLastRequestEnum",(function(){return A}));var r=n(7),o=n(0),a=n.n(o),c=n(74),i=n(279),s=n(18),u=n.n(s),l=n(228),d=n(292),f=n(11),v=n(388),h=n(5),g=n(17),m=n(65),b=n(979),p=n(14),j=n(9),x={fg:"#FFF",bg:"#000",newline:!1,colors:function(){var e={0:"#000",1:"#A00",2:"#0A0",3:"#A50",4:"#00A",5:"#A0A",6:"#0AA",7:"#AAA",8:"#555",9:"#F55",10:"#5F5",11:"#FF5",12:"#55F",13:"#F5F",14:"#5FF",15:"#FFF"};return c.a.range(0,6).forEach((function(t){c.a.range(0,6).forEach((function(n){c.a.range(0,6).forEach((function(r){return function(e,t,n,r){var o=e>0?40*e+55:0,a=t>0?40*t+55:0,c=n>0?40*n+55:0;r[16+36*e+6*t+n]=function(e){var t,n=[],r=Object(j.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(_(o))}}catch(a){r.e(a)}finally{r.f()}return"#"+n.join("")}([o,a,c])}(t,n,r,e)}))}))})),c.a.range(0,24).forEach((function(t){var n=t+232,r=_(10*t+8);e[n]="#"+r+r+r})),e}()};function _(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t}function O(e,t,n,r){var o;if("text"===t)o=n;else if("display"===t)o=function(e,t,n){t=parseInt("".concat(t),10);var r={"-1":function(){return"<br/>"},0:function(){return e.length&&L(e)},1:function(){return R(e,"b")},3:function(){return R(e,"i")},4:function(){return R(e,"u")},8:function(){return y(e,"display:none")},9:function(){return R(e,"strike")},22:function(){return y(e,"font-weight:normal;text-decoration:none;font-style:normal")},23:function(){return w(e,"i")},24:function(){return w(e,"u")},39:function(){return E(e,n.fg)},49:function(){return I(e,n.bg)},53:function(){return y(e,"text-decoration:overline")}};if(r[t])return r[t]();if(4<t&&t<7)return R(e,"blink");var o,a,c,i;if(29<t&&t<38)return E(e,null===n||void 0===n||null===(o=n.colors)||void 0===o?void 0:o[t-30]);if(39<t&&t<48)return I(e,null===n||void 0===n||null===(a=n.colors)||void 0===a?void 0:a[t-40]);if(89<t&&t<98)return E(e,null===n||void 0===n||null===(c=n.colors)||void 0===c?void 0:c[t-90+8]);if(99<t&&t<108)return I(e,null===n||void 0===n||null===(i=n.colors)||void 0===i?void 0:i[t-100+8])}(e,+n,r);else if("xterm256Foreground"===t){var a;o=E(e,null===r||void 0===r||null===(a=r.colors)||void 0===a?void 0:a[+n])}else if("xterm256Background"===t){var c;o=I(e,null===r||void 0===r||null===(c=r.colors)||void 0===c?void 0:c[+n])}else"rgb"===t&&(o=function(e,t){var n=+(t=t.substring(2).slice(0,-1)).substr(0,2),r=t.substring(5).split(";").map((function(e){return("0"+Number(e).toString(16)).substring(-2)})).join("");return y(e,(38===n?"color:#":"background-color:#")+r)}(e,n));return o}function L(e){var t=e.slice(0);return e.length=0,t.reverse().map((function(e){return"</"+e+">"})).join("")}function R(e,t,n){return n||(n=""),e.push(t),"<".concat(t).concat(n?' style="'.concat(n,'"'):"",">")}function y(e,t){return R(e,"span",t)}function E(e,t){return R(e,"span","color:"+t)}function I(e,t){return R(e,"span","background-color:"+t)}function w(e,t){var n;if(e.slice(-1)[0]===t&&(n=e.pop()),n)return"</"+t+">"}var T=function(e,t){e="string"===typeof e?[e]:e;var n=Object.assign({},x,t),r=[],o=[];return function(e,t,n){var r=!1;function o(){return""}function a(e){return t.newline?n("display",-1):n("text",e),""}var c=[{pattern:/^\x08+/,sub:o},{pattern:/^\x1b\[[012]?K/,sub:o},{pattern:/^\x1b\[\(B/,sub:o},{pattern:/^\x1b\[[34]8;2;\d+;\d+;\d+m/,sub:function(e){return n("rgb",e),""}},{pattern:/^\x1b\[38;5;(\d+)m/,sub:function(e,t){return n("xterm256Foreground",t),""}},{pattern:/^\x1b\[48;5;(\d+)m/,sub:function(e,t){return n("xterm256Background",t),""}},{pattern:/^\n/,sub:a},{pattern:/^\r+\n/,sub:a},{pattern:/^\r/,sub:a},{pattern:/^\x1b\[((?:\d{1,3};?)+|)m/,sub:function(e,t){r=!0,0===t.trim().length&&(t="0");var o,a=t.trimRight().split(";"),c=Object(j.a)(a);try{for(c.s();!(o=c.n()).done;){var i=o.value;n("display",i)}}catch(s){c.e(s)}finally{c.f()}return""}},{pattern:/^\x1b\[\d?J/,sub:o},{pattern:/^\x1b\[\d{0,3};\d{0,3}f/,sub:o},{pattern:/^\x1b\[?[\d;]{0,3}/,sub:o},{pattern:/^(([^\x1b\x08\r\n])+)/,sub:function(e){return n("text",e),""}}];function i(t,n){n>3&&r||(r=!1,e=e.replace(t.pattern,t.sub))}var s=[],u=e.length;e:for(;u>0;){for(var l=0,d=0,f=c.length;d<f;l=++d)if(i(c[l],l),e.length!==u){u=e.length;continue e}if(e.length===u)break;s.push(0),u=e.length}}(e.join(""),n,(function(e,t){var a=O(r,e,"".concat(t),n);a&&o.push(a)})),r.length&&o.push(L(r)),o.join("")},S=n(1);function D(e){var t,n,r=e.index,o=e.style,a=e.data;return Object(S.jsx)("div",{style:o,children:Object(S.jsx)("pre",{className:"LogRow__line",dangerouslySetInnerHTML:{__html:T(null!==(t=null===(n=a.logsList)||void 0===n?void 0:n[r-1])&&void 0!==t?t:"")}})})}D.displayName="RunLogsTab";var A,N=a.a.memo(D);!function(e){e.DEFAULT="default",e.LIVE_UPDATE="live-update",e.LOAD_MORE="load-more"}(A||(A={}));n(1382);function k(e){var t,n,o=e.isRunLogsLoading,s=e.runHash,j=e.runLogs,x=e.inProgress,_=e.updatedLogsCount,O=a.a.useRef(null),L=a.a.useRef(null),R=a.a.useRef({}),y=a.a.useRef({}),E=a.a.useRef(null),I=a.a.useState(A.DEFAULT),w=Object(r.a)(I,2),T=w[0],D=w[1],k=a.a.useState(m.a.Ok),P=Object(r.a)(k,2),F=P[0],M=P[1],C=a.a.useRef([0,0]),U=a.a.useState(null),z=Object(r.a)(U,2),B=z[0],H=z[1],q=a.a.useState(null),V=Object(r.a)(q,2),W=V[0],Y=V[1],G=a.a.useState(0),J=Object(r.a)(G,2),K=J[0],X=J[1],Q=a.a.useState(0),Z=Object(r.a)(Q,2),$=Z[0],ee=Z[1],te=a.a.useState(null),ne=Object(r.a)(te,2),re=ne[0],oe=ne[1];function ae(){var e,t;D(A.LIVE_UPDATE),ce({runHash:s,record_range:E.current?"".concat((null===(e=C.current)||void 0===e?void 0:e[1])>5?(null===(t=C.current)||void 0===t?void 0:t[1])-5:0,":"):""})}function ce(e){M(m.a.Pending),y.current=b.a.getRunLogs(e),y.current.call().then((function(){M(m.a.Ok),ie(),function(){if(x){var e=window.setTimeout(ae,3e3);O.current={intervalId:e}}}()}))}function ie(){var e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(n||T===A.LIVE_UPDATE)&&(null===(t=y.current)||void 0===t||t.abort());(null===(e=O.current)||void 0===e?void 0:e.intervalId)&&clearInterval(O.current.intervalId)}return a.a.useEffect((function(){return ce({runHash:s}),p.a(g.a.runDetails.tabs.logs.tabView),function(){ie(!0)}}),[]),a.a.useEffect((function(){x||ie()}),[x]),a.a.useEffect((function(){var e=c.a.sortBy(Object.values(null!==j&&void 0!==j?j:{}),"index"),t=c.a.sortBy(e.map((function(e){return+e.index}))),n=Array(3).fill("");C.current=[t[0],t[t.length-1]],oe(t),E.current=e.map((function(e){return e.value})).concat(n)}),[j]),a.a.useEffect((function(){var e,t,n,r,o=null!==(e=null===(t=E.current)||void 0===t?void 0:t.length)&&void 0!==e?e:0;if(T===A.LOAD_MORE&&W)null===(n=R.current)||void 0===n||null===(r=n.scrollToItem)||void 0===r||r.call(n,W.visibleStartIndex+_,"start"),D(A.DEFAULT);else if(T===A.LIVE_UPDATE&&W&&(null===W||void 0===W?void 0:W.visibleStopIndex)+_>=o-1||T===A.DEFAULT){var a,i;if(!c.a.isEmpty(re))null===(a=R.current)||void 0===a||null===(i=a.scrollToItem)||void 0===i||i.call(a,o,"end")}else{var s,u,l;null===(s=R.current)||void 0===s||null===(u=s.scrollToItem)||void 0===u||u.call(s,null!==(l=null===W||void 0===W?void 0:W.visibleStartIndex)&&void 0!==l?l:0,"start")}}),[E.current,re]),a.a.useEffect((function(){var e,t,n;T===A.DEFAULT&&K&&$&&(c.a.isEmpty(re)||null===(e=R.current)||void 0===e||null===(t=e.scrollToItem)||void 0===t||t.call(e,null!==(n=null===W||void 0===W?void 0:W.visibleStartIndex)&&void 0!==n?n:0,"start"))}),[K,$]),Object(l.c)((function(){L.current&&(X(L.current.offsetHeight),ee(L.current.offsetWidth))}),L),Object(S.jsx)(f.a,{children:Object(S.jsx)(d.a,{isLoading:o&&T===A.DEFAULT,className:"RunDetailTabLoader",height:"100%",children:c.a.isEmpty(j)||c.a.isEmpty(re)||c.a.isNil(E.current)?Object(S.jsx)(v.a,{size:"xLarge",className:"RunDetailTabLoader",title:"No Logs"}):Object(S.jsx)("div",{className:"RunDetailLogsTabWrapper",children:Object(S.jsx)("div",{className:"RunDetailLogsTab",children:Object(S.jsx)("div",{className:"Logs",ref:L,children:Object(S.jsxs)("div",{className:"Logs__wrapper",children:[Object(S.jsx)(i.d,{ref:R,height:K||100,itemCount:(null===(t=E.current)||void 0===t?void 0:t.length)+1,itemSize:function(){return 15},width:"100%",overscanCount:100,initialScrollOffset:null!==B&&void 0!==B?B:15*(null===(n=E.current)||void 0===n?void 0:n.length),onItemsRendered:function(e){var t=e.visibleStartIndex,n=e.visibleStopIndex;Y({visibleStartIndex:t,visibleStopIndex:n})},itemData:{logsList:E.current},onScroll:function(e){var t,n,r,o=e.scrollOffset,a=e.scrollDirection;H(o),o<=15&&re&&0!==re[0]&&"backward"===a&&(F===m.a.Ok||F===m.a.Pending&&T===A.LIVE_UPDATE)&&(ie(),D(A.LOAD_MORE),ce({runHash:s,record_range:"".concat((null===(t=C.current)||void 0===t?void 0:t[0])>200?(null===(n=C.current)||void 0===n?void 0:n[0])-200:0,":").concat(null===(r=C.current)||void 0===r?void 0:r[0])}))},children:N},"".concat(K).concat($)),Object(S.jsx)("div",{className:u()("overlay",{loading:o&&T===A.LOAD_MORE}),children:Object(S.jsx)(h.l,{size:24})})]})})})})})})}k.displayName="RunLogsTab";var P=a.a.memo(k);t.default=P},1382:function(e,t,n){},1485:function(e,t,n){},1486:function(e,t,n){},1606:function(e,t,n){"use strict";n.r(t);var r,o=n(7),a=n(0),c=n.n(a),i=n(279),s=n(228),u=n(18),l=n.n(u),d=n(292),f=n(11),v=n(388),h=n(5),g=n(1037),m=n(74),b=n(291),p=["title","titleId"];function j(){return(j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function _(e,t){var n=e.title,o=e.titleId,c=x(e,p);return a.createElement("svg",j({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 24 24",style:{enableBackground:"new 0 0 24 24"},xmlSpace:"preserve",ref:t,"aria-labelledby":o},c),n?a.createElement("title",{id:o},n):null,r||(r=a.createElement("path",{d:"M21.5,11.2h-1c0,0,0,0,0,0c-0.4-4.1-3.6-7.4-7.7-7.7c0,0,0,0,0,0v-1c0-0.4-0.3-0.8-0.8-0.8s-0.8,0.3-0.8,0.8v1 c0,0,0,0,0,0c-4.1,0.4-7.4,3.6-7.7,7.7c0,0,0,0,0,0h-1c-0.4,0-0.8,0.3-0.8,0.8s0.3,0.8,0.8,0.8h1c0,0,0,0,0,0 c0.4,4.1,3.6,7.4,7.7,7.7c0,0,0,0,0,0v1c0,0.4,0.3,0.8,0.8,0.8s0.8-0.3,0.8-0.8v-1c0,0,0,0,0,0c4.1-0.4,7.4-3.6,7.7-7.7c0,0,0,0,0,0 h1c0.4,0,0.8-0.3,0.8-0.8S21.9,11.2,21.5,11.2z M12,19c-3.9,0-7-3.1-7-7c0-3.9,3.1-7,7-7c3.9,0,7,3.1,7,7C19,15.9,15.9,19,12,19z  M17,11.6h-1.3c0-0.2-0.1-0.5-0.2-0.7c0,0,0,0,0,0l1-1c0.3-0.3,0.3-0.8,0-1.1s-0.8-0.3-1.1,0l-0.7,0.7c-0.1-1.5-1.3-2.6-2.7-2.6 S9.3,8.1,9.3,9.5L8.5,8.8c-0.3-0.3-0.8-0.3-1.1,0s-0.3,0.8,0,1.1l1,1c0,0,0,0,0,0c-0.1,0.2-0.1,0.5-0.2,0.7H7 c-0.4,0-0.8,0.3-0.8,0.8s0.3,0.8,0.8,0.8h1.2v0.5c0,0.1,0,0.3,0,0.4l-0.8,0.8c-0.3,0.3-0.3,0.8,0,1.1C7.6,16,7.8,16.1,8,16.1 s0.4-0.1,0.5-0.2l0.3-0.3c0.1,0.2,0.3,0.4,0.5,0.6c0.7,0.6,1.6,1,2.6,1s1.9-0.4,2.6-1c0.2-0.2,0.4-0.4,0.5-0.6l0.3,0.3 c0.1,0.1,0.3,0.2,0.5,0.2s0.4-0.1,0.5-0.2c0.3-0.3,0.3-0.8,0-1.1L15.7,14c0-0.1,0-0.2,0-0.4l0-0.5H17c0.4,0,0.8-0.3,0.8-0.8 S17.4,11.6,17,11.6z M12,8.4c0.7,0,1.2,0.5,1.2,1.2h-2.5C10.8,8.9,11.3,8.4,12,8.4z M9.8,13.6l0-1.3c0,0,0,0,0,0s0,0,0,0l0-0.3 c0-0.2,0.1-0.4,0.1-0.6c0.4,0.4,0.8,0.7,1.4,0.9c0,0,0,0,0,0.1v3.1c-0.3-0.1-0.6-0.2-0.9-0.5C10,14.6,9.8,14.1,9.8,13.6z M12.8,15.5 v-3.1c0,0,0,0,0-0.1c0.5-0.2,1-0.5,1.4-0.9c0.1,0.2,0.1,0.4,0.1,0.6v1.6c0,0.5-0.2,1-0.6,1.4C13.4,15.2,13.1,15.4,12.8,15.5z"})))}var O,L=a.forwardRef(_),R=(n.p,n(85)),y=n(411),E={ERROR:{icon:"close-circle",color:"#e64e48",background:"#e64e484a"},WARNING:{icon:"warning-contained",color:"#ffcc00",background:"#ffcc004a"},INFO:{icon:"circle-info",color:"#1473e6",background:"#1473e64a"},DEBUG:{icon:"search",color:"#1c2852",background:"#1c28524a"}};!function(e){e.MONTH="Month",e.DAY="Day",e.RECORD="Record",e.EMPTY="Empty"}(O||(O={}));n(1485);var I=n(1);function w(e){var t=e.data[e.index];return Object(I.jsx)("div",{className:"LogRecordItem",style:e.style,children:function(){var e,n,r,o,a;switch(null===t||void 0===t?void 0:t.itemType){case O.MONTH:return Object(I.jsx)(h.n,{className:"LogRecordItem__content-title",component:"h3",tint:100,weight:700,children:t.date.split("_").join(" ")});case O.DAY:return Object(I.jsxs)("div",{className:"LogRecordItem__title",children:[Object(I.jsx)(h.f,{name:"calendar",fontSize:10,box:!0}),Object(I.jsx)(h.n,{tint:50,size:10,weight:700,children:t.date.split("_").join(" ")})]});case O.RECORD:return Object(I.jsx)("div",{className:"LogRecordItem__content",children:Object(I.jsxs)("div",{className:"LogRecordItem__content__item",children:[Object(I.jsxs)("div",{className:"LogRecordItem__content__item__leftBox",children:[Object(I.jsx)("div",{className:"LogRecordItem__content__item__leftBox__statusBadge",children:"DEBUG"===t.type?Object(I.jsx)(L,{fill:"#1c2852"}):Object(I.jsx)(h.f,{name:E[null!==(e=null===t||void 0===t?void 0:t.type)&&void 0!==e?e:"ERROR"].icon,fontSize:16,color:E[null!==(n=null===t||void 0===t?void 0:t.type)&&void 0!==n?n:"ERROR"].color})}),Object(I.jsxs)("div",{className:"LogRecordItem__content__item__leftBox__content",children:[Object(I.jsx)(h.n,{tint:70,size:12,weight:600,className:"LogRecordItem__content__item__leftBox__date",children:null===t||void 0===t?void 0:t.type}),Object(I.jsx)(h.n,{tint:50,size:12,className:"LogRecordItem__content__item__leftBox__date",children:null!==(r=null===t||void 0===t?void 0:t.date)&&void 0!==r?r:"no date found"})]})]}),Object(I.jsxs)("div",{className:"LogRecordItem__content__item__itemBox",style:{justifyContent:t.extraParams?"flex-start":"center"},children:[Object(I.jsx)(b.a,{title:null!==(o=null===t||void 0===t?void 0:t.message)&&void 0!==o?o:"no message found",children:Object(I.jsx)("div",{children:Object(I.jsx)(h.n,{className:"LogRecordItem__content__item__itemBox__message",component:"pre",size:14,children:null!==(a=null===t||void 0===t?void 0:t.message)&&void 0!==a?a:"no message found"})})}),t.extraParams&&Object(I.jsx)("div",{className:"LogRecordItem__content__item__itemBox__extraParams",children:Object(I.jsx)(R.a,{title:"Message Payload",anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},anchor:function(e){var n=e.onAnchorClick;return Object(I.jsxs)("div",{className:"LogRecordItem__content__item__itemBox__extraParams__dict",onClick:function(e){m.a.isEmpty(t.extraParams)||n(e)},children:[Object(I.jsx)("div",{children:Object(I.jsx)(y.a,{src:t.extraParams,style:{width:500,height:300},autoScale:!0})}),Object(I.jsx)("div",{className:"LogRecordItem__content__item__itemBox__extraParams__dict__overflowHandler",children:Object(I.jsx)(h.f,{name:"arrow-bidirectional-open"})})]})},component:Object(I.jsx)(h.h,{json:t.extraParams,dictVisualizerSize:{width:500,height:300}})},t.hash)})]})]},t.hash)});case O.EMPTY:}}()})}var T=c.a.memo(w),S=n(6),D=n(67),A=n.n(D),N=n(77),k=n(8),P=n.n(k),F=n(2),M=n(24),C=n(176),U=n(806),z=n(138);function B(e){var t,n,r,o=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new H(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function H(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return(H=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new H(e)}var q=function(){var e=Object(C.d)(),t=e.call,n=e.cancel,r=Object(U.a)(function(){var e=Object(M.a)(P.a.mark((function e(n){var r,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.runId,a=n.record_range,e.t0=z.d,e.next=4,t(r,a);case 4:return e.t1=e.sent,e.t2={dataProcessor:function(){var e=Object(M.a)(P.a.mark((function e(t){var n,r,a,c,i,s,u,l,d,f,v,h;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={runLogRecordsList:{},runLogRecordsTotalCount:0},e.prev=1,r=!0,a=!1,e.prev=4,i=B(t);case 6:return e.next=8,i.next();case 8:return s=e.sent,r=s.done,e.next=12,s.value;case 12:if(u=e.sent,r){e.next=20;break}l=u,d=Object(o.a)(l,2),f=d[0],v=d[1],"number"===typeof(h=Object(F.a)(Object(F.a)({},v),{},{hash:f[0]})).hash?n.runLogRecordsList[h.hash]=h:n.runLogRecordsTotalCount=v;case 17:r=!0,e.next=6;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(4),a=!0,c=e.t0;case 26:if(e.prev=26,e.prev=27,r||null==i.return){e.next=31;break}return e.next=31,i.return();case 31:if(e.prev=31,!a){e.next=34;break}throw c;case 34:return e.finish(31);case 35:return e.finish(26);case 36:e.next=42;break;case 38:throw e.prev=38,e.t1=e.catch(1),console.error(e.t1),e.t1;case 42:return e.abrupt("return",Object(F.a)(Object(F.a)({},n),{},{runLogRecordsList:n.runLogRecordsList}));case 43:case"end":return e.stop()}}),e,null,[[1,38],[4,22,26,36],[27,,31,35]])})));return function(t){return e.apply(this,arguments)}}()},e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a=r.fetchData;return{fetchRunLogRecords:function(e){return a(e)},abortRunLogRecordsFetching:function(){n();var e=Object(C.d)();t=e.call,n=e.cancel},runLogRecordsState:r.state,destroy:r.destroy}}();var V=function(e,t){var n,r,a=c.a.useState([]),i=Object(o.a)(a,2),s=i[0],u=i[1],l=c.a.useState(0),d=Object(o.a)(l,2),f=d[0],v=d[1],h=c.a.useState(0),b=Object(o.a)(h,2),p=b[0],j=b[1],x=c.a.useState(g.LogsLastRequestEnum.DEFAULT),_=Object(o.a)(x,2),L=_[0],R=_[1],y=c.a.useRef(q).current,E=c.a.useRef(null),I=c.a.useRef(-1),w=y.runLogRecordsState((function(e){return e}));c.a.useEffect((function(){var t;return m.a.isEmpty(null===(t=w.data)||void 0===t?void 0:t.runLogRecordsList)&&y.fetchRunLogRecords({runId:e}).then((function(){P(),k()})),function(){y.destroy(),P(!0)}}),[]),c.a.useEffect((function(){t||P()}),[t]),c.a.useEffect((function(){var e;m.a.isEmpty(null===(e=w.data)||void 0===e?void 0:e.runLogRecordsList)||u((function(e){var t=Object(S.a)(e.reverse());for(var n in null===(r=w.data)||void 0===r?void 0:r.runLogRecordsList){var r,o,a=+n,c=null===(o=w.data)||void 0===o?void 0:o.runLogRecordsList[n];c&&(t[a]=c)}return t.sort((function(e,t){return t.hash-e.hash}))}))}),[w.data]);var T=c.a.useMemo((function(){var t,n=[],r="",o="",a=0;return s.length&&(null===s||void 0===s||s.forEach((function(t){var c=A()(1e3*t.timestamp).format(N.h);c!==r&&(n.push({date:c,itemType:O.MONTH,height:28}),a+=28,r=c);var i=A()(1e3*t.timestamp).format(N.g);i!==o&&(n.push({date:i,itemType:O.DAY,height:28}),a+=28,o=i);var s=42+14.5*(t.message.trim().match(/\n/g)||"").length;t.args&&(s+=16.5*function e(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)+(Object.keys(t).length>0?1:0);for(var r in t)Array.isArray(t[r])||"object"===typeof t[r]&&null!==t[r]?n+=e(t[r],n):n++;return n>5?5:n}(t.args));var u={date:A()(1e3*t.timestamp).format(N.i),hash:t.hash,message:t.message.trim(),type:t.log_level,creation_time:t.timestamp,extraParams:t.args,runId:e,itemType:O.RECORD,height:s};a+=s,n.push(u)}))),v(a),I.current=null===(t=s[0])||void 0===t?void 0:t.hash,[{itemType:O.EMPTY,height:24}].concat(n)}),[s,e]);function D(){I.current?(R(g.LogsLastRequestEnum.LIVE_UPDATE),y.fetchRunLogRecords({runId:e,record_range:"".concat(I.current,":")}).then((function(){P(),k()}))):(P(),k())}function k(){if(t){var e=window.setTimeout(D,3e3);E.current={intervalId:e}}}function P(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(t||L===g.LogsLastRequestEnum.LIVE_UPDATE)&&y.abortRunLogRecordsFetching(),(null===(e=E.current)||void 0===e?void 0:e.intervalId)&&(clearInterval(E.current.intervalId),E.current=null)}return{isLoading:w.loading,data:T,totalRunLogRecordCount:null!==(n=null===(r=w.data)||void 0===r?void 0:r.runLogRecordsTotalCount)&&void 0!==n?n:0,fetchedCount:s.length,elementsHeightsSum:f,lastRequestType:L,loadMore:function(){var t;if((null===(t=w.data)||void 0===t?void 0:t.runLogRecordsList)&&!w.loading){P(),R(g.LogsLastRequestEnum.LOAD_MORE);var n=s[s.length-1].hash;y.fetchRunLogRecords({runId:e,record_range:n>200?"".concat(n-200,":").concat(n):"0:".concat(n)}).then((function(){P(),k()}))}},startLiveUpdate:k,stopLiveUpdate:P,updateScrollOffset:j,scrollOffset:p,liveUpdateToken:E.current}};n(1486);function W(e){var t=e.runHash,n=e.inProgress,r=V(t,n),a=r.data,u=r.loadMore,m=r.isLoading,b=r.fetchedCount,p=r.totalRunLogRecordCount,j=r.lastRequestType,x=r.elementsHeightsSum,_=r.updateScrollOffset,O=r.scrollOffset,L=r.startLiveUpdate,R=r.stopLiveUpdate,y=r.liveUpdateToken,E=c.a.useRef(null),w=c.a.useRef(null),S=c.a.useState(0),D=Object(o.a)(S,2),A=D[0],N=D[1],k=c.a.useState(0),P=Object(o.a)(k,2),F=P[0],M=P[1];return Object(s.c)((function(){w.current&&(N(w.current.offsetHeight),M(w.current.offsetWidth))}),w),c.a.useEffect((function(){E.current&&E.current.resetAfterIndex(0)}),[a]),Object(I.jsx)(f.a,{children:Object(I.jsx)(d.a,{isLoading:m&&j===g.LogsLastRequestEnum.DEFAULT,className:"RunDetailTabLoader",height:"100%",children:Object(I.jsx)("div",{className:"RunLogRecords",children:Object(I.jsx)("div",{className:"RunLogRecords__contentWrapper",children:p?Object(I.jsxs)("div",{className:"RunLogRecords__contentWrapper__listWrapper",ref:w,children:[Object(I.jsx)(i.d,{ref:E,height:A||100,itemCount:null===a||void 0===a?void 0:a.length,itemSize:function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.height},width:"100%",overscanCount:100,initialScrollOffset:null!==O&&void 0!==O?O:0,itemData:a,onScroll:function(e){var t=e.scrollOffset,n=e.scrollDirection;_(t),"forward"===n&&t+A>x&&b<p&&!1===m&&u(),"backward"===n&&t<=0&&L(),t>5&&y&&R()},children:T},"".concat(A).concat(F)),Object(I.jsx)("div",{className:l()("overlay",{loading:m&&j===g.LogsLastRequestEnum.LOAD_MORE}),children:Object(I.jsx)(h.l,{size:24})})]}):Object(I.jsx)(v.a,{size:"xLarge",className:"RunDetailTabLoader",title:"No Messages"})})})})})}var Y=c.a.memo(W);t.default=Y}}]);
//# sourceMappingURL=RunLogRecords.js.map?version=3fa48af2b81387131513