(this.webpackJsonpui_v2=this.webpackJsonpui_v2||[]).push([[17],{2004:function(e,t,n){"use strict";n.r(t);var a=n(8),i=n.n(a),c=n(2),r=n(24),o=n(7),s=n(0),u=n(74),l=n(228),d=n(388),f=n(292),b=n(11),m=n(5),v=n(17),x=n(14),j=n(979),g=n(220),h=n(63),R=n(90),O=n(187),p=n(61),y=n(6),_=n(291),S=n(841),N=n(29),C=n(98),A=n(1);function w(e){var t,n=e.batch,a=e.index,i=e.observer,c=e.isPinned,r=e.togglePin,o=s.useRef(null);return s.useEffect((function(){o.current&&i&&i.observe(o.current)}),[i]),Object(A.jsx)(b.a,{children:Object(A.jsxs)("div",{className:"RunDetailMetricsTab__container__chartContainer","data-name":n.name,"data-context":Object(R.a)(n.context),ref:o,children:[Object(A.jsx)(_.a,{title:c?"Unpin":"Pin",children:Object(A.jsx)("div",{className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox__pin",children:Object(A.jsx)(m.c,{color:c?"primary":"default",size:"xSmall",variant:"outlined",withOnlyIcon:!0,onClick:function(){return r({name:n.name,context:n.context},c)},children:Object(A.jsx)(m.f,{name:"pin"})})})}),Object(A.jsx)("div",{className:"RunDetailMetricsTab__container__chartContainer__chartBox",children:n.iters?Object(A.jsx)(b.a,{children:Object(A.jsx)(S.a,{data:[{key:n.key,data:{xValues:Object(y.a)(n.iters),yValues:Object(y.a)(n.values)},color:"#1c2852",dasharray:"none",selectors:[n.key]}],index:a})}):Object(A.jsx)(m.l,{})}),Object(A.jsxs)("div",{className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox",children:[Object(A.jsx)(m.n,{component:"h4",tint:100,size:18,weight:600,className:"RunDetailMetricsTab__container__chartContainer__metricDetailBox__metricName",children:Object(h.a)(null===n||void 0===n?void 0:n.name)?Object(C.a)(null===n||void 0===n?void 0:n.name):null===n||void 0===n?void 0:n.name}),null===(t=Object(R.a)(null===n||void 0===n?void 0:n.context))||void 0===t?void 0:t.split(",").map((function(e,t){return Object(A.jsx)(m.b,{monospace:!0,size:"large",color:N.d[0][(t+a)%N.d[0].length],label:e||"Empty context"},t)}))]})]})})}var D=s.memo(w);function T(e){for(var t=e.runHash,n=e.runTraces,a=e.runBatch,y=e.isSystem,_=e.isRunBatchLoading,S=s.useRef(null),N=s.useRef(),C=s.useState(!1),w=Object(o.a)(C,2),T=w[0],M=w[1],B=s.useState([]),L=Object(o.a)(B,2),k=L[0],z=L[1],E=Object(l.a)(g.a,!1),I=s.useMemo((function(){return n.metric.filter((function(e){return y?Object(h.a)(e.name):!Object(h.a)(e.name)}))}),[n.metric,y]),H=[],q=[],P=function(e){var t,n,a=I[e],i=null!==(t=null===E||void 0===E||null===(n=E.pinnedSequences)||void 0===n?void 0:n.findIndex((function(e){return e.name===a.name&&Object(R.a)(e.context)===Object(R.a)(a.context)})))&&void 0!==t?t:-1;i>-1?H[i]=a:q.push(a)},F=0;F<I.length;F++)P(F);function K(e,t){return V.apply(this,arguments)}function V(){return(V=Object(r.a)(i.a.mark((function e(t,n){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n?H.filter((function(e){return!(e.name===t.name&&Object(R.a)(e.context)===Object(R.a)(t.context))})):[].concat(H,[t]),c=g.a.setPinnedSequences({sequences:a},(function(e){g.a.setState({pinnedSequences:H}),Object(p.a)({detail:e,model:j.a})})),g.a.setState({pinnedSequences:a}),c.call();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return T&&e.length>0&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("div",{className:"RunDetailMetricsTab__header",children:Object(A.jsxs)(m.n,{component:"h3",size:16,color:"primary",children:[t?"Pinned ":"","Metrics"]})}),Object(A.jsx)("div",{className:"RunDetailMetricsTab__container",children:(t?e:e.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{sortKey:"".concat(e.name,"_").concat(Object(R.a)(e.context))})})).sort(Object(O.a)({orderBy:"sortKey"}))).map((function(e,n){var i=Object(c.a)(Object(c.a)({},e),null===a||void 0===a?void 0:a.find((function(t){return t.name===e.name&&Object(R.a)(t.context)===Object(R.a)(e.context)})));return Object(A.jsx)(D,{batch:i,index:n,observer:N.current,isPinned:t,togglePin:K},"".concat(i.name,"_").concat(Object(R.a)(i.context)))}))})]})}return H.filter((function(e){return!!e})),s.useEffect((function(){if(S.current){var e,t={root:null===(e=S.current.parentElement)||void 0===e?void 0:e.parentElement,rootMargin:"0px",threshold:0};N.current=new IntersectionObserver((function(e){var t=[];e.forEach((function(e){if(e.isIntersecting){var n=e.target.getAttribute("data-name"),i=e.target.getAttribute("data-context");(null===a||void 0===a?void 0:a.find((function(e){return e.name===n&&Object(R.a)(e.context)===i})))||t.push({name:n,context:i})}})),t.length>0&&z((function(e){return e.concat(t.map((function(e){return I.find((function(t){return t.name===e.name&&Object(R.a)(t.context)===e.context}))})))}))}),t),M(!0)}return x.a(v.a.runDetails.tabs[y?"system":"metrics"].tabView),function(){N.current&&N.current.disconnect()}}),[y,a,T,n.metric,I]),s.useEffect((function(){var e,n;return k.length>0&&(e=window.setTimeout((function(){(n=j.a.getRunMetricsBatch(k,t)).call()}),100)),function(){e&&clearTimeout(e),n&&n.abort()}}),[k,t]),s.useEffect((function(){z((function(e){return e.filter((function(e){return-1===a.findIndex((function(t){return t.name===e.name&&Object(R.a)(t.context)===Object(R.a)(e.context)}))}))}))}),[a]),Object(A.jsx)(b.a,{children:Object(A.jsx)(f.a,{isLoading:_,className:"RunDetailTabLoader",height:"100%",children:u.a.isEmpty(I)?Object(A.jsx)(d.a,{size:"xLarge",className:"RunDetailTabLoader",title:"No tracked ".concat(y?"system":""," metrics")}):Object(A.jsxs)("div",{className:"RunDetailMetricsTab",ref:S,children:[J(H,!0),J(q,!1)]})})})}t.default=s.memo(T)},807:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var a=100,i={S:4,M:6,L:12},c=i.S,r=i.M,o={1:[i.L],2:[r,r],3:[c,c,c],4:[r,r,r,r],5:[c,c,c,r,r],6:[c,c,c,c,c,c],7:[c,c,c,r,r,r,r],8:[c,c,c,c,c,c,r,r],9:[c,c,c,c,c,c,c,c,c]}},841:function(e,t,n){"use strict";var a=n(2),i=n(0),c=n(18),r=n.n(c),o=n(228),s=n(11),u=n(807),l=n(16),d=(n(842),n(1)),f=i.forwardRef((function(e,t){var n=e.data,c=e.index,f=e.id,b=void 0===f?"".concat(c):f,m=e.nameKey,v=void 0===m?"":m,x=e.aggregatedData,j=e.aggregationConfig,g=e.syncHoverState,h=e.axesScaleRange,R=e.ignoreOutliers,O=void 0!==R&&R,p=e.alignmentConfig,y=e.highlightMode,_=void 0===y?l.e.Off:y,S=e.curveInterpolation,N=void 0===S?l.d.Linear:S,C=e.chartTitle,A=e.zoom,w=e.onZoomChange,D=e.resizeMode,T=e.onMount,M=e.axesScaleType,B=void 0===M?{xAxis:l.h.Linear,yAxis:l.h.Linear}:M,L=e.readOnly,k=void 0!==L&&L,z=e.margin,E=void 0===z?{top:30,right:20,bottom:30,left:60}:z,I=i.useRef({margin:E,height:0,width:0}),H=i.useRef({height:0,width:0}),q=i.useRef(null),P=i.useRef(null),F=i.useRef(null),K=i.useRef(null),V=i.useRef(null),J=i.useRef(null),Z=i.useRef(null),U=i.useRef(null),X=i.useRef(null),G=i.useRef(null),Q=i.useRef(null),W=i.useRef({}),Y=i.useRef({}),$=i.useRef({}),ee=i.useRef({}),te=i.useRef(),ne=[],ae=[n,A,O,_,B,h,N,j,k,p,D,b];function ie(){Object(l.k)({visAreaRef:P}),function(){Object(l.l)({index:c,id:b,nameKey:v,visBoxRef:I,plotBoxRef:H,parentRef:q,visAreaRef:P,svgNodeRef:F,bgRectNodeRef:K,plotNodeRef:V,axesNodeRef:J,linesNodeRef:Z,attributesNodeRef:U,chartTitle:C});var e=Object(l.C)({data:n,ignoreOutliers:O,visBoxRef:I,axesScaleType:B,axesScaleRange:h,aggregatedData:x,aggregationConfig:j,unableToDrawConditions:ne,attributesRef:$}),t=e.processedData,a=e.processedAggrData,i=e.min,r=e.max;Object(l.m)({svgNodeRef:F,axesNodeRef:J,axesRef:W,plotBoxRef:H,xScale:$.current.xScale,yScale:$.current.yScale,visBoxRef:I,alignmentConfig:p,axesScaleType:B,humanizerConfigRef:ee,drawBgTickLines:{y:!0,x:!1}}),Object(l.q)({id:b,processedData:t,nameKey:v,linesNodeRef:Z,linesRef:Y,curveInterpolation:N,xScale:$.current.xScale,yScale:$.current.yScale,highlightMode:_,aggregationConfig:j,processedAggrData:a,readOnly:k}),!k&&Z.current&&Z.current.selectChildren().size()>u.c&&Z.current.classed("optimizeRendering",!0),Object(l.n)({id:b,plotBoxRef:H,plotNodeRef:V,visBoxRef:I,axesRef:W,attributesRef:$,linesRef:Y,svgNodeRef:F,axesScaleType:B,min:i,max:r,axesScaleRange:h,zoom:A,onZoomChange:w,readOnly:k,unableToDrawConditions:ne}),k||Object(l.o)({index:c,id:b,nameKey:v,data:n,processedData:t,axesScaleType:B,highlightMode:_,syncHoverState:g,visAreaRef:P,attributesRef:$,plotBoxRef:H,visBoxRef:I,svgNodeRef:F,bgRectNodeRef:K,attributesNodeRef:U,xAxisLabelNodeRef:X,yAxisLabelNodeRef:G,linesNodeRef:Z,highlightedNodeRef:Q,aggregationConfig:j,alignmentConfig:p}),Object(l.y)({renderArr:ne,visAreaRef:P,attributesRef:$,readOnly:k,syncHoverState:g})}()}var ce=i.useCallback((function(e){(null===e||void 0===e?void 0:e.length)&&(te.current=window.requestAnimationFrame(ie))}),ae),re=i.useCallback((function(){te.current&&window.cancelAnimationFrame(te.current)}),[]);return Object(o.c)(ce,q,re),i.useEffect((function(){$.current.currentXValue=void 0}),[p,n]),i.useEffect((function(){return te.current=window.requestAnimationFrame(ie),function(){te.current&&window.cancelAnimationFrame(te.current)}}),ae),i.useEffect((function(){"function"===typeof T&&T()}),[]),i.useImperativeHandle(t,(function(){return{setActiveLineAndCircle:function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null===(t=(n=$.current).setActiveLineAndCircle)||void 0===t||t.call(n,e,a,i)},updateHoverAttributes:function(e,t){var n,a;null===(n=(a=$.current).updateHoverAttributes)||void 0===n||n.call(a,e,t)},clearHoverAttributes:function(){var e,t;null===(e=(t=$.current).clearHoverAttributes)||void 0===e||e.call(t)},setFocusedState:function(e){var t;e&&($.current.focusedState=Object(a.a)(Object(a.a)({},e),{},{visId:null!==(t=e.visId)&&void 0!==t?t:"".concat(e.chartIndex)}))}}})),Object(d.jsx)(s.a,{children:Object(d.jsx)("div",{id:"vis-"+b,ref:q,className:r()("LineChart",{zoomMode:!k&&(null===A||void 0===A?void 0:A.active)}),children:Object(d.jsx)("div",{ref:P})})})}));f.displayName="LineChart",t.a=i.memo(f)},842:function(e,t,n){}}]);
//# sourceMappingURL=RunDetailMetricsAndSystemTab.js.map?version=b069c0cd097a2c864dca