<!-- block_cronograma.html -->
{% load wagtailimages_tags %}

{% if value.imagem_fundo %}
    {% image value.imagem_fundo original as bg_image %}
{% endif %}

<section class="cronograma-secao" 
        {% if bg_image %}
        style="background-image: url('{{ bg_image.url }}');"
        {% else %}
        style="background-color: #ffff;"
        {% endif %}>

    <div class="cronograma-container">
        <!-- Título -->
        {% if value.titulo %}
            <h2 class="cronograma-titulo" style="color: {{ value.cor_titulo }};">
                {{ value.titulo }}
            </h2>
        {% endif %}
        
        <!-- Timeline -->
        <div class="cronograma-timeline">
            {% for step_block in value.steps %}
                {% if step_block.block_type == 'step' %}
                    <div class="cronograma-step">
                        <!-- Círculo com Data -->
                        <div class="step-circulo" style="background-color: {{ value.cor_titulo }};">
                            <span class="step-data" style="color: {{ step_block.value.cor_data }};">
                                {{ step_block.value.data }}
                            </span>
                        </div>
                        
                        <!-- Descrição -->
                        <div class="step-descricao" style="color: {{ step_block.value.cor_descricao }};">
                            {{ step_block.value.descricao }}
                        </div>
                        
                        <!-- Linha conectora (não aparece no último) -->
                        {% if not forloop.last %}
                            <div class="step-linha"></div>
                        {% endif %}
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</section>