Metadata-Version: 2.3
Name: project-work-summary-mcp
Version: 0.0.1b2
Summary: 协同平台MCP服务
Author: wangwenbin
Author-email: wangwenbin <wangwenbin@gwm.cn>
Requires-Dist: mcp[cli]>=1.13.0
Requires-Dist: mysql-connector-python>=8.2.0
Requires-Python: >=3.13
Description-Content-Type: text/markdown

# Project Work Summary MCP

这是一个用于获取项目工作摘要的MCP服务器，它连接到MySQL数据库来查询发布内容。

## 问题解决：MCP error -32000: Connection closed

### 常见原因及解决方案

1. **数据库连接问题**
   - 确保数据库服务器正在运行且可访问
   - 检查网络连接是否正常
   - 验证数据库凭据是否正确

2. **环境配置问题**
   - 确保设置了正确的环境变量
   - 检查 `ENV` 变量是否设置为 `prod` 或 `test`

3. **连接超时问题**
   - 增加了重试机制和超时设置
   - 数据库连接现在具有3次重试机会

## 安装和运行

### 安装依赖

```bash
cd project-work-summary-mcp
uv sync
```

### 运行测试

```bash
# 使用本地测试脚本
./localTest.sh
```

或者直接运行：

```bash
uv run project-work-summary-mcp
```

## 配置

### 环境变量

- `ENV`: 环境类型 (`prod` 或 `test`)
- `LOGLEVEL`: 日志级别 (`DEBUG`, `INFO`, `WARNING`, `ERROR`)

### 数据库配置

配置文件位于 `config/` 目录下：
- `mysql_test_config.json`: 测试环境配置
- `mysql_prod_config.json`: 生产环境配置

## 故障排除

### 1. 数据库连接失败

如果遇到数据库连接问题，请检查：

```bash
# 测试数据库连接
telnet 10.246.1.208 3306
```

### 2. MCP连接问题

如果仍然出现 `Connection closed` 错误，请：

1. 检查日志输出以获取更多详细信息
2. 确保网络可达性
3. 验证数据库凭据
4. 尝试重启MCP服务器

### 3. 超时问题

如果服务器启动后很快关闭，请检查：

- 网络延迟
- 数据库响应时间
- 服务器资源限制

## 日志

日志会输出到控制台，包含详细的调试信息。可以通过设置 `LOGLEVEL` 环境变量来调整日志级别。

## 改进措施

本次更新增加了以下改进来解决连接问题：

1. **增强的连接重试机制**：数据库连接现在有3次重试机会
2. **更好的错误处理**：增加了详细的错误日志记录
3. **超时控制**：添加了服务器启动超时机制
4. **改进的日志记录**：提供更多上下文信息帮助调试
