from typing import Any
from unittest import TestCase

from smoothglue_malware_scan.exceptions import (
    MalwareFoundException,
    ScanningServiceException,
)
from smoothglue_malware_scan.scanners.base import BaseMalwareScanner


class DummyMalwareScanner(BaseMalwareScanner):
    def _init_scanner(self) -> Any:
        return "Foo"

    def __str__(self):
        return self.scanner


class ExceptionRepresentationTest(TestCase):
    def test_malware_found_exception(self):
        exception = MalwareFoundException("test")
        self.assertEqual(str(exception), "Malware found: test")

    def test_scanning_service_exception(self):
        exception = ScanningServiceException(DummyMalwareScanner())
        self.assertEqual(str(exception), "Error scanning with: Foo")

        exception = ScanningServiceException(DummyMalwareScanner(), "bar")
        self.assertEqual(str(exception), "Error scanning with: Foo\n\tReason: bar")
