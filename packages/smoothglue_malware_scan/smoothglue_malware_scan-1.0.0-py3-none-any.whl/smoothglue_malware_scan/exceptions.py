from smoothglue_malware_scan.scanners.base import BaseMalwareScanner


class MalwareFoundException(Exception):
    """
    Exception raised when malware is found by a scanner
    """

    def __init__(self, malware_message: str):
        self.malware_message = malware_message
        super().__init__(self.malware_message)

    def __str__(self):
        return f"Malware found: {self.malware_message}"


class ScanningServiceException(Exception):
    """
    Exception raised when an error occurs while attempting
    """

    def __init__(self, scanner: BaseMalwareScanner, reason: str = None):
        self.scanner = scanner
        self.reason = reason
        super().__init__(self.reason)

    def __str__(self):
        error_message = f"Error scanning with: {self.scanner}"
        if self.reason:
            error_message += f"\n\tReason: {self.reason}"
        return error_message


__all__ = ["MalwareFoundException", "ScanningServiceException"]
