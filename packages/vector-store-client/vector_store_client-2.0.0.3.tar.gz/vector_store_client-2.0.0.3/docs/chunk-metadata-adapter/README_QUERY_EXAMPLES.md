# –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ChunkQuery

–≠—Ç–æ—Ç –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—É—é –º–æ—â—å —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ `ChunkQuery` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —á–∞–Ω–∫–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### 1. `query_examples.py` - –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å–Ω–æ–≤—ã —Ä–∞–±–æ—Ç—ã —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ (enum –ø–æ–ª—è)
- ‚úÖ –û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (>, <, >=, <=)
- ‚úÖ –î–∏–∞–ø–∞–∑–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã [min,max]
- ‚úÖ IN –∑–∞–ø—Ä–æ—Å—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-enum –ø–æ–ª–µ–π)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–ó–∞–ø—É—Å–∫**: `python -m chunk_metadata_adapter.query_examples`

### 2. `query_serialization_examples.py` - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- üîÑ –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (Redis, JSON, API)
- üèóÔ∏è –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ö° –ü–∞—Ç—Ç–µ—Ä–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- üõ°Ô∏è –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- üîß –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∏ –±–∏–ª–¥–µ—Ä-–ø–∞—Ç—Ç–µ—Ä–Ω

**–ó–∞–ø—É—Å–∫**: `python -m chunk_metadata_adapter.query_serialization_examples`

### 3. `query_business_examples.py` - –ë–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º (CMS)
- üîç –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞
- üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- üîé –ü–æ–∏—Å–∫ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- üßπ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–ó–∞–ø—É—Å–∫**: `python -m chunk_metadata_adapter.query_business_examples`

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### Enum –ø–æ–ª—è (–¢–û–õ–¨–ö–û —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ)
```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –æ–¥–∏–Ω–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
{"type": ChunkType.DOC_BLOCK.value}
{"status": ChunkStatus.RELIABLE.value}
{"language": LanguageEnum.PYTHON.value}

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ - IN –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è enum –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
{"type": "in:DocBlock,CodeBlock"}  # –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏!
```

**Enum –ø–æ–ª—è**: `type`, `status`, `language`, `role`, `block_type`

### –ß–∏—Å–ª–æ–≤—ã–µ –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤)
```python
# ‚úÖ –í—Å–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
{"quality_score": ">=0.8"}           # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
{"year": "[2020,2024]"}              # –î–∏–∞–ø–∞–∑–æ–Ω
{"category": "in:doc,tutorial,ref"}  # IN –∑–∞–ø—Ä–æ—Å
{"start": ">100"}                    # –ë–æ–ª—å—à–µ —á–µ–º
{"feedback_accepted": "<=5"}         # –ú–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ
```

## üìã –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
```python
# –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
query, errors = ChunkQuery.from_dict_with_validation(data)
if errors:
    print(f"–û—à–∏–±–∫–∏: {errors}")
    return None
```

### 2. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ enum –∑–Ω–∞—á–µ–Ω–∏—è
```python
# –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ enum –∑–Ω–∞—á–µ–Ω–∏—è
queries = []
for chunk_type in [ChunkType.DOC_BLOCK, ChunkType.CODE_BLOCK]:
    query, _ = ChunkQuery.from_dict_with_validation({
        "type": chunk_type.value,
        "quality_score": ">=0.8"
    })
    queries.append(query)
```

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```python
# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
optimal_query = {
    "project": "SpecificProject",     # –í—ã—Å–æ–∫–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    "type": ChunkType.DOC_BLOCK.value,  # –û–±—ã—á–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è
    "status": ChunkStatus.RELIABLE.value,  # –û–±—ã—á–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è
    "quality_score": ">=0.8"         # –î–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Å–ª–µ —Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
}
```

### 4. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
```python
# –î–ª—è Redis (—Å—Ç—Ä–æ–∫–∏)
flat_dict = query.to_flat_dict(for_redis=True)

# –î–ª—è API (JSON-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ)
json_dict = query.to_json_dict()

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
restored = ChunkQuery.from_flat_dict(flat_dict)
```

## üîç –ü—Ä–∏–º–µ—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ**: `quality_score >= 0.8`
- **–ù–µ–¥–∞–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç**: `year >= 2023`
- **–ü–æ–ø—É–ª—è—Ä–Ω—ã–π**: `feedback_accepted >= 10`
- **–ê–∫—Ç–∏–≤–Ω—ã–π**: `used_in_generation = True`

### –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞
- **–ü—Ä–æ–±–ª–µ–º–Ω—ã–π**: `quality_score < 0.5 AND feedback_rejected > 3`
- **–ù–µ–¥–æ–æ—Ü–µ–Ω–µ–Ω–Ω—ã–π**: `quality_score >= 0.8 AND used_in_generation = False`
- **–ü–ª–æ—Ö–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã**: `boundary_prev < 0.4 AND boundary_next < 0.4`

### –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ö–∞–Ω–¥–∏–¥–∞—Ç—ã**: `year < 2020 AND used_in_generation = False AND quality_score < 0.6`
- **–î—É–±–ª–∏**: `cohesion < 0.5 AND boundary_prev > 0.8`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **IN –∑–∞–ø—Ä–æ—Å—ã**: –†–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-enum –ø–æ–ª–µ–π
2. **Enum –ø–æ–ª—è**: –¢–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ–µ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ
3. **UUID –ø–æ–ª—è**: –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è UUIDv4
4. **–û–ø–µ—Ä–∞—Ç–æ—Ä—ã**: `>`, `<`, `>=`, `<=`, `[min,max]`, `in:val1,val2,val3`

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```python
from chunk_metadata_adapter.chunk_query import ChunkQuery
from chunk_metadata_adapter.data_types import ChunkType, ChunkStatus

# –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å
data = {
    "type": ChunkType.DOC_BLOCK.value,
    "quality_score": ">=0.8",
    "is_public": True
}

query, errors = ChunkQuery.from_dict_with_validation(data)
if errors is None:
    print(f"‚úÖ –ó–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω: {query.type}")
else:
    print(f"‚ùå –û—à–∏–±–∫–∏: {errors}")
```

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `chunk_query.py` - –û—Å–Ω–æ–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- `data_types.py` - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è enum
- `semantic_chunk.py` - –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
- `tests/test_*.py` - –¢–µ—Å—Ç—ã –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

**–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!** ‚úÖ 