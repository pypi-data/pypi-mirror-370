# Vector Store API Commands Documentation

This directory contains detailed metadata and documentation for all available commands in the Vector Store API.

## Overview

The Vector Store API provides a comprehensive set of commands for managing vector embeddings, performing semantic search, and maintaining the database. All commands use JSON-RPC 2.0 protocol.

## Available Commands

### Core Operations
- **config** - Manage service configuration
- **health** - Check service health status
- **help** - Get help information about commands
- **info** - Get detailed service information

### Chunk Management
- **chunk_create** - Create chunks with embeddings
- **chunk_delete** - Delete chunks by filters
- **chunk_hard_delete** - Physically remove chunks by UUIDs
- **chunk_deferred_cleanup** - Clean up deleted chunks

### Search and Retrieval
- **search** - Semantic search with vector embeddings
- **count** - Count chunks with filters

### Maintenance and Utilities
- **find_duplicate_uuids** - Find duplicate records
- **clean_faiss_orphans** - Clean orphaned FAISS records
- **reindex_missing_embeddings** - Regenerate missing embeddings
- **force_delete_by_uuids** - Force delete by UUIDs

## File Structure

Each command has its own JSON file containing:
- Command name and summary
- Detailed description
- Parameter specifications
- Required fields
- Usage examples

### Index File
- `index.json` - Complete overview of all commands and API endpoints

## API Endpoints

### JSON-RPC Endpoint
- **POST** `/cmd` - Execute any command via JSON-RPC 2.0

### REST Endpoints
- **GET** `/health` - Health check
- **GET** `/openapi.json` - OpenAPI schema
- **GET** `/api/commands` - List available commands

## Usage Examples

### Basic Command Execution
```bash
curl -X POST http://localhost:8007/cmd \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "health",
    "id": 1
  }'
```

### Creating Chunks
```bash
curl -X POST http://localhost:8007/cmd \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "chunk_create",
    "params": {
      "chunks": [
        {
          "body": "Sample text for testing",
          "type": "DocBlock",
          "language": "en"
        }
      ]
    },
    "id": 1
  }'
```

### Semantic Search
```bash
curl -X POST http://localhost:8007/cmd \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "search",
    "params": {
      "search_str": "machine learning",
      "limit": 5
    },
    "id": 1
  }'
```

## Command Categories

### Configuration Commands
- `config` - Service configuration management
- `health` - Health status monitoring
- `help` - Command documentation
- `info` - Service information

### Data Management Commands
- `chunk_create` - Create new chunks
- `chunk_delete` - Soft delete chunks
- `chunk_hard_delete` - Hard delete chunks
- `chunk_deferred_cleanup` - Cleanup operations

### Search Commands
- `search` - Semantic search functionality
- `count` - Count operations

### Maintenance Commands
- `find_duplicate_uuids` - Duplicate detection
- `clean_faiss_orphans` - Orphan cleanup
- `reindex_missing_embeddings` - Embedding regeneration
- `force_delete_by_uuids` - Force deletion

## Technical Details

### JSON-RPC Protocol
All commands use JSON-RPC 2.0 protocol with the following structure:
```json
{
  "jsonrpc": "2.0",
  "method": "command_name",
  "params": { ... },
  "id": 1
}
```

### Response Format
```json
{
  "jsonrpc": "2.0",
  "result": { ... },
  "id": 1
}
```

### Error Handling
```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32000,
    "message": "Error description"
  },
  "id": 1
}
```

## Vector Embeddings

The service uses 384-dimensional embeddings generated by the `sentence-transformers/all-MiniLM-L6-v2` model. All semantic search operations work with these embeddings.

## Metadata Filtering

Commands support advanced metadata filtering with operators:
- `$eq` - Equal
- `$in` - In array
- `$range` - Range query
- `$gte`, `$lte`, `$gt`, `$lt` - Comparison operators

## AST Filtering

Advanced filtering using Abstract Syntax Tree (AST) expressions with operators:
- `AND`, `OR`, `NOT` - Logical operators
- `=`, `!=`, `>`, `<`, `>=`, `<=` - Comparison operators
- Field-specific filtering

## Files in this Directory

- `index.json` - Complete command index and API overview
- `config.json` - Configuration management command
- `health.json` - Health check command
- `help.json` - Help system command
- `chunk_create.json` - Chunk creation command
- `chunk_delete.json` - Chunk deletion command
- `chunk_hard_delete.json` - Hard deletion command
- `chunk_deferred_cleanup.json` - Cleanup command
- `search.json` - Search command
- `find_duplicate_uuids.json` - Duplicate detection command
- `clean_faiss_orphans.json` - Orphan cleanup command
- `reindex_missing_embeddings.json` - Embedding regeneration command
- `force_delete_by_uuids.json` - Force deletion command
- `count.json` - Count command
- `info.json` - Information command
- `README.md` - This documentation file

## Related Documentation

- [API Reference](../api.md)
- [Technical Specification](../TECHNICAL_SPECIFICATION.md)
- [Development Guide](../development.md) 