<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="action_product_sticker" model="ir.actions.act_window">
        <field name="name">Product Stickers</field>
        <field name="res_model">product.sticker</field>
        <field name="view_mode">kanban,list,form</field>
    </record>
    <record id="product_sticker_form_view" model="ir.ui.view">
        <field name="name">product.sticker.form.view</field>
        <field name="model">product.sticker</field>
        <field name="arch" type="xml">
            <form string="Product Stickers">
                <sheet>
                    <group>
                        <group name="grp_data">
                            <field name="sequence" invisible="1" />
                            <label for="name" string="Name" colspan="2" />
                            <field
                                name="name"
                                placeholder="Name"
                                nolabel="1"
                                colspan="2"
                                class="h2 mb-5"
                            />
                            <field
                                name="available_model_ids"
                                options="{'no_create': True}"
                                widget="many2many_tags"
                            />
                            <field
                                name="company_id"
                                options="{'no_create': True}"
                                groups="base.group_multi_company"
                            />
                            <field
                                name="product_category_id"
                                options="{'no_create': True}"
                            />
                            <field
                                name="product_attribute_id"
                                options="{'no_create': True}"
                                groups="product.group_product_variant"
                            />
                            <field
                                name="product_attribute_value_id"
                                options="{'no_create': True}"
                                groups="product.group_product_variant"
                            />
                            <field name="image_size" />
                            <field name="show_sticker_note" widget="boolean_toggle" />
                            <field
                                name="note"
                                colspan="2"
                                nolabel="1"
                                invisible="not show_sticker_note"
                                placeholder="Sticker note that goes below image"
                            />
                        </group>
                        <group name="grp_image">
                            <label for="image_1920" string="Image" colspan="2" />
                            <field
                                name="image_1920"
                                widget="image"
                                nolabel="1"
                                colspan="2"
                            />
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record id="product_sticker_list_view" model="ir.ui.view">
        <field name="name">product.sticker.list.view</field>
        <field name="model">product.sticker</field>
        <field name="arch" type="xml">
            <list multi_edit="1">
                <field name="sequence" widget="handle" />
                <field name="name" />
                <field name="available_model_ids" widget="many2many_tags" />
                <field name="product_category_id" />
                <field
                    name="product_attribute_id"
                    groups="product.group_product_variant"
                />
                <field
                    name="product_attribute_value_id"
                    groups="product.group_product_variant"
                />
                <field name="image_size" optional="hide" />
                <field
                    name="company_id"
                    groups="base.group_multi_company"
                    optional="hide"
                />
                <field name="show_sticker_note" optional="hide" />
            </list>
        </field>
    </record>
    <record id="product_sticker_kanban_view" model="ir.ui.view">
        <field name="name">product.sticker.kanban.view</field>
        <field name="model">product.sticker</field>
        <field name="arch" type="xml">
            <kanban
                string="Product Stickers"
                default_order="sequence"
                group_create="false"
                quick_create="false"
            >
                <field name="id" />
                <field name="name" />
                <field name="image_1920" />
                <field name="product_attribute_id" />
                <field name="product_attribute_value_id" />
                <field name="available_model_ids" />
                <field name="sequence" widget="handle" />
                <field name="company_id" />
                <field name="show_sticker_note" />
                <templates>
                    <t t-name="menu">
                        <div>
                            <a
                                role="menuitem"
                                type="delete"
                                class="dropdown-item border-top-0"
                            >Delete</a>
                        </div>
                    </t>
                    <t t-name="card" class="flex-row">
                        <div class="d-flex w-100">
                            <aside class="o_kanban_aside_full">
                                <div
                                    class="o_kanban_image_fill position-relative w-100"
                                >
                                    <field
                                        name="image_128"
                                        widget="image"
                                        t-att-alt="record.name.value"
                                        class="h-100"
                                        options="{'img_class': 'object-fit-contain'}"
                                        invisible="not image_128"
                                    />
                                </div>
                            </aside>
                            <main class="ps-2 ps-md-0">
                                <div
                                    t-att-title="record.name.value"
                                    class="d-flex flex-column"
                                >
                                    <field
                                        name="company_id"
                                        invisible="not company_id"
                                    />
                                    <field name="name" class="fw-bold fs-5 mb-1" />
                                    <field name="available_model_ids" widget="list" />
                                </div>
                                <div class="o_kanban_record_body">
                                    <field name="available_model_ids" />
                                    <div
                                        t-if="record.product_category_id.value"
                                        class="d-block"
                                    >
                                        <strong>Category:</strong>
                                        <field name="product_category_id" />
                                    </div>
                                    <div
                                        t-if="record.product_attribute_id.value"
                                        groups="product.group_product_variant"
                                        class="d-block"
                                    >
                                        <strong>Attribute:</strong>
                                        <field name="product_attribute_id" />
                                        <span
                                            t-if="record.product_attribute_value_id.value"
                                        > / </span>
                                        <field name="product_attribute_value_id" />
                                    </div>
                                </div>
                            </main>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <record id="product_sticker_search_view" model="ir.ui.view">
        <field name="name">product.sticker.search.view</field>
        <field name="model">product.sticker</field>
        <field name="arch" type="xml">
            <search string="Product Stickers">
                <field name="name" />
                <field name="available_model_ids" />
                <field name="product_category_id" />
                <field name="image_size" />
                <field
                    name="product_attribute_id"
                    groups="product.group_product_variant"
                />
                <field
                    name="product_attribute_value_id"
                    groups="product.group_product_variant"
                />
                <separator />
                <filter
                    name="flt_not_company"
                    string="Cross Company"
                    domain="[('company_id', '=', False)]"
                />
                <separator />
                <filter
                    name="flt_not_product_category"
                    string="Cross Category"
                    domain="[('product_category_id', '=', False)]"
                />
                <separator />
                <filter
                    name="flt_not_product_attribute"
                    string="Cross Attribute"
                    domain="[('product_attribute_id', '=', False)]"
                    groups="product.group_product_variant"
                />
                <separator />
                <filter
                    name="flt_show_sticker_note_true"
                    string="Display Name with the Image"
                    domain="[('show_sticker_note', '=', True)]"
                />
                <group>
                    <filter
                        name="grp_available_models"
                        string="Available Models"
                        context="{'group_by': 'available_model_ids'}"
                    />
                    <filter
                        name="grp_company"
                        string="Company"
                        context="{'group_by': 'company_id'}"
                    />
                    <filter
                        name="grp_product_category"
                        string="Product Category"
                        context="{'group_by': 'product_category_id'}"
                    />
                    <filter
                        name="grp_product_attribute"
                        string="Product Attribute"
                        context="{'group_by': 'product_attribute_id'}"
                        groups="product.group_product_variant"
                    />
                    <filter
                        name="grp_product_attribute_value"
                        string="Product Attribute Value"
                        context="{'group_by': 'product_attribute_value_id'}"
                        groups="product.group_product_variant"
                    />
                </group>
            </search>
        </field>
    </record>
    <template id="report_sticker_template">
        <!-- Required parameters: stickers, position, extra_classes -->
        <t t-if="stickers">
            <div t-attf-class="col-12 #{extra_classes}">
                <t t-foreach="stickers" t-as="sticker">
                    <div
                        class="col-auto d-inline-block text-center align-top p-0 mt-3 mr-1"
                    >
                        <img
                            t-att-src="image_data_uri(sticker.get_image())"
                            t-att-alt="sticker.name"
                            class="m-auto d-block"
                        />
                        <span
                            t-if="sticker.show_sticker_note and sticker.note"
                            t-esc="sticker.note"
                            class="text-muted small"
                            style="white-space: pre;"
                        />
                    </div>
                </t>
            </div>
        </t>
    </template>
</odoo>
