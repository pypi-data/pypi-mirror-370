# GitHub Actions workflow for publishing to PyPI
#
# This workflow automatically publishes the friendli-gradio package to PyPI
# whenever changes are pushed to the main branch.
#
# Required setup:
# 1. Go to your repository Settings > Secrets and variables > Actions
# 2. Add a new repository secret named 'PYPI_API_TOKEN'
# 3. Set the value to your PyPI API token (get it from https://pypi.org/manage/account/token/)
#    The token should start with 'pypi-'
#
# The workflow will:
# - Check out the code
# - Set up Python 3.x
# - Install uv (modern Python package manager)
# - Build distribution artifacts with uv
# - Upload to PyPI using uv publish

name: Publish to PyPI

on:
  push:
    branches: [main]

jobs:
  publish:
    runs-on: ubuntu-latest

    steps:
      - name: Check out code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.x"

      - name: Install uv
        uses: astral-sh/setup-uv@v3
        with:
          version: "latest"

      - name: Build distribution artifacts
        run: uv build

      - name: Publish to PyPI
        run: uv publish
        env:
          UV_PUBLISH_TOKEN: ${{ secrets.PYPI_API_TOKEN }}
