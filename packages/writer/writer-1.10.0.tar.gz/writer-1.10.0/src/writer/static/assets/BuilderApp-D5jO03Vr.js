function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-B0j9NrKX.js","./index-B68VcF-V.css","./BuilderEmbeddedCodeEditor-xMfsf1zc.js","./BuilderEmbeddedCodeEditor-CXloIist.css","./BuilderSidebarToolkit-CXeE4Fmt.js","./WdsCheckbox-CZXSnv_W.js","./WdsCheckbox-DKvpPA4D.css","./marked.esm-273vDTCT.js","./BuilderSidebarToolkit-Ipk1HoMm.css","./BuilderSidebarComponentTree-CQDZgaj5.js","./useComponentDescription-Bd13VunY.js","./BuilderSidebarComponentTree-C5AMKQcR.css","./BuilderSettings-DuOk-ku4.js","./WdsDropdownMenu-CYpFVZJk.js","./WdsDropdownMenu-BT8vFJ33.css","./useKeyValueEditor-QjDZHrap.js","./useKeyValueEditor-CsemOh8D.css","./BuilderSettings-D60qd45-.css","./ComponentRenderer-C6llJgm8.js","./ComponentRenderer-72hqvEvI.css","./BuilderInsertionOverlay-COCl_f82.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-Ca4-ZVef.js","./BuilderInsertionLabel-_YS5WPfq.css","./BuilderVault-BlMa4y_O.js","./BuilderVault-Cx6oQSES.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as N,i as z,a as W,r as O,u as ve,c as k,o as t,f as c,g as u,x as w,y as q,A as Z,G as H,R as f,S as I,_ as V,T as Ie,w as te,b as P,z as M,U as ke,V as Ke,X as Be,Y as $t,Z as Ee,q as ce,$ as It,a0 as tt,a1 as at,a2 as nt,D as K,s as me,v as Se,t as R,m as de,a3 as ot,a4 as rt,a5 as xt,a6 as lt,W as J,a7 as Ce,K as xe,L as pe,a8 as ge,a9 as Xe,aa as re,ab as we,ac as Fe,ad as ze,ae as _e,af as Dt,ag as Pt,ah as qe,J as ee,E as ae,ai as At,aj as Tt,ak as Oe,al as ie,Q as se,am as it,an as st,ao as dt,ap as Lt,aq as Me,ar as Et,as as ut,at as De,au as Ft,av as Mt,aw as Nt,ax as Rt,ay as Vt,az as Ut,aA as He,aB as Wt,aC as zt,aD as qt,aE as Ot,p as Ht,aF as jt,H as Kt,aG as Zt,aH as Je}from"./index-B0j9NrKX.js";import{W as Gt}from"./WdsCheckbox-CZXSnv_W.js";import{marked as Yt}from"./marked.esm-273vDTCT.js";const Xt={class:"BuilderSwitcher"},Jt=N({__name:"BuilderSwitcher",setup(e){const r=z(W.core),a=z(W.builderManager);let o=O(null);const l=ve(r),d={ui:void 0,blueprints:void 0};function v(b){return b==="blueprints"||b==="ui"}function i(b){const m=a.mode.value;if(m!=b){switch(v(m)&&r.activePageId.value&&(d[m]=r.activePageId.value),o.value=b,b){case"ui":l.track("nav_ui_opened");break;case"preview":l.track("nav_preview_opened");break;case"blueprints":l.track("nav_blueprints_opened");break;case"vault":l.track("nav_vault_opened");break}a.mode.value=b,v(b)&&d[b]&&r.getComponentById(d[b])&&r.setActivePageId(d[b]),(b=="preview"||m=="blueprints"||b=="blueprints")&&a.setSelection(null)}}const C=k(()=>a.getMode());return(b,m)=>(t(),c("div",Xt,[u("button",{"data-automation-action":"set-mode-ui",class:H({active:C.value=="ui"}),type:"button",onClick:m[0]||(m[0]=_=>i("ui"))},[w(q,{name:"frame"}),m[4]||(m[4]=Z(" Interface "))],2),u("button",{"data-automation-action":"set-mode-blueprints",class:H({active:C.value=="blueprints"}),type:"button",onClick:m[1]||(m[1]=_=>i("blueprints"))},[w(q,{name:"wds-blueprints"}),m[5]||(m[5]=Z(" Blueprints "))],2),f(r).isWriterCloudApp.value?(t(),c("button",{key:0,class:H({active:C.value=="vault"}),"data-automation-action":"set-mode-vault",type:"button",onClick:m[2]||(m[2]=_=>i("vault"))},[w(q,{name:"key-round"}),m[6]||(m[6]=Z(" Vault "))],2)):I("",!0),u("button",{class:H({active:C.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:m[3]||(m[3]=_=>i("preview"))},[w(q,{name:"view"}),m[7]||(m[7]=Z(" Preview "))],2)]))}}),Qt=V(Jt,[["__scopeId","data-v-b47b97e5"]]),ea={class:"BuilderStateExplorer"},ta=N({__name:"BuilderStateExplorer",setup(e){const r=z(W.core);return(a,o)=>(t(),c("div",ea,[w(Ie,{data:f(r).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),aa=V(ta,[["__scopeId","data-v-45c6b03e"]]),na={key:0,class:"WdsStateDotState--cover"},oa=N({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){const r=e;let a;const o=O(!1);return te(()=>r.state,l=>{if(l!=="error"){o.value=!1,clearTimeout(a);return}a=setTimeout(()=>{o.value=!0},1e3)}),(l,d)=>(t(),c("div",{class:H(["WdsStateDotState",`WdsStateDotState--${e.state}`])},[e.state=="error"?(t(),c("div",na,[o.value?(t(),P(ke,{key:0,title:"Weâ€™re trying to reconnect...",size:"normal"},{default:M(()=>d[0]||(d[0]=[u("p",null," Connection was lost due to a network issue or an ongoing update. Please hang tight! ",-1)])),_:1})):I("",!0)])):I("",!0)],2))}}),ct=V(oa,[["__scopeId","data-v-408a2071"]]);function ra(e,r){let a;return()=>{a&&clearTimeout(a),a=setTimeout(e,r)}}function la(e){const r=Ke(),a=ve(e),o=tt(),{pushToast:l}=Be(),{writerApi:d,apiBaseUrl:v}=$t({signal:r.signal}),i=k(()=>e.getComponentById("root")),C=O(!1),b=Ee(),m=Ee(),_=ra(async()=>{e.isWriterCloudApp.value&&e.mode.value==="edit"&&!$.value&&d.updateApplicationMetadata(e.writerOrgId.value,e.writerAppId.value,{name:h.value}),await e.sendComponentUpdate()},1e3),h=k({get:()=>i.value.content.appName,set:S=>{i.value.content.appName!==S&&(i.value.content.appName=S,_())}});te(()=>i.value.content.appName,_),te(m,()=>{var F;const S=(F=m.value)==null?void 0:F.name;S!==void 0&&(h.value=S)});const n=k(()=>{var A,T;const S=(T=(A=m.value.writer)==null?void 0:A.teamIds)==null?void 0:T[0];if(!S)return;const F=`/organization/${e.writerOrgId.value}/team/${S}/framework/${e.writerAppId.value}`;return new URL(F,v)}),p=k(()=>{if(!(!e.writerOrgId.value||!e.writerAppId.value))return new URL(`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,v)}),$=k(()=>{var S;return(S=m.value)!=null&&S.lastDeployedAt?new Date(m.value.lastDeployedAt):void 0}),y=k(()=>!!(e.isWriterCloudApp.value&&m.value)),s=k(()=>{var S;return((S=m.value)==null?void 0:S.status)==="deployed"});te(e.writerApplication,B,{immediate:!0}),ce(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await B()},{signal:r.signal})});async function B(){if(e.writerApplication.value)try{m.value=await d.fetchApplicationDeployment(e.writerOrgId.value,e.writerAppId.value)}catch(S){o.error("Failed to fetch deployment information",S),m.value=void 0}}async function g(){if(e.writerApplication.value){if(!s.value){const S=`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,F=new URL(S,v);window.open(F,"_blank");return}C.value=!0,b.value=void 0;try{await d.publishApplication(e.writerOrgId.value,e.writerAppId.value,{applicationVersionId:m.value.applicationVersion.id,applicationVersionDataId:m.value.applicationVersionData.id}),await B();const S=n.value?{label:"See it live",func:()=>window.open(n.value,"_blank"),icon:"open_in_new"}:void 0;l({type:"success",message:"agent deployed",action:S}),a.track("deployment_succeeded")}catch(S){a.track("deployment_failed",{error:String(S)}),b.value=S,o.error("Deploy failed",S),l({type:"error",message:"deploy failed"})}finally{C.value=!1}}}return{name:h,canDeploy:y,writerDeployUrl:p,hasBeenPublished:s,publishApplication:g,isDeploying:It(C),lastDeployedAt:$}}const ia=["data-writer-tooltip"],sa=["src","alt"],da={key:1,class:"SharedWriterAvatar__initials"},ua=N({__name:"SharedWriterAvatar",props:{userId:{type:Number,required:!0},showTooltip:{type:Boolean,required:!1}},setup(e){const r=e,a=k(()=>r.userId),o=O(!1),{user:l,isLoading:d}=at(a),v=k(()=>{var m;return((m=l.value)==null?void 0:m.avatar)??""}),i=k(()=>{var m;return(((m=l.value)==null?void 0:m.firstName)??"?").at(0)}),C=k(()=>{if(!(!r.showTooltip||!l.value))return`${l.value.firstName??""} ${l.value.lastName??""}`}),b=k(()=>l.value?`Avatar of ${l.value.firstName??""} ${l.value.lastName??""}`:`Avatar of the user ID ${a.value}`);return(m,_)=>(t(),c("div",{class:"SharedWriterAvatar","data-writer-tooltip":C.value},[f(d)||v.value&&!o.value?(t(),P(nt,{key:0,class:"SharedWriterAvatar__loader"})):I("",!0),f(d)?I("",!0):(t(),c(K,{key:1},[v.value?me((t(),c("img",{key:0,src:v.value,alt:b.value,class:"SharedWriterAvatar__img",onLoad:_[0]||(_[0]=h=>o.value=!0)},null,40,sa)),[[Se,o.value]]):(t(),c("div",da,R(i.value),1))],64))],8,ia))}}),Ze=V(ua,[["__scopeId","data-v-d974552d"]]),ca=["data-writer-tooltip"],pa={key:0,class:"profile"},va={key:1,class:"profile"},ma=N({__name:"BuilderHeaderConnected",setup(e){const r=z(W.collaborationManager),a=k(()=>r.connectedProfiles.value.length),o=k(()=>{var d;return(d=r.connectedProfiles.value)==null?void 0:d[0]}),l=k(()=>"Also editing: "+r.connectedProfiles.value.map(v=>v.displayName).join(", "));return(d,v)=>a.value>0?(t(),c("div",{key:0,class:"BuilderHeaderConnected","data-writer-tooltip":l.value,"data-writer-tooltip-placement":"bottom"},[a.value==1?(t(),c("div",pa,[w(Ze,{"user-id":o.value.userId},null,8,["user-id"])])):I("",!0),a.value>1?(t(),c("div",va," +"+R(a.value),1)):I("",!0)],8,ca)):I("",!0)}}),fa=V(ma,[["__scopeId","data-v-a13cab91"]]),_a=N({__name:"BuilderHeaderMoreDropdown",setup(e){const r=[{label:"Import agent .zip file",value:"import",icon:"upload"},{label:"Download agent .zip file",value:"export",icon:"download"}],a=z(W.core),o=de("exportInput"),l=ve(a),d=Be(),v=O(!1),i=O(!1),C=O(!1),b=k(()=>[{disabled:v.value,desc:"Cancel",fn:()=>{C.value=!1,i.value=!1}},{disabled:v.value||!C.value,loading:v.value,desc:"Import",fn:_}]);async function m(){if(l.track("nav_export_clicked"),!o.value)return;const n=await fetch("./api/export");if(!n.ok)throw new Error("Failed to connect to export API");const p=await n.blob(),$=window.URL.createObjectURL(p),y=document.createElement("a");y.href=$,y.download="export.zip",document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL($)}async function _(){if(l.track("nav_import_clicked"),!o.value)return;const n=o.value.files[0];if(n){v.value=!0;try{const p=new FormData;if(p.append("file",n),!(await fetch("./api/import",{method:"POST",body:p})).ok)throw new Error("Failed to connect to import API");i.value=!1,d.pushToast({type:"success",message:"Project imported successfully."})}catch(p){d.pushToast({type:"error",message:"Failed to import the project: "+(p instanceof Error?p.message:String(p))})}finally{v.value=!1}}}async function h(n){if(n==="export")try{await m()}catch(p){d.pushToast({message:`Failed to export the project: ${p}`,type:"error"})}else n==="import"&&(o.value.value="",o.value.click())}return(n,p)=>(t(),c(K,null,[w(ot,{class:"BuilderHeaderMoreDropdown","trigger-variant":"secondary",options:r,onSelect:h}),me(u("input",{ref_key:"exportInput",ref:o,type:"file",accept:".zip,application/zip",onChange:p[0]||(p[0]=$=>i.value=!0)},null,544),[[Se,!1]]),i.value?(t(),P(ke,{key:0,actions:b.value,title:"Are you sure you want to continue?",description:"Your current work will be replaced with the agent in the zip file. This includes replacement of current pages, blueprints, local scripts, and custom assets.",size:"normal"},{default:M(()=>[w(Gt,{modelValue:C.value,"onUpdate:modelValue":p[1]||(p[1]=$=>C.value=$),label:"Yes, I want to replace the current agent with the imported file"},null,8,["modelValue"])]),_:1},8,["actions"])):I("",!0)],64))}}),ha=V(_a,[["__scopeId","data-v-ed946ab4"]]),ya={class:"BuilderHeader"},ga={class:"BuilderHeader__logo"},ba=["href"],wa={key:1,src:rt,alt:"Writer Framework logo"},ka=["disabled"],Ba={class:"BuilderHeader__toolbar"},Sa=N({__name:"BuilderHeader",setup(e){const r=z(W.core),a=O(!1),o=O(!1),l=ve(r),d=Be(),{canDeploy:v,isDeploying:i,publishApplication:C,hasBeenPublished:b,lastDeployedAt:m,writerDeployUrl:_,name:h}=la(r),n=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function p(){l.track("nav_deploy_clicked"),b.value?$.value=!0:await C()}const $=O(!1),y=[{desc:"Cancel",fn:()=>$.value=!1},{desc:"Yes, deploy changes",fn:async()=>{$.value=!1,await C()}}],s=k(()=>m.value?`Editor Last saved ${n.format(m.value)}`:void 0),B=k(()=>b.value===!0?"Deploy changes":(b.value===!1,"Configure deployment")),g=k(()=>{let D="";switch(r.syncHealth.value){case"offline":D+="Offline. Not syncing.";break;case"connected":D+="Online. Syncing...";break;case"idle":D+="Sync not initialised.";break;case"suspended":D+="Sync suspended.";break}return r.featureFlags.value.length>0&&(D+=` Feature flags: ${r.featureFlags.value.join(", ")}`),D}),S=k(()=>{switch(r.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});function F(){l.track("nav_state_explorer_opened"),a.value=!0}function A(){o.value=!0}async function T(){var x;const D=location.href;try{if((x=navigator.clipboard)!=null&&x.writeText)await navigator.clipboard.writeText(D);else{const U=document.createElement("textarea");U.value=D,U.style.position="fixed",U.style.opacity="0",document.body.appendChild(U),U.select(),document.execCommand("copy"),document.body.removeChild(U)}d.pushToast({type:"success",message:"Edit link copied to clipboard."})}catch{d.pushToast({type:"error",message:"Could not copy link."})}}return(D,x)=>(t(),c("div",ya,[u("div",ga,[f(_)?(t(),c("a",{key:0,href:f(_).toString(),target:"_blank",class:"BuilderHeader__goBack"},x[3]||(x[3]=[u("img",{src:rt,alt:"Writer Framework logo"},null,-1)]),8,ba)):(t(),c("img",wa)),x[4]||(x[4]=u("hr",null,null,-1)),f(r).isWriterCloudApp.value?me((t(),c("input",{key:2,"onUpdate:modelValue":x[0]||(x[0]=U=>lt(h)?h.value=U:null),type:"text",disabled:!!f(m),class:"BuilderHeader__logo__appTitle"},null,8,ka)),[[xt,f(h)]]):I("",!0)]),w(Qt,{class:"BuilderHeader__switcher"}),u("div",Ba,[x[6]||(x[6]=u("hr",null,null,-1)),w(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:F},{default:M(()=>[w(q,{name:"compass"})]),_:1}),w(J,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"Invite collaborators","data-writer-tooltip-placement":"bottom",onClick:A},{default:M(()=>[w(q,{name:"share-2"})]),_:1}),w(ha),f(v)?(t(),P(J,{key:0,size:"small",class:"BuilderHeader__toolbar__deployBtn",loading:f(i),"data-writer-tooltip":s.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:p},{default:M(()=>[Z(R(B.value)+" ",1),$.value?(t(),P(ke,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:y},{default:M(()=>x[5]||(x[5]=[u("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):I("",!0)]),_:1},8,["loading","data-writer-tooltip"])):I("",!0),w(fa),w(ct,{state:S.value,"data-writer-tooltip":g.value,"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),a.value?(t(),P(ke,{key:1,title:"State Explorer","display-close-button":"",onClose:x[1]||(x[1]=U=>a.value=!1)},{default:M(()=>[w(aa)]),_:1})):I("",!0),o.value?(t(),P(ke,{key:2,title:"Share edit link with collaborators",description:"All AI Studio builders in your org can edit this agent with you in real time. Copy the link below to point them directly to editing this agent.","display-close-button":"",actions:[{desc:"Close",fn:()=>o.value=!1},{desc:"Copy edit link",fn:()=>T(),icon:"clipboard"}],onClose:x[2]||(x[2]=U=>o.value=!1)},null,8,["actions"])):I("",!0)])]))}}),Ca=V(Sa,[["__scopeId","data-v-167c3d18"]]),$a={class:"text"},Ia=200,xa=4,Da=N({__name:"BuilderTooltip",setup(e){const r=de("rootEl"),a=O(!1),o=O(null);let l=null,d=null;const v=O("top"),i=O({top:0,left:0});async function C(){if(!l||(o.value=l.dataset.writerTooltip,!o.value))return;const n=l.dataset.writerTooltipGap?parseInt(l.dataset.writerTooltipGap):xa;if(a.value=b(l),!a.value)return;await pe();const{x:p,y:$,width:y,height:s}=l.getBoundingClientRect(),{width:B,height:g}=r.value.getBoundingClientRect();switch(v.value){case"top":i.value.top=$-g-n,i.value.left=p+y/2-B/2;break;case"right":i.value.top=$+s/2-g/2,i.value.left=p+y+n;break;case"left":i.value.left=p-B-n,i.value.top=$+s/2-g/2;break;case"bottom":i.value.top=$+s+n,i.value.left=p+y/2-B/2;break}}function b(n){return n.getAttribute("data-writer-tooltip-strategy")==="overflow"?n.scrollWidth>n.clientWidth:!0}function m(n){const $=n.target.closest("[data-writer-tooltip]");if($)l!==$&&(a.value=!1);else{a.value=!1,l=null;return}l=$,v.value=l.dataset.writerTooltipPlacement??"top",setTimeout(()=>_($),Ia)}async function _(n){n===l&&(d==null||d.disconnect(),d=new MutationObserver(C),d.observe(l,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),C())}const h=k(()=>{const{top:n,left:p}=i.value;return{top:`${n}px`,left:`${p}px`}});return ce(()=>{document.documentElement.addEventListener("mouseover",m)}),Ce(()=>{document.documentElement.removeEventListener("mouseover",m),d==null||d.disconnect()}),(n,p)=>me((t(),c("div",{ref_key:"rootEl",ref:r,class:"BuilderTooltip",style:xe(h.value)},[u("div",{class:H(["arrow",v.value])},null,2),u("div",$a,R(o.value),1)],4)),[[Se,a.value]])}}),Pa=V(Da,[["__scopeId","data-v-7ba01c7c"]]),Aa=""+new URL("art-paper-WsD9P5Lu.svg",import.meta.url).href,Ta="data:image/svg+xml,%3csvg%20width='120'%20height='160'%20viewBox='0%200%20120%20160'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='16.0273'%20y='89.9375'%20width='80.1422'%20height='55.209'%20rx='7.12375'%20fill='%23A95EF8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M47.9297%20135.352H13.3542C9.41988%20135.352%206.23047%20138.541%206.23047%20142.475V152.27C6.23047%20156.205%209.41987%20159.394%2013.3542%20159.394H97.9487C101.883%20159.394%20105.072%20156.205%20105.072%20152.27V142.475C105.072%20138.541%20101.883%20135.352%2097.9487%20135.352H63.3737C63.3737%20136.103%2063.174%20136.848%2062.7859%20137.542C62.3979%20138.237%2061.8291%20138.868%2061.112%20139.399C60.395%20139.931%2059.5437%20140.352%2058.6068%20140.64C57.6699%20140.928%2056.6658%20141.076%2055.6517%20141.076C54.6376%20141.076%2053.6335%20140.928%2052.6966%20140.64C51.7597%20140.352%2050.9085%20139.931%2050.1914%20139.399C49.4744%20138.868%2048.9056%20138.237%2048.5175%20137.542C48.1295%20136.848%2047.9297%20136.103%2047.9297%20135.352Z'%20fill='%23721CC9'/%3e%3crect%20x='27.6055'%20y='103.295'%20width='56.99'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='38.293'%20y='112.199'%20width='35.6187'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='46.3047'%20y='121.104'%20width='19.5903'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20y='10.3691'%20width='40.0647'%20height='30.0485'%20rx='7.12375'%20transform='rotate(-15%200%2010.3691)'%20fill='%23EDE2FF'/%3e%3cpath%20d='M15.0475%2021.5308C15.2249%2020.8687%2016.0526%2020.6469%2016.5373%2021.1316L21.9902%2026.5846C22.475%2027.0693%2022.2532%2027.897%2021.5911%2028.0744L14.1421%2030.0703C13.48%2030.2477%2012.8741%2029.6418%2013.0515%2028.9797L15.0475%2021.5308Z'%20fill='%23D4B2F7'/%3e%3cpath%20d='M25.3727%2010.4659C25.5501%209.80376%2026.3777%209.58199%2026.8624%2010.0667L34.9516%2018.1559C35.4363%2018.6406%2035.2145%2019.4682%2034.5524%2019.6456L23.5024%2022.6065C22.8403%2022.7839%2022.2344%2022.178%2022.4118%2021.5159L25.3727%2010.4659Z'%20fill='%23D4B2F7'/%3e%3crect%20x='68.2383'%20y='23.1523'%20width='54.3186'%20height='40.0711'%20rx='7.12375'%20transform='rotate(17.6282%2068.2383%2023.1523)'%20fill='%23D4B2F7'/%3e%3cpath%20d='M72.1976%2052.7145C71.7609%2052.9406%2071.5902%2053.4779%2071.8163%2053.9146C72.0424%2054.3514%2072.5797%2054.5221%2073.0164%2054.296L72.1976%2052.7145ZM82.1128%2048.5839L82.8321%2048.059L82.3818%2047.4419L81.7034%2047.7931L82.1128%2048.5839ZM86.9945%2055.274L86.2752%2055.7989L86.71%2056.3948L87.3764%2056.0784L86.9945%2055.274ZM104.339%2047.7366C104.504%2047.2733%20104.262%2046.764%20103.798%2046.599L96.2487%2043.9102C95.7854%2043.7452%2095.2761%2043.987%2095.1111%2044.4503C94.9461%2044.9136%2095.1879%2045.4229%2095.6512%2045.5879L102.362%2047.9779L99.972%2054.6888C99.807%2055.1521%20100.049%2055.6614%20100.512%2055.8264C100.975%2055.9914%20101.485%2055.7496%20101.65%2055.2863L104.339%2047.7366ZM73.0164%2054.296L82.5222%2049.3746L81.7034%2047.7931L72.1976%2052.7145L73.0164%2054.296ZM81.3935%2049.1087L86.2752%2055.7989L87.7138%2054.7491L82.8321%2048.059L81.3935%2049.1087ZM87.3764%2056.0784L103.882%2048.2423L103.118%2046.6334L86.6126%2054.4696L87.3764%2056.0784Z'%20fill='%23F6EFFD'/%3e%3c/svg%3e",je=150;function La(e){const r=O(structuredClone(ge(e.sourceFiles.value)));te(e.sourceFiles,(s,B)=>{let g=!1,S=structuredClone(ge(r.value));const F=v(B).map(a);for(const A of Xe(s)){const T=re(A,B),D=re(A,s);if(we(D))continue;if(T===void 0||Fe(D)){S=ze(A,S,structuredClone(ge(D))),g=!0;continue}if(!_e(T))continue;const x=!T.complete&&D.complete,U=T.complete&&D.complete;if(!x&&!U)continue;const ue=a(A);if(F.includes(ue))continue;const Y=re(A,S);_e(Y)&&(g=!0,Y.complete=!0,Y.content=D.content)}for(const A of Dt(S))re(A,s)===void 0&&(S=Pt(A,S),g=!0);g&&(r.value=S)});function a(s){return s.join("/")}const o=Ee(),l=k(()=>Array.from(Xe(r.value))),d=k(()=>v(e.sourceFiles.value));function v(s){return l.value.filter(B=>{const g=re(B,r.value);if(Fe(g))return!1;if(!_e(g))return!0;const S=re(B,s);return _e(S)?!g.complete||!S.complete?!1:g.content!==S.content:!0})}const i=k(()=>{if(o.value!==void 0)return re(o.value,r.value)}),C=k({get(){return _e(i.value)?i.value.content:""},set(s){if(o.value===void 0)return;const B=re(o.value,r.value);_e(B)&&(B.content=s)}});function b(s=1){const B=`new-file-${s}.txt`;return re([B],r.value)?b(s+1):B}async function m(){const s=b();r.value=ze([s],ge(r.value)),n([s]),await e.sendCreateSourceFileRequest([s])}const _=k(()=>{var B;return(B=o.value)!=null&&B.length?o.value.at(-1).split(".").at(-1):""}),h=k(()=>{switch(_.value){case"py":return"python";case"js":case"mjs":return"javascript";case"ts":return"typescript";case"md":case"markdown":return"markdown";default:return _.value}});function n(s){o.value=s,_e(i.value)&&!i.value.complete&&e.requestSourceFileLoading(s)}async function p(s){if(!(!o.value||!i.value)&&(i.value.type==="file"&&await e.sendCodeSaveRequest(C.value,o.value),s)){const B=[...ge(o.value)];o.value=void 0;try{await e.sendRenameSourceFileRequest(B,s)}catch(g){throw o.value=B,g}n(s)}}function $(s){return new Promise((B,g)=>{const S=new FileReader;S.addEventListener("loadend",F=>{const A=F.target.result;if(A instanceof ArrayBuffer){const T=String.fromCharCode.apply(null,new Uint8Array(A));return B(T)}B(A.split(",")[1])}),S.addEventListener("error",()=>{g()}),S.readAsDataURL(s)})}async function y(s){const B=je*1024*1024;if(s.size>B)throw Error(`Cannot upload file bigger than ${je}mb`);const g=[s.name];if(re(g,e.sourceFiles.value))throw Error(`The file ${s.name} already exists`);r.value=ze(g,ge(r.value),{type:"binary",uploading:!0});const S=await $(s);await e.sendFileUploadRequest(g,S)}return{code:C,sourceFileDraft:r,fileOpen:i,filepathOpen:o,pathsUnsaved:d,openedFileLanguage:h,save:p,upload:y,openFile:n,openNewFile:m,getNewFilename:b}}const Ea={class:"BuilderDropFileZone"},Fa=N({__name:"BuilderDropFileZone",setup(e){return(r,a)=>(t(),c("div",Ea,[a[0]||(a[0]=u("img",{src:Ta,alt:"Drop file illustration"},null,-1)),a[1]||(a[1]=u("h2",null,"Upload files",-1)),u("p",null,"Files can be up to "+R(f(je))+"mb",1)]))}}),Ma=V(Fa,[["__scopeId","data-v-92e0a561"]]),Na={class:"BuilderPanel__collapser"},Ra={class:"BuilderPanel__title"},Va={class:"BuilderPanel__titleCompanion"},Ua=["data-order"],Wa={key:0,class:"BuilderPanel__contents__leftPanel"},za={class:"BuilderPanel__actions"},qa={class:"BuilderPanel__actionsCompanion"},Oa=N({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{expose:r,emit:a}){const o=z(W.builderManager),l=["code","log"],d=e,v=a,i=de("mainContents");r({mainContents:i});const C=k(()=>d.enableDropFile&&b.value),b=O(!1);function m(s,B){d.enableDropFile&&(s.preventDefault(),b.value=B)}function _(s){if(b.value=!1,!d.enableDropFile)return;s.preventDefault();const B=[];if(s.dataTransfer.items)for(const g of s.dataTransfer.items){if(g.kind!=="file")continue;const S=g.getAsFile();S&&B.push(S)}else for(const g of s.dataTransfer.files)B.push(g);B.length>0&&v("filesDrop",B)}const h=k(()=>!o.openPanels.value.has(d.panelId)),n=k(()=>l.indexOf(d.panelId));function p(s){if(o.openPanels.value.has(s)){o.openPanels.value.delete(s),v("openned",!1);return}o.openPanels.value.add(s),v("openned",!0)}function $(s){const B=Tt(s);if(B&&s.key==d.keyboardShortcutKey.toLowerCase()){s.preventDefault(),p(d.panelId);return}d.actions.forEach(g=>{if(!g.keyboardShortcut)return;const{key:S,modifierKey:F}=g.keyboardShortcut;S.toLowerCase()==s.key&&(!B&&F||(s.preventDefault(),g.callback()))})}function y(s){if(!s)return"";let B=" (";return s.modifierKey&&(B+=qe()),B+=s.key,B+=")",B}return ce(async()=>{document.addEventListener("keydown",$)}),Ce(()=>{document.removeEventListener("keydown",$)}),(s,B)=>(t(),c("div",{class:H(["BuilderPanel",{collapsed:h.value}])},[u("div",Na,[w(J,{variant:"neutral",size:"small","data-automation-action":"toggle-panel","data-automation-key":s.panelId,"data-writer-tooltip":`Toggle ${s.name} (${f(qe)()}${s.keyboardShortcutKey})`,onClick:B[0]||(B[0]=g=>p(s.panelId))},{default:M(()=>[w(q,{name:h.value?"chevron-right":"chevron-up"},null,8,["name"]),u("span",Ra,R(s.name),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),u("div",Va,[ee(s.$slots,"titleCompanion",{},void 0,!0)]),h.value?I("",!0):(t(),P(At,{key:0,to:s.contentsTeleportEl},[u("div",{style:xe({order:n.value}),"data-order":n.value,class:H(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":s.enableLeftPanel,"BuilderPanel__contents--dropingFile":C.value}]),onDrop:_,onDragover:B[1]||(B[1]=g=>m(g,!0)),onDragleave:B[2]||(B[2]=g=>m(g,!1))},[C.value?(t(),P(Ma,{key:0})):(t(),c(K,{key:1},[s.enableLeftPanel?(t(),c("div",Wa,[ee(s.$slots,"leftPanel",{},void 0,!0)])):I("",!0),u("div",za,[u("div",qa,[ee(s.$slots,"actionsCompanion",{},void 0,!0)]),(t(!0),c(K,null,ae(s.actions,(g,S)=>(t(),P(J,{key:S,"data-writer-tooltip":g.name+y(g.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:g.isDisabled,onClick:g.callback},{default:M(()=>[w(q,{name:g.icon},null,8,["name"])]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),u("div",{ref_key:"mainContents",ref:i,class:"BuilderPanel__mainContents"},[ee(s.$slots,"default",{},void 0,!0)],512)],64))],46,Ua)],8,["to"]))],2))}}),pt=V(Oa,[["__scopeId","data-v-5918244c"]]),Ha={class:"BuilderTree"},ja=["draggable","data-automation-key","aria-expanded"],Ka=["data-writer-tooltip"],Za={key:1,class:"BuilderTree__main__dropdown"},Ga=N({__name:"BuilderTree",props:Oe({name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:void 0},noNestedSpace:{type:Boolean,required:!1},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0},disableCollapse:{type:Boolean,required:!1}},{collapsed:{type:Boolean,required:!1,default:!1},collapsedModifiers:{}}),emits:Oe({expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},["update:collapsed"]),setup(e,{expose:r,emit:a}){const o=ie({loader:()=>se(()=>import("./index-B0j9NrKX.js").then(h=>h.bm),__vite__mapDeps([0,1]),import.meta.url)}),l=e,d=a;r({expand:m,toggleCollapse:_});const v=it(e,"collapsed"),i=O(!1),C=k(()=>!l.matched),b=k(()=>!l.hasChildren);function m(){v.value=!1,d("expandBranch")}function _(h){h??(h=!v.value),h!==v.value&&(v.value=h)}return(h,n)=>(t(),c("div",Ha,[u("div",{class:H(["BuilderTree__main",{selected:e.selected,notMatched:C.value,childless:b.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!v.value,onMouseenter:n[2]||(n[2]=p=>i.value=!0),onMouseleave:n[3]||(n[3]=p=>i.value=!1),onClick:n[4]||(n[4]=p=>h.$emit("select",p)),onKeydown:n[5]||(n[5]=dt(p=>h.$emit("select",p),["enter"])),onDragover:n[6]||(n[6]=p=>h.$emit("dragover",p)),onDragstart:n[7]||(n[7]=p=>h.$emit("dragstart",p)),onDragend:n[8]||(n[8]=p=>h.$emit("dragend",p)),onDrop:n[9]||(n[9]=p=>h.$emit("drop",p))},[e.hasChildren&&!e.disableCollapse?(t(),P(J,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:n[0]||(n[0]=st(p=>_(void 0),["stop"]))},{default:M(()=>[w(q,{name:v.value?"chevron-down":"chevron-up"},null,8,["name"])]),_:1},8,["disabled"])):I("",!0),ee(h.$slots,"nameLeft",{},void 0,!0),u("span",{class:H(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled,"BuilderTree__main__name--root":e.variant==="root"}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},R(e.name),11,Ka),ee(h.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&i.value?(t(),c("div",Za,[w(f(o),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:n[1]||(n[1]=p=>h.$emit("dropdownSelect",p))},null,8,["options"])])):I("",!0)],42,ja),w(Lt,null,{default:M(()=>[me(u("div",{class:H(["BuilderTree__children",{"BuilderTree__children--noNestedSpace":e.noNestedSpace}])},[ee(h.$slots,"children",{},void 0,!0)],2),[[Se,!v.value&&e.hasChildren]])]),_:3})]))}}),Ya=V(Ga,[["__scopeId","data-v-8c085d0a"]]),Xa=["width","height","viewBox","aria-valuenow"],Ja=["r","cx","cy","stroke","stroke-width"],Qa=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],en=N({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const r=e,a=k(()=>r.sizePx/2),o=k(()=>r.sizePx/2-r.strokeWidth/2),l=k(()=>2*Math.PI*o.value),d=k(()=>l.value*((100-r.progress)/100)),v=k(()=>`0 0 ${r.sizePx} ${r.sizePx}`);return(i,C)=>(t(),c("svg",{width:e.sizePx,height:e.sizePx,viewBox:v.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[u("circle",{r:o.value,cx:a.value,cy:a.value,fill:"transparent",stroke:f(Me).Blue1,"stroke-width":e.strokeWidth},null,8,Ja),u("circle",{r:o.value,cx:a.value,cy:a.value,fill:"transparent",stroke:f(Me).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":l.value,"stroke-dashoffset":d.value},null,8,Qa)],8,Xa))}}),tn=N({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const r=e,a=O(0);return ce(()=>{let o;const l=d=>{o||(o=d);const v=d-o;a.value=Math.min(v/r.timeMs*100,100),a.value<100&&requestAnimationFrame(l)};requestAnimationFrame(l)}),(o,l)=>(t(),P(en,{class:"BuilderCodePanelFileUploading",progress:a.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),an=V(tn,[["__scopeId","data-v-449f2dac"]]),Qe=[{label:"Delete",value:"delete",icon:"trash-2"}],nn=N({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:r}){const a=e,o=r;function l(n){return n.join("/")}const d=k(()=>l(a.pathActive)),v=k(()=>a.pathsUnsaved.map(l)),i=k(()=>we(a.sourceFiles)?Object.entries(a.sourceFiles.children).sort((n,p)=>n[0].localeCompare(p[0])):[]);function C(n){const p=re([...a.path,n],a.sourceFiles);return Fe(p)&&p.uploading}function b(n){const p=l([...a.path,n]);return v.value.includes(p)}function m(n){return l([...a.path,n])===d.value}function _(n){if(!we(a.sourceFiles)||C(n))return;const p=a.sourceFiles.children[n];we(p)||o("select",[...a.path,n])}function h(n,p){n==="delete"&&o("delete",[...a.path,p])}return(n,p)=>(t(),c("div",null,[(t(!0),c(K,null,ae(i.value,([$,y])=>(t(),P(Ya,{key:$,name:$,matched:"","has-children":f(we)(y),selected:m($),disabled:C($),"right-click-options":Qe,"dropdown-options":f(we)(y)||f(Fe)(y)?Qe:void 0,onSelect:s=>_($),onDropdownSelect:s=>h(s,$)},Et({children:M(()=>[w(vt,{"source-files":y,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,$],onSelect:p[0]||(p[0]=s=>n.$emit("select",s)),onDelete:p[1]||(p[1]=s=>n.$emit("delete",s))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[C($)||b($)?{name:"nameLeft",fn:M(()=>[C($)?(t(),P(an,{key:0,"time-ms":2e3})):b($)?(t(),P(ct,{key:1,state:"newDraft"})):I("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),vt=V(nn,[["__scopeId","data-v-13c86c55"]]),on=["disabled"],rn={class:"WdsButtonLink__text"},ln=N({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disabled:{type:Boolean}},setup(e){const r=e,a=k(()=>[`WdsButtonLink--variant-${r.variant}`,`WdsButtonLink--weight-${r.weight}`]);return(o,l)=>(t(),c("button",{class:H(["WdsButtonLink",a.value]),disabled:e.disabled,type:"button"},[e.leftIcon?(t(),P(q,{key:0,name:e.leftIcon},null,8,["name"])):I("",!0),u("span",rn,R(e.text),1),e.rightIcon?(t(),P(q,{key:1,name:e.rightIcon},null,8,["name"])):I("",!0)],10,on))}}),mt=V(ln,[["__scopeId","data-v-f2cbc67f"]]),sn={class:"BuilderCodePanelFileUploadBtn"},dn=N({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:r}){const a=de("input"),o=r;function l(){var d;(d=a.value.files)!=null&&d.length&&o("selected",a.value.files)}return(d,v)=>(t(),c("form",sn,[me(u("input",{ref_key:"input",ref:a,type:"file",multiple:"true",onChange:l},null,544),[[Se,!1]]),w(mt,{"left-icon":"upload",text:"Upload",onClick:v[0]||(v[0]=i=>f(a).click())})]))}}),un={class:"BuilderCodePanel__tree"},cn={class:"BuilderCodePanel__tree__actions"},pn={key:1,class:"BuilderCodePanel__noPreview"},vn={class:"BuilderCodePanel__actionsCompanion"},mn=N({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const r=ie({loader:()=>se(()=>import("./index-B0j9NrKX.js").then(E=>E.bm),__vite__mapDeps([0,1]),import.meta.url)}),a=ie({loader:()=>se(()=>import("./BuilderEmbeddedCodeEditor-xMfsf1zc.js").then(E=>E.B),__vite__mapDeps([2,0,1,3]),import.meta.url)}),o=z(W.core),l=[{label:"Rename file",value:"rename",icon:"pencil"},{label:"Delete file",value:"delete",icon:"trash-2",variant:"danger"}],d=ve(o),{sourceFileDraft:v,openFile:i,upload:C,openNewFile:b,code:m,openedFileLanguage:_,filepathOpen:h,fileOpen:n,pathsUnsaved:p,save:$}=La(o);async function y(E){await Promise.all([...E].map(s))}async function s(E){try{await C(E),g({type:"success",message:`File ${E.name} uploaded`})}catch(G){g({type:"error",message:G.message})}}const B=k(()=>{var E;return(E=n.value)==null?void 0:E.type}),{pushToast:g}=Be(),S=tt();function F(E){const G=new AbortController;ce(()=>{document.addEventListener("keydown",async ne=>{const Ve=ne.metaKey||ne.ctrlKey,Ue=ne.key==="s"||ne.key==="S";!Ve||!Ue||(ne.preventDefault(),await E())},{signal:G.signal})}),Ce(()=>G.abort())}F($e);const A=de("filenameEl"),T=O(""),D=O(!1),x=k(()=>{var E;return((E=h.value)==null?void 0:E.join("/"))??""}),U=k(()=>x.value!=="main.py"),ue=k(()=>x.value!==T.value),Y=k(()=>D.value||x.value==="main.py"),le=k(()=>ue.value?!1:h.value===void 0?!0:!p.value.map(E=>E.join("/")).includes(x.value));te(h,()=>{var E;T.value=((E=h.value)==null?void 0:E.join("/"))??""}),te(o.sessionTimestamp,()=>{D.value=!1});function he(E){E&&(d.track("nav_code_opened"),h.value===void 0&&i(["main.py"]))}async function Pe(){var E;x.value!=="main.py"&&(await pe(),(E=A.value)==null||E.focus())}async function Ne(E){switch(E){case"rename":return Pe();case"delete":await Te(h.value)}}async function Ae(){await b(),Pe()}async function Te(E){await o.sendDeleteSourceFileRequest(E),g({type:"success",message:"The file was deleted"}),h.value.join("/").startsWith(E.join("/"))&&i(["main.py"])}async function $e(){if(h.value===void 0)return g({type:"error",message:"There is no file open"});if(le.value)return g({type:"info",message:"There are not file changes to save"});D.value=!0;const E=ue.value?T.value.split("/"):void 0;if(E){const G=Re(E);if(G)return g({type:"error",message:G})}try{await $(E),g({type:"success",message:"The file was saved"}),d.track("nav_code_file_updated",{path:h.value})}catch(G){S.error("The file hasn't been saved.",G),g({type:"error",message:"The file hasn't been saved"});return}finally{D.value=!1}}function Re(E){return E[0]===""?"Path should not have a leading slash":E[0]===".wf"?".wf is reserved for Writer Framework":E.some(G=>G==="")?"Invalid path":null}return(E,G)=>(t(),P(pt,{"panel-id":"code",name:"Code","contents-teleport-el":E.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"",onFilesDrop:y,onOpenned:he},{leftPanel:M(()=>[u("div",un,[w(vt,{"path-active":f(h),"paths-unsaved":f(p),"source-files":f(v),onAddFile:Ae,onSelect:f(i),onDelete:Te},null,8,["path-active","paths-unsaved","source-files","onSelect"]),u("div",cn,[w(mt,{"left-icon":"plus",text:"Add file",onClick:Ae}),w(dn,{onSelected:y})])])]),actionsCompanion:M(()=>[u("div",vn,[w(ut,{ref_key:"filenameEl",ref:A,modelValue:T.value,"onUpdate:modelValue":G[1]||(G[1]=ne=>T.value=ne),disabled:!U.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:dt($e,["enter"])},null,8,["modelValue","disabled"]),w(J,{variant:"primary",size:"small",disabled:D.value||le.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:$e},{default:M(()=>[w(q,{name:"save"}),G[3]||(G[3]=Z(" Save file "))]),_:1},8,["disabled"]),w(f(r),{disabled:Y.value,options:l,onSelect:Ne},null,8,["disabled"])])]),default:M(()=>[B.value==="file"?(t(),P(f(a),{key:0,modelValue:f(m),"onUpdate:modelValue":G[0]||(G[0]=ne=>lt(m)?m.value=ne:null),variant:"full",language:f(_),disabled:D.value},null,8,["modelValue","language","disabled"])):I("",!0),B.value==="binary"?(t(),c("div",pn,G[2]||(G[2]=[u("img",{class:"BuilderCodePanel__noPreview__img",src:Aa},null,-1),u("p",{class:"BuilderCodePanel__noPreview__title"},"Canâ€™t Preview File",-1),u("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):I("",!0)]),_:1},8,["contents-teleport-el"]))}}),fn=V(mn,[["__scopeId","data-v-ba25cf98"]]),_n={class:"BuiderLogBlueprintExecutionTrace"},hn={key:0,class:"trace"},yn={class:"type"},gn={key:0},bn={key:1},wn={class:"main"},kn={key:0},Bn={key:1},Sn={key:2},Cn={key:3},$n={class:"details"},In={class:"data","data-automation-key":"result"},xn={key:1,class:"nothing"},Dn={class:"data","data-automation-key":"return-value"},Pn={class:"environment"},An={class:"data"},Tn={key:1,class:"nothing"},Ln={class:"callStack"},En={class:"eyebrow"},Fn=N({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:r}){const a=z(W.core),o=z(W.builderManager),l=ve(a),d=r,{goToComponentParentPage:v}=De(a,o),i=e,C=k(()=>{var h;const _=((h=i.executionItem.executionEnvironment)==null?void 0:h.call_stack)??[];return Object.fromEntries(_.map(n=>[n,a.getComponentById(n)]))}),b=k(()=>{var _;return((_=i.executionItem.executionEnvironment)==null?void 0:_.trace)??[]});ce(()=>{l.track("blueprints_logs_trace_opened")});async function m(_){d("closeModal"),o.setMode("blueprints"),await pe(),v(_),await pe(),o.setSelection(_,void 0,"log")}return(_,h)=>{var n,p,$;return t(),c("div",_n,[b.value.length>0?(t(),c("div",hn,[(t(!0),c(K,null,ae(b.value,(y,s)=>(t(),c("div",{key:s,class:"traceEntry"},[u("div",yn,[y.type=="functionCall"?(t(),c("span",gn,"âš¡ï¸")):I("",!0),y.type=="reasoning"?(t(),c("span",bn,"ðŸ§ ")):I("",!0)]),u("div",wn,[y.thought?(t(),c("div",kn,[h[0]||(h[0]=u("strong",null,"Thought.",-1)),Z(" "+R(y.thought),1)])):I("",!0),y.action?(t(),c("div",Bn,[h[1]||(h[1]=u("strong",null,"Action.",-1)),Z(" "+R(y.action),1)])):I("",!0),y.name?(t(),c("div",Sn,R(y.name),1)):I("",!0),y.parameters?(t(),c("div",Cn,[w(Ie,{"hide-root":!0,data:y.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):I("",!0)])]))),128))])):I("",!0),u("div",$n,[u("div",null,[h[2]||(h[2]=u("h3",null,"Result",-1)),h[3]||(h[3]=u("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),u("div",In,[(n=_.executionItem)!=null&&n.result?(t(),P(Ie,{key:0,data:_.executionItem.result,"initial-depth":1},null,8,["data"])):(t(),c("div",xn,"No result."))])]),u("div",null,[h[4]||(h[4]=u("h3",null,"Return value",-1)),h[5]||(h[5]=u("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),u("div",Dn,[(p=_.executionItem)!=null&&p.returnValue?(t(),P(Ie,{key:0,data:_.executionItem.returnValue,"initial-depth":1},null,8,["data"])):(t(),c(K,{key:1},[Z(" No return value. ")],64))])])]),u("div",Pn,[h[6]||(h[6]=u("h3",null,"Execution environment",-1)),h[7]||(h[7]=u("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),u("div",An,[($=_.executionItem)!=null&&$.executionEnvironment?(t(),P(Ie,{key:0,data:_.executionItem.executionEnvironment,"initial-depth":1},null,8,["data"])):(t(),c("div",Tn,"Empty execution environment."))])]),u("div",Ln,[h[8]||(h[8]=u("h3",null,"Call stack",-1)),(t(!0),c(K,null,ae(C.value,(y,s)=>{var B,g,S;return t(),c("div",{key:s,class:H(["component",{active:s==_.executionItem.componentId}])},[u("div",null,[u("div",En,[s==_.executionItem.componentId?(t(),c(K,{key:0},[Z(" This block Â· ")],64)):I("",!0),Z(" "+R(((B=f(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:B.name)??"Unavailable component")+" Â· Id: "+R(s),1)]),Z(" "+R(((g=y==null?void 0:y.content)==null?void 0:g.alias)??((S=f(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:S.name)??"Unavailable component"),1)]),y?(t(),P(J,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:F=>m(s)},{default:M(()=>[w(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):I("",!0)],2)}),128))])])}}}),Mn=V(Fn,[["__scopeId","data-v-f98f57c8"]]),Nn={class:"BuilderListItem"},Rn=["viewBox"],Vn=["d","stroke"],Un=["d","stroke"],Wn={class:"BuilderListItem__content"},zn=N({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:Me.Blue2},colorLast:{type:String,required:!1,default:Me.Blue2}},setup(e){const r=e,a=k(()=>r.height/2),o=k(()=>`0 0 17 ${r.height}`),l=k(()=>["M1 0",`V${a.value-8}`,`C1 ${a.value-4}.4183 4.58172 ${a.value} 9 ${a.value}`,"H17"].join(" ")),d=k(()=>[`M1 ${a.value-8}`,`V${r.height}`].join(" "));return(v,i)=>(t(),c("div",Nn,[(t(),c("svg",{viewBox:o.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?I("",!0):(t(),c("path",{key:0,d:d.value,stroke:e.colorLast,"stroke-width":"1"},null,8,Vn)),u("path",{d:l.value,stroke:e.color,"stroke-width":"1"},null,8,Un)],8,Rn)),u("div",Wn,[ee(v.$slots,"default",{},void 0,!0)])]))}}),qn=V(zn,[["__scopeId","data-v-33f3edcd"]]),On={class:"BuilderLogBlueprintExecution"},Hn={class:"name"},jn={key:0},Kn={class:"eyebrow"},Zn={class:"outcome"},Gn={class:"result"},Yn={class:"time"},Xn={key:0,class:"message markdown"},Jn=N({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const r=z(W.core),a=z(W.builderManager),{goToComponentParentPage:o}=De(r,a),l=e,d=O(null),v={in_progress:5,error:4,success:3,stopped:2,skipped:1,none:0},i=k(()=>({summary:[...l.executionLog.summary.filter(_=>!!_.outcome).filter(_=>(v[_.outcome]??v.success)>1).map(_=>({..._,component:r.getComponentById(_.componentId),componentDef:r.getComponentById(_.componentId)?r.getComponentDefinition(r.getComponentById(_.componentId).type):void 0}))]}));async function C(m){a.setMode("blueprints"),await pe(),o(m),await pe(),a.setSelection(m,void 0,"log")}function b(m){return m<0?"N/A":m<.1?"< 0.1s":`${m.toFixed(2)}s`}return(m,_)=>{const h=Ft("dompurify-html");return t(),c("div",On,[(t(!0),c(K,null,ae(i.value.summary,(n,p)=>(t(),P(qn,{key:p,"is-last":p+1===i.value.summary.length},{default:M(()=>{var $,y,s,B,g,S,F,A,T,D,x,U;return[u("div",{class:H(["itemWrapper",{"itemWrapper--first":p===0,"itemWrapper--last":p+1===i.value.summary.length}])},[u("div",{class:H(["item",{selected:f(a).isComponentIdSelected(n.componentId)}])},[u("div",Hn,[(y=($=n.component)==null?void 0:$.content)!=null&&y.alias?(t(),c("div",jn,[u("div",Kn,R(((s=n.componentDef)==null?void 0:s.name)??"Unavailable component"),1),Z(" "+R((g=(B=n.component)==null?void 0:B.content)==null?void 0:g.alias),1)])):(t(),c(K,{key:1},[Z(R(((S=n.componentDef)==null?void 0:S.name)??"Unavailable component"),1)],64)),n.component?(t(),P(J,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:ue=>C(n.componentId)},{default:M(()=>[w(q,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):I("",!0)]),u("div",Zn,[n.outcome!=="in_progress"?(t(),c(K,{key:0},[u("div",{class:H(["ball",(T=(A=(F=n.componentDef)==null?void 0:F.outs)==null?void 0:A[n.outcome])==null?void 0:T.style])},null,2),Z(" "+R(((U=(x=(D=n.componentDef)==null?void 0:D.outs)==null?void 0:x[n.outcome])==null?void 0:U.name)??n.outcome),1)],64)):(t(),c(K,{key:1},[_[1]||(_[1]=u("div",{class:"ballContainer"},[u("div",{class:"ball inProgress"})],-1)),_[2]||(_[2]=Z(" In progress... "))],64))]),u("div",Gn,[d.value==p?(t(),P(ke,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>d.value=null}]},{default:M(()=>[w(Mn,{"execution-item":n,onCloseModal:_[0]||(_[0]=()=>d.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):I("",!0),n.result||n.returnValue||n.executionEnvironment?(t(),P(J,{key:1,variant:"special",size:"small",onClick:()=>d.value=p},{default:M(()=>[w(q,{name:"file-search-2"}),_[3]||(_[3]=Z(" Trace "))]),_:2},1032,["onClick"])):I("",!0)]),u("div",Yn,R(b(n.executionTimeInSeconds)),1),n.message?me((t(),c("div",Xn,null,512)),[[h,f(Yt).parse(n.message)]]):I("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),Qn=V(Jn,[["__scopeId","data-v-a691c27b"]]),eo={class:"BuilderLogIndicator"},to={key:0,class:"number error"},ao={class:"icon"},no={key:1,class:"number info"},oo={class:"icon"},ro=N({__name:"BuilderLogIndicator",setup(e){const r=z(W.builderManager),a=k(()=>r.getLogEntries().reduce((o,l)=>(l.type in o||(o[l.type]=0),o[l.type]++,o),{}));return(o,l)=>(t(),c("div",eo,[a.value.error>0?(t(),c("div",to,[u("div",ao,[w(q,{name:"triangle-alert"})]),Z(" "+R(a.value.error??0),1)])):I("",!0),a.value.info>0?(t(),c("div",no,[u("div",oo,[w(q,{name:"info"})]),Z(" "+R(a.value.info??0),1)])):I("",!0)]))}}),lo=V(ro,[["__scopeId","data-v-f0898ae9"]]),io={key:0,class:"entries"},so={class:"icon"},uo={class:"title"},co={class:"time"},po={class:"content"},vo={key:0,class:"codeContainer"},mo={key:1,class:"emptyMessage"},fo=N({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const r=z(W.core),a=z(W.builderManager),o=de("panel"),l=ve(r);async function d(b){b&&(l.track("nav_logs_opened"),await pe(),await C())}const v=[{icon:"trash-2",name:"Clear log",callback:()=>{a.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],i=k(()=>a.getLogEntries());async function C(){var p;const b=(p=o.value)==null?void 0:p.mainContents;if(!b)return;const m=b.querySelector(".item.selected");if(!m)return;const _=b.getBoundingClientRect(),h=m.getBoundingClientRect(),n=b.scrollTop+(h.top-_.top)-(_.height/2-h.height/2);b.scrollTo({top:n,behavior:"smooth"})}return te(a.selection,async()=>{await pe(),await C()}),(b,m)=>(t(),P(pt,{ref_key:"panel",ref:o,"panel-id":"log",name:"Log","contents-teleport-el":b.contentsTeleportEl,actions:v,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:d},{titleCompanion:M(()=>[w(lo)]),default:M(()=>[i.value.length>0?(t(),c("div",io,[(t(!0),c(K,null,ae(i.value,(_,h)=>(t(),c(K,{key:h},[u("div",{class:H(["entry",_.type])},[u("div",so,[w(q,{name:_.type==="error"?"triangle-alert":"info"},null,8,["name"])]),u("div",uo,R(_.title)+R(_.repeated>0?` Â· Repeated ${_.repeated} times`:""),1),u("div",co,R(_.timestampReceived.toLocaleTimeString()),1),u("div",po,[Z(R(_.message)+" ",1),_.code?(t(),c("div",vo,[u("code",null,R(_.code),1)])):I("",!0)])],2),_.blueprintExecution?(t(),P(Qn,{key:0,"execution-log":_.blueprintExecution},null,8,["execution-log"])):I("",!0)],64))),128))])):I("",!0),i.value.length==0?(t(),c("div",mo,m[0]||(m[0]=[u("div",null,[Z(" Exceptions and other relevant messages will be shown here."),u("br"),Z("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):I("",!0)]),_:1},8,["contents-teleport-el"]))}}),_o=V(fo,[["__scopeId","data-v-5bf9ec81"]]),ho={class:"switches"},yo=N({__name:"BuilderPanelSwitcher",setup(e){const r=z(W.builderManager),a=de("screenEl");return(o,l)=>(t(),c("div",{class:H(["BuilderPanelSwitcher",{openPanels:f(r).openPanels.value.size>0}])},[u("div",{ref_key:"screenEl",ref:a,class:"screen"},null,512),u("div",ho,[w(fn,{"contents-teleport-el":f(a)},null,8,["contents-teleport-el"]),w(_o,{"contents-teleport-el":f(a)},null,8,["contents-teleport-el"])])],2))}}),go=V(yo,[["__scopeId","data-v-93f8be10"]]),bo=["href"],wo=["disabled"],ko=N({__name:"BuilderSidebarButton",props:{icon:{type:String,required:!0},active:{type:Boolean},disabled:{type:Boolean},href:{type:String,required:!1,default:void 0}},setup(e){return(r,a)=>e.href?(t(),c("a",{key:0,class:"BuilderSidebarButton",href:e.href},[w(q,{name:e.icon},null,8,["name"])],8,bo)):(t(),c("button",{key:1,class:H(["BuilderSidebarButton",{"BuilderSidebarButton--active":e.active}]),role:"button",disabled:e.disabled},[w(q,{name:e.icon},null,8,["name"])],10,wo))}}),be=V(ko,[["__scopeId","data-v-044cd21a"]]),Bo={class:"BuilderSidebarVersion"},So={class:"BuilderSidebarVersion__capsule"},Co=N({__name:"BuilderSidebarVersion",props:{version:{type:String,required:!0}},setup(e){return(r,a)=>(t(),c("span",Bo,[u("span",So," BETA "+R(e.version),1)]))}}),$o=V(Co,[["__scopeId","data-v-bbae565d"]]),Io={key:0,class:"BuilderSidebarPanel__inputContainer"},xo={class:"BuilderSidebarPanel__footer"},Do=N({__name:"BuilderSidebarPanel",props:Oe({hideSearchBar:{type:Boolean,required:!1},placeholder:{type:String,required:!1,default:""},searchCount:{type:Number,required:!1,default:void 0}},{modelValue:{type:String,required:!1,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const r=it(e,"modelValue"),a=e,o=k(()=>{if(a.searchCount!==void 0)return`${a.searchCount} result${a.searchCount===1?"":"s"}`}),l=O(!1);function d(v){v.target instanceof HTMLElement&&(l.value=v.target.scrollTop>0)}return(v,i)=>(t(),c("div",{class:H(["BuilderSidebarPanel",{"BuilderSidebarPanel--mainScrollSeparator":l.value}])},[e.hideSearchBar?I("",!0):(t(),c("div",Io,[w(ut,{modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=C=>r.value=C),class:"searchInput","left-icon":"search","data-automation-action":"search",placeholder:e.placeholder,"right-text":o.value,"right-icon":r.value?"x":void 0,onRightIconClick:i[1]||(i[1]=C=>r.value="")},null,8,["modelValue","placeholder","right-text","right-icon"])])),u("div",{class:"BuilderSidebarPanel__main",onScroll:d},[ee(v.$slots,"default",{},void 0,!0)],32),u("div",xo,[ee(v.$slots,"footer",{},void 0,!0)])],2))}}),Po=V(Do,[["__scopeId","data-v-fcaea8d5"]]),Ao=["data-note-id"],To={class:"BuilderSidebarNote__header"},Lo={class:"BuilderSidebarNote__header__avatar"},Eo={class:"BuilderSidebarNote__header__avatar__type"},Fo={class:"BuilderSidebarNote__header__info"},Mo={key:1},No={key:0,class:"BuilderSidebarNote__header__actions"},Ro={key:0,class:"BuilderSidebarNote__content"},Vo={key:0},Uo=N({__name:"BuilderSidebarNote",props:{component:{type:Object,required:!0},excerpt:{type:Boolean}},emits:{select:()=>!0,edit:()=>!0,delete:()=>!0},setup(e,{emit:r}){const a=e,{user:o}=Mt(),l=r,d=z(W.notesManager),{createdAtFormatted:v,type:i,content:C,createdBy:b}=d.useNoteInformation(k(()=>a.component)),{user:m,isLoading:_,error:h}=at(b),n=k(()=>_.value||h.value),p=k(()=>C.value.length<100?C.value:`${C.value.slice(0,100)}...`),$=k(()=>C.value.split(`
`)),y=k(()=>m.value?[m.value.firstName,m.value.lastName].filter(Boolean).join(" "):""),s=k(()=>{var g;if(((g=o.value)==null?void 0:g.id)===b.value)return[{value:"edit",label:"Edit",icon:"pencil"},{value:"delete",label:"Delete",icon:"trash-2",variant:"danger"}]});function B(g){switch(g){case"edit":return l("edit");case"delete":return l("delete")}}return(g,S)=>(t(),c("div",{class:"BuilderSidebarNote","data-note-id":e.component.id,tabindex:"0",onClick:S[0]||(S[0]=F=>g.$emit("select"))},[u("div",To,[u("div",Lo,[u("div",Eo,[f(i)==="blueprints"?(t(),P(q,{key:0,name:"wds-blueprints"})):f(i)==="ui"?(t(),P(q,{key:1,name:"frame"})):I("",!0)]),w(Ze,{"user-id":f(b)},null,8,["user-id"])]),u("div",Fo,[n.value?(t(),P(nt,{key:0,class:"BuilderSidebarNote__header__info__loader"})):(t(),c("p",Mo,R(y.value),1)),u("p",null,R(f(v)),1)]),s.value?(t(),c("div",No,[w(ot,{options:s.value,"trigger-custom-size":"16px",onSelect:B},null,8,["options"])])):I("",!0)]),f(C)?(t(),c("div",Ro,[e.excerpt?(t(),c("p",Vo,R(p.value),1)):(t(!0),c(K,{key:1},ae($.value,(F,A)=>(t(),c("p",{key:A},R(F),1))),128))])):I("",!0)],8,Ao))}}),et=V(Uo,[["__scopeId","data-v-4129b8b4"]]),Wo={},zo={class:"BuilderSidebarNotesEmpty"};function qo(e,r){return t(),c("div",zo,r[0]||(r[0]=[Nt('<svg width="77" height="77" viewBox="0 0 77 77" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-98d925a1><circle cx="38.5" cy="38.5" r="38.5" fill="#E4E9FF" data-v-98d925a1></circle><path d="M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778V30.1111Z" fill="white" data-v-98d925a1></path><path d="M32.6667 35.4444H43.3333H32.6667Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778M32.6667 35.4444H43.3333M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" data-v-98d925a1></path></svg><h5 data-v-98d925a1>No Notes</h5><p data-v-98d925a1>Click anywhere on a blueprint or interface to add a note</p>',3)]))}const Oo=V(Wo,[["render",qo],["__scopeId","data-v-98d925a1"]]),Ho={class:"BuilderSidebarNoteForm"},jo=N({__name:"BuilderSidebarNoteForm",props:{component:{type:Object,required:!0},autofocus:{type:Boolean}},emits:{submit:e=>typeof e=="string"},setup(e){const r=e,a=z(W.notesManager),o=O(a.getNoteContent(r.component));return(l,d)=>(t(),c("div",Ho,[w(Rt,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=v=>o.value=v),class:"BuilderSidebarNoteForm__input",autofocus:e.autofocus},null,8,["modelValue","autofocus"]),w(J,{class:"BuilderSidebarNoteForm__submit",variant:"secondary",size:"smallIcon",disabled:!o.value,onClick:d[1]||(d[1]=v=>l.$emit("submit",o.value))},{default:M(()=>[w(q,{name:"send"})]),_:1},8,["disabled"])]))}}),Ko=V(jo,[["__scopeId","data-v-157847b0"]]),Zo={key:0,class:"BuilderSidebarNotes__note"},Go={key:2,class:"BuilderSidebarNotes__notes"},Yo=N({__name:"BuilderSidebarNotes",setup(e){const r=z(W.core),a=z(W.builderManager),{selectedNote:o,selectNote:l,selectedNoteMode:d,selectedNoteId:v,getAllNotes:i,searchNotes:C,deleteNote:b,hoveredNoteId:m,useNoteInformation:_}=z(W.notesManager),{createAndInsertComponent:h}=De(r,a),n=Vt({componentId:v,fieldKey:"content"}),p=O(""),$=k(()=>Array.from(i()).toSorted(B)),y=k(()=>Array.from(C(p.value)).toSorted(B)),s=k(()=>!!(o.value||$.value.length===0));function B(F,A){const T=_(F).createdAt.value,D=_(A).createdAt.value;return new Date(D).getTime()-new Date(T).getTime()}function g(F){return _(F).state.value}function S(F){r.getComponentById(v.value)?n.value=F:h(o.value.type,o.value.parentId,void 0,{content:{...o.value.content,content:F},x:o.value.x,y:o.value.y}),l(void 0)}return(F,A)=>(t(),P(Po,{modelValue:p.value,"onUpdate:modelValue":A[4]||(A[4]=T=>p.value=T),class:"BuilderSidebarNotes","hide-search-bar":s.value},{default:M(()=>[f(o)?(t(),c("div",Zo,[f(d)==="edit"?(t(),P(Ko,{key:0,component:f(o),autofocus:"",onSubmit:S},null,8,["component"])):(t(),P(et,{key:1,component:f(o),onGoBack:A[0]||(A[0]=T=>f(l)(void 0)),onEdit:A[1]||(A[1]=T=>f(l)(f(v),"edit")),onDelete:A[2]||(A[2]=T=>f(b)(f(v)))},null,8,["component"]))])):y.value.length===0?(t(),P(Oo,{key:1})):(t(),c("div",Go,[(t(!0),c(K,null,ae(y.value,T=>(t(),P(et,{key:T.id,component:T,class:H(["BuilderSidebarNotes__notes__note",{"BuilderSidebarNotes__notes__note--hover":g(T)==="hover"}]),excerpt:"",onSelect:D=>f(l)(T.id,"show"),onEdit:D=>f(l)(T.id,"edit"),onDelete:D=>f(b)(T.id),onMouseenter:D=>m.value=T.id,onMouseleave:A[3]||(A[3]=D=>m.value=void 0)},null,8,["component","class","onSelect","onEdit","onDelete","onMouseenter"]))),128))]))]),_:1},8,["modelValue","hide-search-bar"]))}}),Xo=V(Yo,[["__scopeId","data-v-3dc5600c"]]),Jo={class:"BuilderSidebar"},Qo={class:"BuilderSidebar__toolbar"},er={key:0,class:"BuilderSidebar__toolbar__top"},tr={key:1,class:"BuilderSidebar__toolbar__center"},ar={class:"BuilderSidebar__toolbar__bottom"},nr={key:0,class:"BuilderSidebar__pane"},or={key:1},rr=N({__name:"BuilderSidebar",emits:{activePaneChanged:e=>e===void 0||typeof e=="string"},setup(e,{emit:r}){const a=ie({loader:()=>se(()=>import("./BuilderSidebarToolkit-CXeE4Fmt.js"),__vite__mapDeps([4,0,1,5,6,7,8]),import.meta.url)}),o=ie({loader:()=>se(()=>import("./BuilderSidebarComponentTree-CQDZgaj5.js"),__vite__mapDeps([9,0,1,10,5,6,7,11]),import.meta.url)});function l(D){return typeof D=="string"&&["layers","add"].includes(D)}const d=z(W.core),v=z(W.builderManager),i=z(W.notesManager),C=r,b=k(()=>h()),{undo:m,redo:_,getUndoRedoSnapshot:h}=De(d,v),n=k(()=>v.mode.value==="preview"),p="",$=Ut("activePane",l),y=O(n.value?void 0:$.value),s=k(()=>y.value!=="notes"?!1:i.selectedNoteId.value!==void 0);function B(){y.value==="notes"&&i.selectNote(void 0)}te(y,()=>{i.isAnnotating.value=y.value==="notes"},{immediate:!0}),te(n,()=>{n.value&&y.value}),te(i.selectedNoteId,()=>{i.selectedNoteId.value&&(y.value="notes")});const g=k(()=>({layers:v.mode.value==="ui"?"Interface Layers":"Blueprint Layers",add:"Add block",notes:"Notes"})),S=qe();async function F(D){if(!(!(He()?D.metaKey:D.ctrlKey)||D.target.closest("textarea, input, select")))switch(D.key){case"l":D.preventDefault(),y.value="layers";break;case"Enter":D.preventDefault(),y.value="add";break}}const A=new AbortController;ce(()=>{document.addEventListener("keydown",F,{signal:A.signal})}),Ce(()=>A.abort());function T(D){y.value=y.value===D?void 0:D,$.value=y.value,i.selectNote(void 0),C("activePaneChanged",D)}return(D,x)=>(t(),c("div",Jo,[u("div",Qo,[n.value?I("",!0):(t(),c("div",er,[x[6]||(x[6]=u("hr",null,null,-1)),w(be,{icon:"layers","data-writer-tooltip-placement":"right","data-writer-tooltip":`${g.value.layers} (${f(S)}L)`,active:y.value==="layers","data-automation-action":"sidebar-layers",onClick:x[0]||(x[0]=U=>T("layers"))},null,8,["data-writer-tooltip","active"]),w(be,{icon:"wds-blocks","data-writer-tooltip-placement":"right","data-writer-tooltip":`${g.value.add} (${f(S)}Enter)`,active:y.value==="add","data-automation-action":"sidebar-add",onClick:x[1]||(x[1]=U=>T("add"))},null,8,["data-writer-tooltip","active"]),f(d).isWriterCloudApp.value?(t(),P(be,{key:0,icon:"message-square","data-writer-tooltip-placement":"right","data-writer-tooltip":`${g.value.notes}`,active:y.value==="notes","data-automation-action":"sidebar-notes",onClick:x[2]||(x[2]=U=>T("notes"))},null,8,["data-writer-tooltip","active"])):I("",!0)])),n.value?I("",!0):(t(),c("div",tr,[x[7]||(x[7]=u("hr",null,null,-1)),w(be,{icon:"undo-2","data-automation-key":"undo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Undo (${f(S)}Z)`,disabled:!b.value.isUndoAvailable,onClick:x[3]||(x[3]=U=>f(m)())},null,8,["data-writer-tooltip","disabled"]),w(be,{"data-automation-key":"redo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Redo (${f(S)}Y)`,icon:"redo-2",disabled:!b.value.isRedoAvailable,onClick:x[4]||(x[4]=U=>f(_)())},null,8,["data-writer-tooltip","disabled"])])),u("div",ar,[f(p)?(t(),P($o,{key:0,version:f(p)},null,8,["version"])):I("",!0),x[8]||(x[8]=u("hr",null,null,-1)),w(be,{target:"_blank",href:"https://dev.writer.com/agent-builder/overview",icon:"circle-question-mark","data-writer-tooltip-placement":"right","data-writer-tooltip":"Docs"})])]),y.value&&!n.value?(t(),c("div",nr,[u("div",{class:H(["BuilderSidebar__pane__header",{"BuilderSidebar__pane__header--goBack":s.value}])},[s.value?(t(),c(K,{key:0},[w(J,{variant:"neutral",size:"smallIcon",onClick:B},{default:M(()=>[w(q,{name:"arrow-left"})]),_:1}),x[9]||(x[9]=u("h2",null,"Back",-1))],64)):(t(),c("h2",or,R(g.value[y.value]),1)),w(J,{variant:"neutral",size:"smallIcon",onClick:x[5]||(x[5]=U=>y.value=void 0)},{default:M(()=>[w(q,{name:"arrow-left-to-line"})]),_:1})],2),y.value==="add"?(t(),P(f(a),{key:0})):I("",!0),y.value==="layers"?(t(),P(f(o),{key:1})):I("",!0),y.value==="notes"?(t(),P(Xo,{key:2})):I("",!0)])):I("",!0)]))}}),lr=V(rr,[["__scopeId","data-v-bf0b63b3"]]),ir={class:"WdsToast__icon"},sr=N({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const r=e,a=k(()=>{switch(r.type){case"info":return"info";case"success":return"check";case"error":return"x";default:return"circle-question-mark"}});return(o,l)=>(t(),c("div",{class:H(["WdsToast",`WdsToast--${e.type}`])},[u("div",ir,[w(q,{name:a.value},null,8,["name"])]),u("p",null,R(e.message),1),e.action?(t(),c("button",{key:0,class:"WdsToast__action",onClick:l[0]||(l[0]=(...d)=>e.action.func&&e.action.func(...d))},[Z(R(e.action.label)+" ",1),w(q,{name:e.action.icon},null,8,["name"])])):I("",!0),e.closable?(t(),P(J,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:l[1]||(l[1]=d=>o.$emit("close"))},{default:M(()=>[w(q,{name:"x"})]),_:1})):I("",!0)],2))}}),dr=V(sr,[["__scopeId","data-v-834b8081"]]),ur={class:"BuilderToasts"},cr=N({__name:"BuilderToasts",setup(e){const{toasts:r,removeToast:a}=Be();return(o,l)=>(t(),c("div",ur,[w(Wt,{name:"list",tag:"div"},{default:M(()=>[(t(!0),c(K,null,ae(f(r),d=>(t(),P(dr,{key:d.id,class:"BuilderToasts__toast",closable:d.closable,message:d.message,type:d.type,action:d.action,onClick:v=>f(a)(d.id)},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),pr=V(cr,[["__scopeId","data-v-6c357255"]]),vr=200,mr=36,fr=N({__name:"BuilderInstanceTracker",props:{instancePath:{},matchSize:{type:Boolean},verticalOffsetPixels:{},isOffBoundsAllowed:{type:Boolean},preventSettingsBarOverlap:{type:Boolean}},setup(e,{expose:r}){const a=e,{instancePath:o,matchSize:l,verticalOffsetPixels:d,isOffBoundsAllowed:v,preventSettingsBarOverlap:i}=zt(a),C=Ee({});let b=0;const m=de("rootEl");function _(y){const s=document.querySelector(".ComponentRenderer"),{top:B,left:g}=y.getBoundingClientRect(),{clientHeight:S}=document.body,{clientWidth:F}=s,{left:A}=s.getBoundingClientRect(),T=document.querySelector(".BuilderSettings"),{left:D}=(T==null?void 0:T.getBoundingClientRect())||{left:1/0};let{clientHeight:x,clientWidth:U}=(l!=null&&l.value?y:m.value)??{};if(x===void 0||U===void 0)return;let ue=d!=null&&d.value?d.value:0,Y=g,le=B+ue;if(v.value||(Y=Math.max(A,Y),Y=Math.min(A+F-U,Y),le=Math.max(mr,le),le=Math.min(S-x,le)),i.value){let he=0;Y+U>D&&(he=Math.max(Y-(D-U),0)),Y-=he}C.value={display:"block",top:`${le}px`,left:`${Y}px`,width:`${U}px`,height:`${x}px`}}function h(){C.value={display:"none"}}function n(){let y=document.querySelector(`.ComponentRenderer [data-writer-instance-path="${o.value}"]`);if(!y){h();return}const s=getComputedStyle(y);if(!s){h();return}if(s.display=="contents"&&(y=y.querySelector("[data-writer-id]")),!y){h();return}_(y)}function p(){b=requestAnimationFrame(async()=>{n(),!$.signal.aborted&&(await new Promise(y=>setTimeout(y,vr)),p())})}const $=Ke();return r({refresh:n}),ce(async()=>{window.addEventListener("scroll",n,{signal:$.signal}),p()}),Ce(()=>{cancelAnimationFrame(b)}),(y,s)=>(t(),c("div",{ref_key:"rootEl",ref:m,class:"BuilderInstanceTracker",style:xe(C.value)},[ee(y.$slots,"default",{},void 0,!0)],4))}}),Le=V(fr,[["__scopeId","data-v-c3e9e555"]]),_r={ref:"rootEl",class:"BuilderCollaborationTracker"},hr={class:"bubble"},yr={class:"main"},gr=N({__name:"BuilderCollaborationTracker",setup(e){const r=z(W.collaborationManager);function a(o){return!(qt(o).length<=2)}return(o,l)=>(t(),c("div",_r,[(t(!0),c(K,null,ae(f(r).connectedUsersByInstancePath.value,(d,v)=>(t(),c(K,{key:v},[a(v)?(t(),P(Le,{key:0,"is-off-bounds-allowed":!1,"instance-path":v,"vertical-offset-pixels":-32,class:"instanceTracker"},{default:M(()=>[u("div",hr,[u("div",yr,[(t(!0),c(K,null,ae(d,i=>(t(),P(Ze,{key:i,"show-tooltip":!0,"user-id":i},null,8,["user-id"]))),128))]),l[0]||(l[0]=u("div",{class:"triangle"},null,-1))])]),_:2},1032,["instance-path"])):I("",!0)],64))),128))],512))}}),br=V(gr,[["__scopeId","data-v-15c19d63"]]),wr={class:"ShareResizeVertical__top"},kr={class:"ShareResizeVertical__divider"},Br={class:"ShareResizeVertical__bottom"},Sr=N({__name:"ShareResizeVertical",props:{initialBottomSize:{type:Number,required:!0},disabled:{type:Boolean,required:!1}},setup(e){const r=e,a=de("root"),o=Ke(),l=Ot(r,"initialBottomSize");let d=O(l.value);te(l,()=>d.value=l.value);const v=k(()=>({gridTemplateRows:`minmax(0px, 1fr) 1px ${d.value}px`}));function i(){if(!a.value)return;document.addEventListener("mousemove",b,{signal:o.signal}),document.addEventListener("mouseup",m,{signal:o.signal});const C=a.value.getBoundingClientRect();function b(_){d.value=C.bottom-_.clientY}function m(){document.removeEventListener("mouseup",m),document.removeEventListener("mousemove",b)}}return(C,b)=>(t(),c("div",{ref_key:"root",ref:a,class:"ShareResizeVertical",style:xe(v.value)},[u("div",wr,[ee(C.$slots,"top",{},void 0,!0)]),u("div",kr,[e.disabled?I("",!0):(t(),c("div",{key:0,class:"ShareResizeVertical__divider__hand",onMousedown:st(i,["prevent"])},null,32))]),u("div",Br,[ee(C.$slots,"bottom",{},void 0,!0)])],4))}}),Cr=V(Sr,[["__scopeId","data-v-0de30584"]]),$r={class:"builderMain"},Ir=N({__name:"BuilderApp",setup(e){Ht(W.isAutogenModalShown,O(!1));const r=ie({loader:()=>se(()=>import("./BuilderSettings-DuOk-ku4.js").then(L=>L.b),__vite__mapDeps([12,0,1,10,13,5,6,14,15,16,17]),import.meta.url)}),a=ie({loader:()=>se(()=>import("./ComponentRenderer-C6llJgm8.js"),__vite__mapDeps([18,0,1,19]),import.meta.url)}),o=ie({loader:()=>se(()=>import("./BuilderInsertionOverlay-COCl_f82.js"),__vite__mapDeps([20,0,1,21]),import.meta.url)}),l=ie({loader:()=>se(()=>import("./BuilderInsertionLabel-Ca4-ZVef.js"),__vite__mapDeps([22,0,1,23]),import.meta.url)}),d=ie({loader:()=>se(()=>import("./BuilderVault-BlMa4y_O.js"),__vite__mapDeps([24,15,0,1,16,25]),import.meta.url)}),v=z(W.core),i=z(W.builderManager),C=z(W.notesManager),b=z(W.collaborationManager),m=ve(v),_=Be(),h=de("noteEl");function n(){if(h.value!=null&&typeof h.value[Symbol.iterator]=="function")for(const Q of h.value)Q.refresh()}const{candidateId:p,candidateInstancePath:$,isCandidacyConfirmed:y,dropComponent:s,assignInsertionCandidacy:B,removeInsertionCandidacy:g}=Zt(v),{createAndInsertComponent:S,undo:F,redo:A,moveComponent:T,moveComponentUp:D,moveComponentDown:x,cutComponent:U,isPasteAllowed:ue,isCopyAllowed:Y,isCutAllowed:le,isDeleteAllowed:he,isGoToParentAllowed:Pe,isGoToChildAllowed:Ne,isGoToNextSiblingAllowed:Ae,isGoToPrevSiblingAllowed:Te,pasteComponent:$e,copyComponent:Re,removeComponentsSubtree:E,goToParent:G,goToChild:ne,goToNextSibling:Ve,goToPrevSibling:Ue,moveComponentToParent:ft,moveComponentInsideNextSibling:_t}=De(v,i,m),oe=i.mode,ht=i.firstSelectedId,Ge=k(()=>i.openPanels.value.size>0),yt=k(()=>Array.from(C.getNotes(v.activePageId.value)).map(L=>({...L,parentInstancePath:C.useNoteInformation(L).parentInstancePath.value})).filter(L=>L.parentInstancePath!==void 0));async function gt(L){if(L.key=="Escape"){i.setSelection(null);return}const Q=He()?L.metaKey:L.ctrlKey;if(L.target.closest("textarea, input, select, [contenteditable]"))return;if(L.key=="z"&&Q){L.preventDefault(),F();return}if(L.key=="y"&&Q){L.preventDefault(),A();return}if(!i.isSingleSelectionActive.value||!i.firstSelectedItem.value)return;const{componentId:j,instancePath:ye}=i.firstSelectedItem.value;if(L.key==(He()?"Backspace":"Delete")){const fe=i.selection.value.filter(We=>he(We.componentId)).map(We=>We.componentId);E(...fe);return}if(Q)if(L.shiftKey)switch(L.key){case"ArrowDown":L.preventDefault(),Ae(j)&&Ve(j);break;case"ArrowUp":L.preventDefault(),Te(j)&&Ue(j);break;case"ArrowLeft":L.preventDefault(),Pe(j)&&G(j,ye);break;case"ArrowRight":L.preventDefault(),Ne(j)&&ne(j);break}else switch(L.key){case"ArrowDown":L.preventDefault(),x(j);break;case"ArrowUp":L.preventDefault(),D(j);break;case"ArrowLeft":L.preventDefault(),ft(j);break;case"ArrowRight":L.preventDefault(),_t(j);break;case"v":if(!ue(j))return;try{await $e(j)}catch(fe){_.pushToast({type:"error",message:String(fe)})}break;case"c":Y(j)&&Re(j);break;case"x":le(j)&&U(j);break}}function bt(L){oe.value!=="preview"&&B(L)}function wt(L){if(oe.value==="preview")return;i.setSelection(null);const Q=s(L);if(!Q)return;const{draggedType:X,draggedId:j,parentId:ye,position:fe}=Q;j?T(j,ye,fe):S(X,ye,fe)}function kt(L){if(oe.value==="preview"||L.target.closest("[data-writer-unselectable]"))return;const X=L.target.closest("[data-writer-id]");if(!X)return;const j=X.dataset.writerId,ye=X.dataset.writerInstancePath;i.isComponentIdSelected(j)&&i.selectionStatus.value!==Je.Multiple||C.isAnnotating.value||(L.preventDefault(),L.stopPropagation(),i.handleSelectionFromEvent(L,j,ye,"click"))}function Bt(){i.isSettingsBarCollapsed.value=!1}const St=L=>{if(oe.value==="preview")return;const X=L.target.closest("[data-writer-id]").dataset.writerId,{type:j}=v.getComponentById(X);i.selectionStatus.value===Je.Multiple&&(i.setSelection(X,void 0,"click"),i.isSettingsBarCollapsed.value=!0),L.dataTransfer.setData(`application/json;writer=${j},${X}`,"{}")};function Ct(L){i.setSelection(null),g(L)}const Ye=new AbortController;return te(i.selection,()=>{b&&(b.updateOutgoingPing({action:"select",selection:i.selection.value}),b.sendCollaborationPing())}),ce(()=>{document.addEventListener("keydown",gt,{signal:Ye.signal})}),Ce(()=>{Ye.abort()}),(L,Q)=>(t(),c("div",{class:"BuilderApp",tabindex:"-1",style:xe(f(Kt))},[u("div",{class:H(["mainGrid",{openPanels:f(i).openPanels.value.size>0}])},[w(Ca,{class:"builderHeader"}),me(w(lr,{class:"sidebar",onActivePaneChanged:n},null,512),[[Se,f(oe)==="ui"||f(oe)==="blueprints"]]),w(Cr,{"initial-bottom-size":Ge.value?440:48,disabled:!Ge.value,class:H({"mainGrid--fullWidth":f(oe)==="preview"||f(oe)==="vault"})},{top:M(()=>[u("div",$r,[f(oe)==="vault"?(t(),P(f(d),{key:0})):(t(),c("div",{key:1,class:H(["rendererWrapper",{addNoteCursor:f(C).isAnnotating.value&&f(i).mode.value!=="preview"}]),onScroll:n},[w(f(a),{class:H(["componentRenderer",{settingsOpen:f(i).isSingleSelectionActive}]),onDragover:bt,onDragstart:St,onDragend:Ct,onDrop:wt,onClickCapture:kt,onDblclick:Bt},null,8,["class"])],34)),f(i).isSingleSelectionActive?(t(),P(f(r),{key:f(ht)??"noneSelected"})):I("",!0)])]),bottom:M(()=>[w(go,{class:"panelSwitcher"})]),_:1},8,["initial-bottom-size","disabled","class"])],2),f(oe)!=="preview"?(t(),c(K,{key:0},[w(br,{class:"collaborationTracker"}),f(p)&&!f(y)?(t(),c(K,{key:0},[(t(),P(Le,{key:f($),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":f($),"match-size":!0},{default:M(()=>[w(f(o))]),_:1},8,["instance-path"])),(t(),P(Le,{key:f($),class:"insertionLabelTracker","instance-path":f($),"vertical-offset-pixels":-48},{default:M(()=>[w(f(l),null,{default:M(()=>[Z(R(f(v).getComponentDefinition(f(v).getComponentById(f(p)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):I("",!0)],64)):I("",!0),f(oe)==="ui"?(t(!0),c(K,{key:1},ae(yt.value,X=>(t(),P(Le,{key:X.id,ref_for:!0,ref_key:"noteEl",ref:h,class:"BuilderApp__noteTracker","is-off-bounds-allowed":!0,"instance-path":X.parentInstancePath,"match-size":!0},{default:M(()=>[w(jt,{class:"BuilderApp__noteTracker__note","component-id":X.id},null,8,["component-id"])]),_:2},1032,["instance-path"]))),128)):I("",!0),Q[0]||(Q[0]=u("div",{id:"modal"},null,-1)),w(Pa,{id:"tooltip"}),w(pr)],4))}}),xr=V(Ir,[["__scopeId","data-v-452da39b"]]),Tr=Object.freeze(Object.defineProperty({__proto__:null,default:xr},Symbol.toStringTag,{value:"Module"}));export{Po as B,mt as W,Ya as a,qn as b,Tr as c};
