[tox]
envlist = test, lint, format, typecheck
isolated_build = true

[testenv:test]
deps = 
    pytest
    pytest-cov
    pytest-mock
    GitPython
    PyYAML
    jsonschema
    click
commands = 
    pytest tests/ -v --cov=src/git_crossref --cov-report=term-missing

[testenv:test-fast]
deps = 
    pytest
    pytest-mock
    GitPython
    PyYAML
    jsonschema
    click
commands = 
    pytest tests/ -v

[testenv:lint]
deps = 
    ruff
commands = 
    ruff check src/

[testenv:format]
deps = 
    black
    isort
commands = 
    black --check --diff src/
    isort --check-only --diff src/

[testenv:format-fix]
deps = 
    black
    isort
commands = 
    black src/
    isort src/

[testenv:typecheck]
deps = 
    mypy
    types-PyYAML
    GitPython
commands = 
    mypy src/

[testenv:all]
deps = 
    {[testenv:test]deps}
    {[testenv:lint]deps}
    {[testenv:format]deps}
    {[testenv:typecheck]deps}
commands = 
    {[testenv:test]commands}
    {[testenv:lint]commands}
    {[testenv:format]commands}
    {[testenv:typecheck]commands}

# Development environment for running the tool
[testenv:dev]
deps = 
    -e .
commands = 
    git-crossref --help
