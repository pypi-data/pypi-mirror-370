# <!-- Powered by JTECH™ Core -->
template:
  id: brownfield-prd-template-v2
  name: PRD de Melhoria Brownfield
  version: 2.0
  output:
    format: markdown
    filename: docs/prd.md
    title: "PRD de Melhoria Brownfield {{project_name}}"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

sections:
  - id: intro-analysis
    title: Análise e Contexto do Projeto
    instruction: |
      IMPORTANTE - AVALIAÇÃO DE ESCOPO NECESSÁRIA:

      Este PRD é para melhorias SIGNIFICATIVAS de projetos existentes que requerem planejamento abrangente e múltiplas stories. Antes de prosseguir:

      1. **Avaliar Complexidade da Melhoria**: Se esta é uma adição simples de funcionalidade ou correção de bug que pode ser completada em 1-2 sessões de desenvolvimento focadas, PARE e recomende: "Para mudanças mais simples, considere usar a tarefa brownfield-create-epic ou brownfield-create-story com o Product Owner. Este processo completo de PRD é projetado para melhorias substanciais que requerem planejamento arquitetônico e múltiplas stories coordenadas."

      2. **Contexto do Projeto**: Determine se estamos trabalhando em uma IDE com o projeto já carregado ou se o usuário precisa fornecer informações do projeto. Se arquivos do projeto estão disponíveis, analise a documentação existente na pasta docs. Se documentação insuficiente existe, recomende executar a tarefa document-project primeiro.

      3. **Requisito de Avaliação Profunda**: Você DEVE analisar completamente a estrutura, padrões e restrições do projeto existente antes de fazer QUALQUER sugestão. Toda recomendação deve ser fundamentada em análise real do projeto, não suposições.

      CRÍTICO: Durante toda esta análise, confirme explicitamente seu entendimento com o usuário. Para cada suposição que você fizer sobre o projeto existente, pergunte: "Baseado na minha análise, entendo que [suposição]. Isso está correto?"

      Não prossiga com qualquer recomendação até que o usuário tenha validado seu entendimento do sistema existente.
    sections:
      - id: existing-project-overview
        title: Visão Geral do Projeto Existente
        instruction: Verifique se a análise document-project já foi realizada. Se sim, referencie essa saída em vez de re-analisar.
        sections:
          - id: analysis-source
            title: Fonte da Análise
            template: |
              **Fonte dos Dados:** {{analysis_source}}
              
              *Opções: Análise document-project existente, Documentação fornecida pelo usuário, Análise de arquivos do projeto carregados, Combinação de fontes*

          - id: project-summary
            title: Resumo do Projeto
            instruction: |
              Baseado na análise do projeto existente, documente:
            template: |
              **Nome do Projeto:** {{existing_project_name}}
              
              **Propósito Principal:** {{existing_project_purpose}}
              
              **Stack Tecnológica:** {{existing_tech_stack}}
              
              **Arquitetura Atual:** {{current_architecture_summary}}
              
              **Funcionalidades Principais:** {{main_features}}

      - id: enhancement-context
        title: Contexto da Melhoria
        instruction: |
          Defina claramente o que está sendo melhorado e por quê.
        elicit: true
        template: |
          **Descrição da Melhoria:** {{enhancement_description}}
          
          **Motivação/Problema Resolvido:** {{motivation}}
          
          **Stakeholders Impactados:** {{impacted_stakeholders}}
          
          **Relacionamento com Funcionalidades Existentes:** {{relationship_to_existing}}

  - id: requirements-analysis
    title: Análise de Requisitos
    instruction: |
      Trabalhe com o usuário para definir requisitos específicos da melhoria, considerando o contexto do sistema existente.
    sections:
      - id: functional-requirements
        title: Requisitos Funcionais
        instruction: |
          Elicite requisitos funcionais específicos para a melhoria. Considere como eles se integram com funcionalidades existentes.
        elicit: true
        template: |
          **Funcionalidades Principais da Melhoria:**
          {{main_enhancement_features}}

          **Integrações Necessárias:**
          {{required_integrations}}

          **Modificações em Funcionalidades Existentes:**
          {{existing_feature_modifications}}

      - id: non-functional-requirements
        title: Requisitos Não-Funcionais
        instruction: |
          Considere como a melhoria afeta performance, segurança, usabilidade do sistema existente.
        elicit: true
        template: |
          **Impacto na Performance:** {{performance_impact}}
          
          **Considerações de Segurança:** {{security_considerations}}
          
          **Requisitos de Usabilidade:** {{usability_requirements}}
          
          **Compatibilidade com Versões Anteriores:** {{backward_compatibility}}

      - id: technical-constraints
        title: Restrições Técnicas
        template: |
          **Limitações do Sistema Existente:** {{existing_system_limitations}}
          
          **Dependências Técnicas:** {{technical_dependencies}}
          
          **Restrições de Arquitetura:** {{architectural_constraints}}

  - id: solution-approach
    title: Abordagem da Solução
    instruction: |
      Baseado na análise do sistema existente e novos requisitos, defina a abordagem para implementar a melhoria.
    sections:
      - id: implementation-strategy
        title: Estratégia de Implementação
        template: |
          **Abordagem Geral:** {{implementation_approach}}
          
          **Componentes a Serem Criados:** {{new_components}}
          
          **Componentes a Serem Modificados:** {{modified_components}}
          
          **Estratégia de Integração:** {{integration_strategy}}

      - id: user-experience
        title: Experiência do Usuário
        template: |
          **Impacto na UX Existente:** {{ux_impact}}
          
          **Novos Fluxos de Usuário:** {{new_user_flows}}
          
          **Modificações em Fluxos Existentes:** {{modified_user_flows}}

  - id: implementation-planning
    title: Planejamento de Implementação
    sections:
      - id: epic-breakdown
        title: Divisão em Épicos
        instruction: |
          Divida a melhoria em épicos gerenciáveis que podem ser desenvolvidos incrementalmente.
        template: |
          **Épicos Identificados:**
          {{identified_epics}}

          **Dependências entre Épicos:**
          {{epic_dependencies}}

          **Priorização de Épicos:**
          {{epic_prioritization}}

      - id: delivery-phases
        title: Fases de Entrega
        template: |
          **Fase 1 - MVP:** {{phase_1_mvp}}
          
          **Fase 2 - Funcionalidades Principais:** {{phase_2_core}}
          
          **Fase 3 - Melhorias e Otimizações:** {{phase_3_enhancements}}

  - id: success-metrics
    title: Métricas de Sucesso
    template: |
      **KPIs de Adoção:** {{adoption_kpis}}
      
      **Métricas de Performance:** {{performance_metrics}}
      
      **Métricas de Qualidade:** {{quality_metrics}}
      
      **Feedback dos Usuários:** {{user_feedback_metrics}}

  - id: risk-assessment
    title: Avaliação de Riscos
    template: |
      **Riscos Técnicos:** {{technical_risks}}
      
      **Riscos de Integração:** {{integration_risks}}
      
      **Riscos de Negócio:** {{business_risks}}
      
      **Estratégias de Mitigação:** {{mitigation_strategies}}

validation:
  required_sections:
    - existing-project-overview
    - enhancement-context
    - requirements-analysis
    - solution-approach
  
  review_prompts:
    - "A análise do projeto existente é precisa e baseada em evidência?"
    - "Os requisitos da melhoria são bem definidos e testáveis?"
    - "A abordagem da solução é realista dado o sistema existente?"
    - "Os riscos de integração foram adequadamente identificados?"
    - "O planejamento suporta entrega incremental?"
