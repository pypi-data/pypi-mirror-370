/* empty css                                                        */import"./MarkdownCode.svelte_svelte_type_style_lang-DqSyeVpi.js";import{B as ht}from"./BlockLabel-BBGJEuAL.js";import{I as pt}from"./IconButton-BYr8xyoS.js";import{C as bt}from"./Clear-By3xiIwg.js";import{I as wt}from"./Image-Bsh8Umrh.js";import{n as vt}from"./index-D4QfqgLg.js";import{W as kt,a as yt,S as It}from"./SelectSource-DAVRvesF.js";import{I as zt}from"./IconButtonWrapper-BGXYrwVF.js";import{F as Ct}from"./FullscreenButton-BOXi3QmU.js";import{g as Dt}from"./utils-Gtzs_Zla.js";import{D as ot}from"./DropdownArrow-B7DUstP0.js";import{S as St}from"./Square-oAGqOwsh.js";import"./StreamingBar.svelte_svelte_type_style_lang-DyfAPhwM.js";import{f as qt}from"./index-C3K9fiV4.js";import{S as Et}from"./StreamingBar-JqJtcvLZ.js";import{a as Wt}from"./Upload-CL92S78m.js";import"./DownloadLink.svelte_svelte_type_style_lang-C_5UIfol.js";import{I as Bt}from"./Image-CnqB5dbD.js";const{SvelteComponent:Mt,append:Je,attr:L,detach:Tt,init:Rt,insert:jt,noop:Ne,safe_not_equal:Nt,svg_element:Ue}=window.__gradio__svelte__internal;function Ut(l){let e,t,n;return{c(){e=Ue("svg"),t=Ue("path"),n=Ue("circle"),L(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),L(n,"cx","12"),L(n,"cy","13"),L(n,"r","4"),L(e,"xmlns","http://www.w3.org/2000/svg"),L(e,"width","100%"),L(e,"height","100%"),L(e,"viewBox","0 0 24 24"),L(e,"fill","none"),L(e,"stroke","currentColor"),L(e,"stroke-width","1.5"),L(e,"stroke-linecap","round"),L(e,"stroke-linejoin","round"),L(e,"class","feather feather-camera")},m(i,s){jt(i,e,s),Je(e,t),Je(e,n)},p:Ne,i:Ne,o:Ne,d(i){i&&Tt(e)}}}class Lt extends Mt{constructor(e){super(),Rt(this,e,null,Ut,Nt,{})}}const{SvelteComponent:Pt,append:$t,attr:V,detach:Ft,init:At,insert:Ht,noop:Le,safe_not_equal:Ot,svg_element:Ke}=window.__gradio__svelte__internal;function Vt(l){let e,t;return{c(){e=Ke("svg"),t=Ke("circle"),V(t,"cx","12"),V(t,"cy","12"),V(t,"r","10"),V(e,"xmlns","http://www.w3.org/2000/svg"),V(e,"width","100%"),V(e,"height","100%"),V(e,"viewBox","0 0 24 24"),V(e,"stroke-width","1.5"),V(e,"stroke-linecap","round"),V(e,"stroke-linejoin","round"),V(e,"class","feather feather-circle")},m(n,i){Ht(n,e,i),$t(e,t)},p:Le,i:Le,o:Le,d(n){n&&Ft(e)}}}class Gt extends Pt{constructor(e){super(),At(this,e,null,Vt,Ot,{})}}const{SvelteComponent:Jt,append:Ie,attr:Pe,create_component:Kt,destroy_component:Qt,detach:Xt,element:$e,init:Yt,insert:Zt,listen:xt,mount_component:en,noop:tn,safe_not_equal:nn,set_style:ln,space:rn,text:sn,transition_in:on,transition_out:an}=window.__gradio__svelte__internal,{createEventDispatcher:cn}=window.__gradio__svelte__internal;function un(l){let e,t,n,i,s,r="Click to Access Webcam",c,o,u,m;return i=new kt({}),{c(){e=$e("button"),t=$e("div"),n=$e("span"),Kt(i.$$.fragment),s=rn(),c=sn(r),Pe(n,"class","icon-wrap svelte-qbrfs"),Pe(t,"class","wrap svelte-qbrfs"),Pe(e,"class","svelte-qbrfs"),ln(e,"height","100%")},m(_,w){Zt(_,e,w),Ie(e,t),Ie(t,n),en(i,n,null),Ie(t,s),Ie(t,c),o=!0,u||(m=xt(e,"click",l[1]),u=!0)},p:tn,i(_){o||(on(i.$$.fragment,_),o=!0)},o(_){an(i.$$.fragment,_),o=!1},d(_){_&&Xt(e),Qt(i),u=!1,m()}}}function _n(l){const e=cn();return[e,()=>e("click")]}class fn extends Jt{constructor(e){super(),Yt(this,e,_n,un,nn,{})}}function mn(){return navigator.mediaDevices.enumerateDevices()}function dn(l,e){e.srcObject=l,e.muted=!0,e.play()}async function Qe(l,e,t,n){const i={video:n?{deviceId:{exact:n},...t?.video}:t?.video||{width:{ideal:1920},height:{ideal:1440}},audio:l&&(t?.audio??!0)};return navigator.mediaDevices.getUserMedia(i).then(s=>(dn(s,e),s))}function gn(l){return l.filter(t=>t.kind==="videoinput")}const{SvelteComponent:hn,action_destroyer:pn,add_render_callback:bn,append:D,attr:v,binding_callbacks:wn,check_outros:ge,create_component:ee,create_in_transition:vn,destroy_component:te,destroy_each:kn,detach:j,element:T,empty:Oe,ensure_array_like:Xe,flush:G,group_outros:he,init:yn,insert:N,listen:Se,mount_component:ne,noop:Ve,run_all:In,safe_not_equal:zn,set_data:ke,set_input_value:Fe,set_style:at,space:K,src_url_equal:Ye,stop_propagation:Cn,text:ye,toggle_class:se,transition_in:E,transition_out:M}=window.__gradio__svelte__internal,{createEventDispatcher:Dn,onDestroy:Sn,onMount:qn}=window.__gradio__svelte__internal;function Ze(l,e,t){const n=l.slice();return n[39]=e[t],n}function En(l){let e,t,n,i,s,r,c,o,u,m,_;const w=[Mn,Bn],k=[];function R(b,y){return b[2]==="video"||b[1]?0:1}n=R(l),i=k[n]=w[n](l);let g=!l[11]&&xe(l),p=l[13]&&l[8]&&et(l);return{c(){e=T("div"),t=T("button"),i.c(),r=K(),g&&g.c(),c=K(),p&&p.c(),o=Oe(),v(t,"aria-label",s=l[2]==="image"?"capture photo":"start recording"),v(t,"class","svelte-10cpz3p"),v(e,"class","button-wrap svelte-10cpz3p")},m(b,y){N(b,e,y),D(e,t),k[n].m(t,null),D(e,r),g&&g.m(e,null),N(b,c,y),p&&p.m(b,y),N(b,o,y),u=!0,m||(_=Se(t,"click",l[28]),m=!0)},p(b,y){let P=n;n=R(b),n===P?k[n].p(b,y):(he(),M(k[P],1,1,()=>{k[P]=null}),ge(),i=k[n],i?i.p(b,y):(i=k[n]=w[n](b),i.c()),E(i,1),i.m(t,null)),(!u||y[0]&4&&s!==(s=b[2]==="image"?"capture photo":"start recording"))&&v(t,"aria-label",s),b[11]?g&&(he(),M(g,1,1,()=>{g=null}),ge()):g?(g.p(b,y),y[0]&2048&&E(g,1)):(g=xe(b),g.c(),E(g,1),g.m(e,null)),b[13]&&b[8]?p?(p.p(b,y),y[0]&8448&&E(p,1)):(p=et(b),p.c(),E(p,1),p.m(o.parentNode,o)):p&&(he(),M(p,1,1,()=>{p=null}),ge())},i(b){u||(E(i),E(g),E(p),u=!0)},o(b){M(i),M(g),M(p),u=!1},d(b){b&&(j(e),j(c),j(o)),k[n].d(),g&&g.d(),p&&p.d(b),m=!1,_()}}}function Wn(l){let e,t,n,i;return t=new fn({}),t.$on("click",l[27]),{c(){e=T("div"),ee(t.$$.fragment),v(e,"title","grant webcam access"),at(e,"height","100%")},m(s,r){N(s,e,r),ne(t,e,null),i=!0},p:Ve,i(s){i||(E(t.$$.fragment,s),s&&(n||bn(()=>{n=vn(e,qt,{delay:100,duration:200}),n.start()})),i=!0)},o(s){M(t.$$.fragment,s),i=!1},d(s){s&&j(e),te(t)}}}function Bn(l){let e,t,n;return t=new Lt({}),{c(){e=T("div"),ee(t.$$.fragment),v(e,"class","icon svelte-10cpz3p"),v(e,"title","capture photo")},m(i,s){N(i,e,s),ne(t,e,null),n=!0},p:Ve,i(i){n||(E(t.$$.fragment,i),n=!0)},o(i){M(t.$$.fragment,i),n=!1},d(i){i&&j(e),te(t)}}}function Mn(l){let e,t,n,i;const s=[jn,Rn,Tn],r=[];function c(o,u){return o[1]&&o[10]==="waiting"?0:o[1]&&o[10]==="open"||!o[1]&&o[11]?1:2}return e=c(l),t=r[e]=s[e](l),{c(){t.c(),n=Oe()},m(o,u){r[e].m(o,u),N(o,n,u),i=!0},p(o,u){let m=e;e=c(o),e===m?r[e].p(o,u):(he(),M(r[m],1,1,()=>{r[m]=null}),ge(),t=r[e],t?t.p(o,u):(t=r[e]=s[e](o),t.c()),E(t,1),t.m(n.parentNode,n))},i(o){i||(E(t),i=!0)},o(o){M(t),i=!1},d(o){o&&j(n),r[e].d(o)}}}function Tn(l){let e,t,n,i,s=l[4]("audio.record")+"",r,c;return n=new Gt({}),{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),i=K(),r=ye(s),v(t,"class","icon color-primary svelte-10cpz3p"),v(t,"title","start recording"),v(e,"class","icon-with-text svelte-10cpz3p")},m(o,u){N(o,e,u),D(e,t),ne(n,t,null),D(e,i),D(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.record")+"")&&ke(r,s)},i(o){c||(E(n.$$.fragment,o),c=!0)},o(o){M(n.$$.fragment,o),c=!1},d(o){o&&j(e),te(n)}}}function Rn(l){let e,t,n,i,s=l[4]("audio.stop")+"",r,c;return n=new St({}),{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),i=K(),r=ye(s),v(t,"class","icon color-primary svelte-10cpz3p"),v(t,"title","stop recording"),v(e,"class","icon-with-text svelte-10cpz3p")},m(o,u){N(o,e,u),D(e,t),ne(n,t,null),D(e,i),D(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.stop")+"")&&ke(r,s)},i(o){c||(E(n.$$.fragment,o),c=!0)},o(o){M(n.$$.fragment,o),c=!1},d(o){o&&j(e),te(n)}}}function jn(l){let e,t,n,i,s=l[4]("audio.waiting")+"",r,c;return n=new yt({}),{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),i=K(),r=ye(s),v(t,"class","icon color-primary svelte-10cpz3p"),v(t,"title","spinner"),v(e,"class","icon-with-text svelte-10cpz3p"),at(e,"width","var(--size-24)")},m(o,u){N(o,e,u),D(e,t),ne(n,t,null),D(e,i),D(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.waiting")+"")&&ke(r,s)},i(o){c||(E(n.$$.fragment,o),c=!0)},o(o){M(n.$$.fragment,o),c=!1},d(o){o&&j(e),te(n)}}}function xe(l){let e,t,n,i,s;return t=new ot({}),{c(){e=T("button"),ee(t.$$.fragment),v(e,"class","icon svelte-10cpz3p"),v(e,"aria-label","select input source")},m(r,c){N(r,e,c),ne(t,e,null),n=!0,i||(s=Se(e,"click",l[29]),i=!0)},p:Ve,i(r){n||(E(t.$$.fragment,r),n=!0)},o(r){M(t.$$.fragment,r),n=!1},d(r){r&&j(e),te(t),i=!1,s()}}}function et(l){let e,t,n,i,s,r,c;n=new ot({});function o(_,w){return _[7].length===0?Un:Nn}let u=o(l),m=u(l);return{c(){e=T("select"),t=T("button"),ee(n.$$.fragment),i=K(),m.c(),v(t,"class","inset-icon svelte-10cpz3p"),v(e,"class","select-wrap svelte-10cpz3p"),v(e,"aria-label","select source")},m(_,w){N(_,e,w),D(e,t),ne(n,t,null),D(t,i),m.m(e,null),s=!0,r||(c=[Se(t,"click",Cn(l[30])),pn(Ge.call(null,e,l[17])),Se(e,"change",l[14])],r=!0)},p(_,w){u===(u=o(_))&&m?m.p(_,w):(m.d(1),m=u(_),m&&(m.c(),m.m(e,null)))},i(_){s||(E(n.$$.fragment,_),s=!0)},o(_){M(n.$$.fragment,_),s=!1},d(_){_&&j(e),te(n),m.d(),r=!1,In(c)}}}function Nn(l){let e,t=Xe(l[7]),n=[];for(let i=0;i<t.length;i+=1)n[i]=tt(Ze(l,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=Oe()},m(i,s){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(i,s);N(i,e,s)},p(i,s){if(s[0]&384){t=Xe(i[7]);let r;for(r=0;r<t.length;r+=1){const c=Ze(i,t,r);n[r]?n[r].p(c,s):(n[r]=tt(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&j(e),kn(n,i)}}}function Un(l){let e,t=l[4]("common.no_devices")+"",n;return{c(){e=T("option"),n=ye(t),e.__value="",Fe(e,e.__value),v(e,"class","svelte-10cpz3p")},m(i,s){N(i,e,s),D(e,n)},p(i,s){s[0]&16&&t!==(t=i[4]("common.no_devices")+"")&&ke(n,t)},d(i){i&&j(e)}}}function tt(l){let e,t=l[39].label+"",n,i,s,r;return{c(){e=T("option"),n=ye(t),i=K(),e.__value=s=l[39].deviceId,Fe(e,e.__value),e.selected=r=l[8].deviceId===l[39].deviceId,v(e,"class","svelte-10cpz3p")},m(c,o){N(c,e,o),D(e,n),D(e,i)},p(c,o){o[0]&128&&t!==(t=c[39].label+"")&&ke(n,t),o[0]&128&&s!==(s=c[39].deviceId)&&(e.__value=s,Fe(e,e.__value)),o[0]&384&&r!==(r=c[8].deviceId===c[39].deviceId)&&(e.selected=r)},d(c){c&&j(e)}}}function Ln(l){let e,t,n,i,s,r,c,o,u,m,_;t=new Et({props:{time_limit:l[9]}});const w=[Wn,En],k=[];function R(g,p){return g[12]?1:0}return u=R(l),m=k[u]=w[u](l),{c(){e=T("div"),ee(t.$$.fragment),n=K(),i=T("video"),s=K(),r=T("img"),o=K(),m.c(),v(i,"class","svelte-10cpz3p"),se(i,"flip",l[3]),se(i,"hide",!l[12]||l[12]&&!!l[0]),Ye(r.src,c=l[0]?.url)||v(r,"src",c),v(r,"class","svelte-10cpz3p"),se(r,"hide",!l[12]||l[12]&&!l[0]),v(e,"class","wrap svelte-10cpz3p")},m(g,p){N(g,e,p),ne(t,e,null),D(e,n),D(e,i),l[26](i),D(e,s),D(e,r),D(e,o),k[u].m(e,null),_=!0},p(g,p){const b={};p[0]&512&&(b.time_limit=g[9]),t.$set(b),(!_||p[0]&8)&&se(i,"flip",g[3]),(!_||p[0]&4097)&&se(i,"hide",!g[12]||g[12]&&!!g[0]),(!_||p[0]&1&&!Ye(r.src,c=g[0]?.url))&&v(r,"src",c),(!_||p[0]&4097)&&se(r,"hide",!g[12]||g[12]&&!g[0]);let y=u;u=R(g),u===y?k[u].p(g,p):(he(),M(k[y],1,1,()=>{k[y]=null}),ge(),m=k[u],m?m.p(g,p):(m=k[u]=w[u](g),m.c()),E(m,1),m.m(e,null))},i(g){_||(E(t.$$.fragment,g),E(m),_=!0)},o(g){M(t.$$.fragment,g),M(m),_=!1},d(g){g&&j(e),te(t),l[26](null),k[u].d()}}}function Ge(l,e){const t=n=>{l&&!l.contains(n.target)&&!n.defaultPrevented&&e(n)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Pn(l,e,t){let n,i=[],s=null,r=null,c="closed";const o=d=>{d==="closed"?(t(9,r=null),t(10,c="closed"),t(0,$=null)):d==="waiting"?t(10,c="waiting"):t(10,c="open")},u=d=>{h&&t(9,r=d)};let m,{streaming:_=!1}=e,{pending:w=!1}=e,{root:k=""}=e,{stream_every:R=1}=e,{mode:g="image"}=e,{mirror_webcam:p}=e,{include_audio:b}=e,{webcam_constraints:y=null}=e,{i18n:P}=e,{upload:A}=e,{value:$=null}=e;const S=Dn();qn(()=>{m=document.createElement("canvas"),_&&g==="image"&&window.setInterval(()=>{n&&!w&&f()},R*1e3)});const H=async d=>{const J=d.target.value;await Qe(b,n,y,J).then(async _e=>{U=_e,t(8,s=i.find(fe=>fe.deviceId===J)||null),t(13,ie=!1)})};async function I(){try{Qe(b,n,y).then(async d=>{t(12,O=!0),t(7,i=await mn()),U=d}).then(()=>gn(i)).then(d=>{t(7,i=d);const W=U.getTracks().map(J=>J.getSettings()?.deviceId)[0];t(8,s=W&&d.find(J=>J.deviceId===W)||i[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&S("error",P("image.no_webcam_support"))}catch(d){if(d instanceof DOMException&&d.name=="NotAllowedError")S("error",P("image.allow_webcam_access"));else throw d}}function f(){var d=m.getContext("2d");if((!_||_&&h)&&n.videoWidth&&n.videoHeight){if(m.width=n.videoWidth,m.height=n.videoHeight,d.drawImage(n,0,0,n.videoWidth,n.videoHeight),p&&(d.scale(-1,1),d.drawImage(n,-n.videoWidth,0)),_&&(!h||c==="waiting"))return;if(_){const W=m.toDataURL("image/jpeg");S("stream",W);return}m.toBlob(W=>{S(_?"stream":"capture",W)},`image/${_?"jpeg":"png"}`,.8)}}let h=!1,Q=[],U,q,F;function X(){if(h){F.stop();let d=new Blob(Q,{type:q}),W=new FileReader;W.onload=async function(J){if(J.target){let _e=new File([d],"sample."+q.substring(6));const fe=await vt([_e]);let Re=(await A(fe,k))?.filter(Boolean)[0];S("capture",Re),S("stop_recording")}},W.readAsDataURL(d)}else if(typeof MediaRecorder<"u"){S("start_recording"),Q=[];let d=["video/webm","video/mp4"];for(let W of d)if(MediaRecorder.isTypeSupported(W)){q=W;break}if(q===null){console.error("No supported MediaRecorder mimeType");return}F=new MediaRecorder(U,{mimeType:q}),F.addEventListener("dataavailable",function(W){Q.push(W.data)}),F.start(200)}t(11,h=!h)}let O=!1;function ce({destroy:d}={}){g==="image"&&_&&t(11,h=!h),d||(g==="image"?f():X()),!h&&U&&(S("close_stream"),U.getTracks().forEach(W=>W.stop()),t(6,n.srcObject=null,n),t(12,O=!1),window.setTimeout(()=>{t(0,$=null)},500),t(0,$=null))}let ie=!1;function ue(d){d.preventDefault(),d.stopPropagation(),t(13,ie=!1)}Sn(()=>{typeof window>"u"||(ce({destroy:!0}),U?.getTracks().forEach(d=>d.stop()))});function Ee(d){wn[d?"unshift":"push"](()=>{n=d,t(6,n)})}const We=async()=>I(),Be=()=>ce(),Me=()=>t(13,ie=!0),Te=()=>t(13,ie=!1);return l.$$set=d=>{"streaming"in d&&t(1,_=d.streaming),"pending"in d&&t(20,w=d.pending),"root"in d&&t(21,k=d.root),"stream_every"in d&&t(22,R=d.stream_every),"mode"in d&&t(2,g=d.mode),"mirror_webcam"in d&&t(3,p=d.mirror_webcam),"include_audio"in d&&t(23,b=d.include_audio),"webcam_constraints"in d&&t(24,y=d.webcam_constraints),"i18n"in d&&t(4,P=d.i18n),"upload"in d&&t(25,A=d.upload),"value"in d&&t(0,$=d.value)},[$,_,g,p,P,Ge,n,i,s,r,c,h,O,ie,H,I,ce,ue,o,u,w,k,R,b,y,A,Ee,We,Be,Me,Te]}class $n extends hn{constructor(e){super(),yn(this,e,Pn,Ln,zn,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),G()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),G()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),G()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),G()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),G()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),G()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),G()}get webcam_constraints(){return this.$$.ctx[24]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),G()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),G()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),G()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),G()}get click_outside(){return Ge}}const Fn=$n,{SvelteComponent:An,add_flush_callback:pe,append:ze,attr:De,bind:be,binding_callbacks:re,bubble:me,check_outros:we,create_component:Y,create_slot:Hn,destroy_component:Z,detach:oe,element:Ae,empty:ct,flush:C,get_all_dirty_from_scope:On,get_slot_changes:Vn,group_outros:ve,init:Gn,insert:ae,listen:He,mount_component:x,run_all:Jn,safe_not_equal:Kn,set_style:nt,space:de,toggle_class:qe,transition_in:z,transition_out:B,update_slot_base:Qn}=window.__gradio__svelte__internal,{createEventDispatcher:Xn,tick:Ce}=window.__gradio__svelte__internal;function it(l){let e,t,n,i=l[18]&&lt(l);return t=new pt({props:{Icon:bt,label:"Remove Image"}}),t.$on("click",l[25]),{c(){i&&i.c(),e=de(),Y(t.$$.fragment)},m(s,r){i&&i.m(s,r),ae(s,e,r),x(t,s,r),n=!0},p(s,r){s[18]?i?(i.p(s,r),r[0]&262144&&z(i,1)):(i=lt(s),i.c(),z(i,1),i.m(e.parentNode,e)):i&&(ve(),B(i,1,1,()=>{i=null}),we())},i(s){n||(z(i),z(t.$$.fragment,s),n=!0)},o(s){B(i),B(t.$$.fragment,s),n=!1},d(s){s&&oe(e),i&&i.d(s),Z(t,s)}}}function lt(l){let e,t;return e=new Ct({props:{fullscreen:l[19]}}),e.$on("fullscreen",l[33]),{c(){Y(e.$$.fragment)},m(n,i){x(e,n,i),t=!0},p(n,i){const s={};i[0]&524288&&(s.fullscreen=n[19]),e.$set(s)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){Z(e,n)}}}function Yn(l){let e,t,n=l[3]?.url&&!l[20]&&it(l);return{c(){n&&n.c(),e=ct()},m(i,s){n&&n.m(i,s),ae(i,e,s),t=!0},p(i,s){i[3]?.url&&!i[20]?n?(n.p(i,s),s[0]&1048584&&z(n,1)):(n=it(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(ve(),B(n,1,1,()=>{n=null}),we())},i(i){t||(z(n),t=!0)},o(i){B(n),t=!1},d(i){i&&oe(e),n&&n.d(i)}}}function rt(l){let e;const t=l[32].default,n=Hn(t,l,l[48],null);return{c(){n&&n.c()},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s[1]&131072)&&Qn(n,t,i,i[48],e?Vn(t,i[48],s,null):On(i[48]),null)},i(i){e||(z(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function Zn(l){let e,t,n=l[3]===null&&rt(l);return{c(){n&&n.c(),e=ct()},m(i,s){n&&n.m(i,s),ae(i,e,s),t=!0},p(i,s){i[3]===null?n?(n.p(i,s),s[0]&8&&z(n,1)):(n=rt(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(ve(),B(n,1,1,()=>{n=null}),we())},i(i){t||(z(n),t=!0)},o(i){B(n),t=!1},d(i){i&&oe(e),n&&n.d(i)}}}function xn(l){let e,t,n,i,s;return t=new Bt({props:{src:l[3].url,alt:l[3].alt_text}}),{c(){e=Ae("div"),Y(t.$$.fragment),De(e,"class","image-frame svelte-1hdlew6"),qe(e,"selectable",l[11])},m(r,c){ae(r,e,c),x(t,e,null),n=!0,i||(s=He(e,"click",l[27]),i=!0)},p(r,c){const o={};c[0]&8&&(o.src=r[3].url),c[0]&8&&(o.alt=r[3].alt_text),t.$set(o),(!n||c[0]&2048)&&qe(e,"selectable",r[11])},i(r){n||(z(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&oe(e),Z(t),i=!1,s()}}}function ei(l){let e,t,n,i;function s(o){l[38](o)}function r(o){l[39](o)}let c={root:l[12],value:l[3],mirror_webcam:l[10].mirror,stream_every:l[17],streaming:l[9],mode:"image",include_audio:!1,i18n:l[13],upload:l[15],webcam_constraints:l[10].constraints};return l[4]!==void 0&&(c.modify_stream=l[4]),l[5]!==void 0&&(c.set_time_limit=l[5]),e=new Fn({props:c}),re.push(()=>be(e,"modify_stream",s)),re.push(()=>be(e,"set_time_limit",r)),e.$on("capture",l[40]),e.$on("stream",l[41]),e.$on("error",l[42]),e.$on("drag",l[43]),e.$on("upload",l[44]),e.$on("close_stream",l[45]),{c(){Y(e.$$.fragment)},m(o,u){x(e,o,u),i=!0},p(o,u){const m={};u[0]&4096&&(m.root=o[12]),u[0]&8&&(m.value=o[3]),u[0]&1024&&(m.mirror_webcam=o[10].mirror),u[0]&131072&&(m.stream_every=o[17]),u[0]&512&&(m.streaming=o[9]),u[0]&8192&&(m.i18n=o[13]),u[0]&32768&&(m.upload=o[15]),u[0]&1024&&(m.webcam_constraints=o[10].constraints),!t&&u[0]&16&&(t=!0,m.modify_stream=o[4],pe(()=>t=!1)),!n&&u[0]&32&&(n=!0,m.set_time_limit=o[5],pe(()=>n=!1)),e.$set(m)},i(o){i||(z(e.$$.fragment,o),i=!0)},o(o){B(e.$$.fragment,o),i=!1},d(o){Z(e,o)}}}function st(l){let e,t,n;function i(r){l[46](r)}let s={sources:l[8],handle_clear:l[24],handle_select:l[28]};return l[1]!==void 0&&(s.active_source=l[1]),e=new It({props:s}),re.push(()=>be(e,"active_source",i)),{c(){Y(e.$$.fragment)},m(r,c){x(e,r,c),n=!0},p(r,c){const o={};c[0]&256&&(o.sources=r[8]),!t&&c[0]&2&&(t=!0,o.active_source=r[1],pe(()=>t=!1)),e.$set(o)},i(r){n||(z(e.$$.fragment,r),n=!0)},o(r){B(e.$$.fragment,r),n=!1},d(r){Z(e,r)}}}function ti(l){let e,t,n,i,s,r,c,o,u,m,_,w,k,R=l[8].length>1||l[8].includes("clipboard"),g,p,b;e=new ht({props:{show_label:l[7],Icon:wt,label:l[6]||"Image"}}),i=new zt({props:{$$slots:{default:[Yn]},$$scope:{ctx:l}}});function y(f){l[35](f)}function P(f){l[36](f)}let A={hidden:l[3]!==null||l[1]==="webcam",filetype:l[1]==="clipboard"?"clipboard":"image/*",root:l[12],max_file_size:l[14],disable_click:!l[8].includes("upload")||l[3]!==null,upload:l[15],stream_handler:l[16],aria_label:l[13]("image.drop_to_upload"),$$slots:{default:[Zn]},$$scope:{ctx:l}};l[0]!==void 0&&(A.uploading=l[0]),l[2]!==void 0&&(A.dragging=l[2]),c=new Wt({props:A}),l[34](c),re.push(()=>be(c,"uploading",y)),re.push(()=>be(c,"dragging",P)),c.$on("load",l[23]),c.$on("error",l[37]);const $=[ei,xn],S=[];function H(f,h){return f[1]==="webcam"&&(f[9]||!f[9]&&!f[3])?0:f[3]!==null&&!f[9]?1:-1}~(_=H(l))&&(w=S[_]=$[_](l));let I=R&&st(l);return{c(){Y(e.$$.fragment),t=de(),n=Ae("div"),Y(i.$$.fragment),s=de(),r=Ae("div"),Y(c.$$.fragment),m=de(),w&&w.c(),k=de(),I&&I.c(),De(r,"class","upload-container svelte-1hdlew6"),qe(r,"reduced-height",l[8].length>1),nt(r,"width",l[3]?"auto":"100%"),De(n,"data-testid","image"),De(n,"class","image-container svelte-1hdlew6")},m(f,h){x(e,f,h),ae(f,t,h),ae(f,n,h),x(i,n,null),ze(n,s),ze(n,r),x(c,r,null),ze(r,m),~_&&S[_].m(r,null),ze(n,k),I&&I.m(n,null),l[47](n),g=!0,p||(b=[He(r,"dragover",l[29]),He(r,"drop",l[30])],p=!0)},p(f,h){const Q={};h[0]&128&&(Q.show_label=f[7]),h[0]&64&&(Q.label=f[6]||"Image"),e.$set(Q);const U={};h[0]&1835016|h[1]&131072&&(U.$$scope={dirty:h,ctx:f}),i.$set(U);const q={};h[0]&10&&(q.hidden=f[3]!==null||f[1]==="webcam"),h[0]&2&&(q.filetype=f[1]==="clipboard"?"clipboard":"image/*"),h[0]&4096&&(q.root=f[12]),h[0]&16384&&(q.max_file_size=f[14]),h[0]&264&&(q.disable_click=!f[8].includes("upload")||f[3]!==null),h[0]&32768&&(q.upload=f[15]),h[0]&65536&&(q.stream_handler=f[16]),h[0]&8192&&(q.aria_label=f[13]("image.drop_to_upload")),h[0]&8|h[1]&131072&&(q.$$scope={dirty:h,ctx:f}),!o&&h[0]&1&&(o=!0,q.uploading=f[0],pe(()=>o=!1)),!u&&h[0]&4&&(u=!0,q.dragging=f[2],pe(()=>u=!1)),c.$set(q);let F=_;_=H(f),_===F?~_&&S[_].p(f,h):(w&&(ve(),B(S[F],1,1,()=>{S[F]=null}),we()),~_?(w=S[_],w?w.p(f,h):(w=S[_]=$[_](f),w.c()),z(w,1),w.m(r,null)):w=null),(!g||h[0]&256)&&qe(r,"reduced-height",f[8].length>1),h[0]&8&&nt(r,"width",f[3]?"auto":"100%"),h[0]&256&&(R=f[8].length>1||f[8].includes("clipboard")),R?I?(I.p(f,h),h[0]&256&&z(I,1)):(I=st(f),I.c(),z(I,1),I.m(n,null)):I&&(ve(),B(I,1,1,()=>{I=null}),we())},i(f){g||(z(e.$$.fragment,f),z(i.$$.fragment,f),z(c.$$.fragment,f),z(w),z(I),g=!0)},o(f){B(e.$$.fragment,f),B(i.$$.fragment,f),B(c.$$.fragment,f),B(w),B(I),g=!1},d(f){f&&(oe(t),oe(n)),Z(e,f),Z(i),l[34](null),Z(c),~_&&S[_].d(),I&&I.d(),l[47](null),p=!1,Jn(b)}}}function ni(l,e,t){let n,{$$slots:i={},$$scope:s}=e,{value:r=null}=e,{label:c=void 0}=e,{show_label:o}=e,{sources:u=["upload","clipboard","webcam"]}=e,{streaming:m=!1}=e,{pending:_=!1}=e,{webcam_options:w}=e,{selectable:k=!1}=e,{root:R}=e,{i18n:g}=e,{max_file_size:p=null}=e,{upload:b}=e,{stream_handler:y}=e,{stream_every:P}=e,{modify_stream:A}=e,{set_time_limit:$}=e,{show_fullscreen_button:S=!0}=e,H,{uploading:I=!1}=e,{active_source:f=null}=e,{fullscreen:h=!1}=e;async function Q({detail:a}){if(!m){if(a.path?.toLowerCase().endsWith(".svg")&&a.url){const je=await(await fetch(a.url)).text();t(3,r={...a,url:`data:image/svg+xml,${encodeURIComponent(je)}`})}else t(3,r=a);await Ce(),X("upload")}}function U(){t(3,r=null),X("clear"),X("change",null)}function q(a){U(),a.stopPropagation()}async function F(a,le){if(le==="stream"){X("stream",{value:{url:a},is_value_data:!0});return}t(31,_=!0);const je=await H.load_files([new File([a],`image/${m?"jpeg":"png"}`)]);(le==="change"||le==="upload")&&(t(3,r=je?.[0]||null),await Ce(),X("change")),t(31,_=!1)}const X=Xn();let{dragging:O=!1}=e;function ce(a){let le=Dt(a);le&&X("select",{index:le,value:null})}async function ie(a){switch(a){case"clipboard":H.paste_clipboard();break}}let ue;function Ee(a){a.preventDefault(),a.stopPropagation(),a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),t(2,O=!0)}async function We(a){a.preventDefault(),a.stopPropagation(),t(2,O=!1),r&&(U(),await Ce()),t(1,f="upload"),await Ce(),H.load_files_from_drop(a)}function Be(a){me.call(this,l,a)}function Me(a){re[a?"unshift":"push"](()=>{H=a,t(21,H)})}function Te(a){I=a,t(0,I)}function d(a){O=a,t(2,O)}function W(a){me.call(this,l,a)}function J(a){A=a,t(4,A)}function _e(a){$=a,t(5,$)}const fe=a=>F(a.detail,"change"),Re=a=>F(a.detail,"stream");function ut(a){me.call(this,l,a)}function _t(a){me.call(this,l,a)}const ft=a=>F(a.detail,"upload");function mt(a){me.call(this,l,a)}function dt(a){f=a,t(1,f),t(8,u)}function gt(a){re[a?"unshift":"push"](()=>{ue=a,t(22,ue)})}return l.$$set=a=>{"value"in a&&t(3,r=a.value),"label"in a&&t(6,c=a.label),"show_label"in a&&t(7,o=a.show_label),"sources"in a&&t(8,u=a.sources),"streaming"in a&&t(9,m=a.streaming),"pending"in a&&t(31,_=a.pending),"webcam_options"in a&&t(10,w=a.webcam_options),"selectable"in a&&t(11,k=a.selectable),"root"in a&&t(12,R=a.root),"i18n"in a&&t(13,g=a.i18n),"max_file_size"in a&&t(14,p=a.max_file_size),"upload"in a&&t(15,b=a.upload),"stream_handler"in a&&t(16,y=a.stream_handler),"stream_every"in a&&t(17,P=a.stream_every),"modify_stream"in a&&t(4,A=a.modify_stream),"set_time_limit"in a&&t(5,$=a.set_time_limit),"show_fullscreen_button"in a&&t(18,S=a.show_fullscreen_button),"uploading"in a&&t(0,I=a.uploading),"active_source"in a&&t(1,f=a.active_source),"fullscreen"in a&&t(19,h=a.fullscreen),"dragging"in a&&t(2,O=a.dragging),"$$scope"in a&&t(48,s=a.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&258&&!f&&u&&t(1,f=u[0]),l.$$.dirty[0]&514&&t(20,n=m&&f==="webcam"),l.$$.dirty[0]&1048577&&I&&!n&&t(3,r=null),l.$$.dirty[0]&4&&X("drag",O)},[I,f,O,r,A,$,c,o,u,m,w,k,R,g,p,b,y,P,S,h,n,H,ue,Q,U,q,F,ce,ie,Ee,We,_,i,Be,Me,Te,d,W,J,_e,fe,Re,ut,_t,ft,mt,dt,gt,s]}class ii extends An{constructor(e){super(),Gn(this,e,ni,ti,Kn,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:31,webcam_options:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,fullscreen:19,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),C()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),C()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),C()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),C()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),C()}get pending(){return this.$$.ctx[31]}set pending(e){this.$$set({pending:e}),C()}get webcam_options(){return this.$$.ctx[10]}set webcam_options(e){this.$$set({webcam_options:e}),C()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),C()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),C()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),C()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),C()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),C()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),C()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),C()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),C()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),C()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),C()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),C()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),C()}get fullscreen(){return this.$$.ctx[19]}set fullscreen(e){this.$$set({fullscreen:e}),C()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),C()}}const Ii=ii;export{Gt as C,Ii as I,Fn as W};
//# sourceMappingURL=ImageUploader-KEeTunPK.js.map
